(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Libp2PPeerIdFactory = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var Libp2PPeerIdFactory=(()=>{var pc=Object.create;var hn=Object.defineProperty;var dc=Object.getOwnPropertyDescriptor;var yc=Object.getOwnPropertyNames;var gc=Object.getPrototypeOf,xc=Object.prototype.hasOwnProperty;var O=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Z=(t,e)=>{for(var r in e)hn(t,r,{get:e[r],enumerable:!0})},lo=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of yc(e))!xc.call(t,i)&&i!==r&&hn(t,i,{get:()=>e[i],enumerable:!(n=dc(e,i))||n.enumerable});return t};var ht=(t,e,r)=>(r=t!=null?pc(gc(t)):{},lo(e||!t||!t.__esModule?hn(r,"default",{value:t,enumerable:!0}):r,t)),mc=t=>lo(hn({},"__esModule",{value:!0}),t);var $=O((By,po)=>{po.exports={options:{usePureJavaScript:!1}}});var xo=O((Ay,go)=>{var ai={};go.exports=ai;var yo={};ai.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(t instanceof Uint8Array))n=vc(t,e);else{var i=0,a=e.length,o=e.charAt(0),s=[0];for(i=0;i<t.length;++i){for(var f=0,c=t[i];f<s.length;++f)c+=s[f]<<8,s[f]=c%a,c=c/a|0;for(;c>0;)s.push(c%a),c=c/a|0}for(i=0;t[i]===0&&i<t.length-1;++i)n+=o;for(i=s.length-1;i>=0;--i)n+=e[s[i]]}if(r){var u=new RegExp(".{1,"+r+"}","g");n=n.match(u).join(`\r
`)}return n};ai.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=yo[e];if(!r){r=yo[e]=[];for(var n=0;n<e.length;++n)r[e.charCodeAt(n)]=n}t=t.replace(/\s/g,"");for(var i=e.length,a=e.charAt(0),o=[0],n=0;n<t.length;n++){var s=r[t.charCodeAt(n)];if(s===void 0)return;for(var f=0,c=s;f<o.length;++f)c+=o[f]*i,o[f]=c&255,c>>=8;for(;c>0;)o.push(c&255),c>>=8}for(var u=0;t[u]===a&&u<t.length-1;++u)o.push(0);return typeof Buffer<"u"?Buffer.from(o.reverse()):new Uint8Array(o.reverse())};function vc(t,e){var r=0,n=e.length,i=e.charAt(0),a=[0];for(r=0;r<t.length();++r){for(var o=0,s=t.at(r);o<a.length;++o)s+=a[o]<<8,a[o]=s%n,s=s/n|0;for(;s>0;)a.push(s%n),s=s/n|0}var f="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)f+=i;for(r=a.length-1;r>=0;--r)f+=e[a[r]];return f}});var lt=O((Cy,wo)=>{var mo=$(),vo=xo(),y=wo.exports=mo.util=mo.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){y.nextTick=process.nextTick,typeof setImmediate=="function"?y.setImmediate=setImmediate:y.setImmediate=y.nextTick;return}if(typeof setImmediate=="function"){y.setImmediate=function(){return setImmediate.apply(void 0,arguments)},y.nextTick=function(s){return setImmediate(s)};return}if(y.setImmediate=function(s){setTimeout(s,0)},typeof window<"u"&&typeof window.postMessage=="function"){let s=function(f){if(f.source===window&&f.data===t){f.stopPropagation();var c=e.slice();e.length=0,c.forEach(function(u){u()})}};var o=s,t="forge.setImmediate",e=[];y.setImmediate=function(f){e.push(f),e.length===1&&window.postMessage(t,"*")},window.addEventListener("message",s,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,i=document.createElement("div"),e=[];new MutationObserver(function(){var f=e.slice();e.length=0,f.forEach(function(c){c()})}).observe(i,{attributes:!0});var a=y.setImmediate;y.setImmediate=function(f){Date.now()-r>15?(r=Date.now(),a(f)):(e.push(f),e.length===1&&i.setAttribute("a",n=!n))}}y.nextTick=y.setImmediate})();y.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;y.globalScope=function(){return y.isNodejs?globalThis:typeof self>"u"?window:self}();y.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};y.isArrayBuffer=function(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer};y.isArrayBufferView=function(t){return t&&y.isArrayBuffer(t.buffer)&&t.byteLength!==void 0};function _r(t){if(!(t===8||t===16||t===24||t===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}y.ByteBuffer=oi;function oi(t){if(this.data="",this.read=0,typeof t=="string")this.data=t;else if(y.isArrayBuffer(t)||y.isArrayBufferView(t))if(typeof Buffer<"u"&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch{for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof oi||typeof t=="object"&&typeof t.data=="string"&&typeof t.read=="number")&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}y.ByteStringBuffer=oi;var bc=4096;y.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>bc&&(this.data.substr(0,1),this._constructedStringLength=0)};y.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};y.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};y.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))};y.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this};y.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this};y.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(y.encodeUtf8(t))};y.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};y.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};y.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};y.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255))};y.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))};y.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))};y.ByteStringBuffer.prototype.putInt=function(t,e){_r(e);var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)};y.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)};y.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())};y.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};y.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t};y.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t};y.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t};y.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t};y.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t};y.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t};y.ByteStringBuffer.prototype.getInt=function(t){_r(t);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e};y.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};y.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};y.ByteStringBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};y.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};y.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this};y.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};y.ByteStringBuffer.prototype.copy=function(){var t=y.createBuffer(this.data);return t.read=this.read,t};y.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};y.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};y.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this};y.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t};y.ByteStringBuffer.prototype.toString=function(){return y.decodeUtf8(this.bytes())};function wc(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=y.isArrayBuffer(t),n=y.isArrayBufferView(t);if(r||n){r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,t!=null&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}y.DataBuffer=wc;y.DataBuffer.prototype.length=function(){return this.write-this.read};y.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};y.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+e);return n.set(r),this.data=new DataView(n.buffer),this};y.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this};y.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this};y.DataBuffer.prototype.putBytes=function(t,e){if(y.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(y.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof y.DataBuffer||typeof t=="object"&&typeof t.read=="number"&&typeof t.write=="number"&&y.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var i=new Uint8Array(t.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(t instanceof y.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary",typeof t=="string"){var a;if(e==="hex")return this.accommodate(Math.ceil(t.length/2)),a=new Uint8Array(this.data.buffer,this.write),this.write+=y.binary.hex.decode(t,a,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(t.length/4)*3),a=new Uint8Array(this.data.buffer,this.write),this.write+=y.binary.base64.decode(t,a,this.write),this;if(e==="utf8"&&(t=y.encodeUtf8(t),e="binary"),e==="binary"||e==="raw")return this.accommodate(t.length),a=new Uint8Array(this.data.buffer,this.write),this.write+=y.binary.raw.decode(a),this;if(e==="utf16")return this.accommodate(t.length*2),a=new Uint16Array(this.data.buffer,this.write),this.write+=y.text.utf16.encode(a),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)};y.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this};y.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")};y.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this};y.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this};y.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this};y.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this};y.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this};y.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this};y.DataBuffer.prototype.putInt=function(t,e){_r(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this};y.DataBuffer.prototype.putSignedInt=function(t,e){return _r(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)};y.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};y.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t};y.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t};y.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t};y.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t};y.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t};y.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t};y.DataBuffer.prototype.getInt=function(t){_r(t);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e};y.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};y.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};y.DataBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};y.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)};y.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this};y.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};y.DataBuffer.prototype.copy=function(){return new y.DataBuffer(this)};y.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};y.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};y.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this};y.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t};y.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8",t==="binary"||t==="raw")return y.binary.raw.encode(e);if(t==="hex")return y.binary.hex.encode(e);if(t==="base64")return y.binary.base64.encode(e);if(t==="utf8")return y.text.utf8.decode(e);if(t==="utf16")return y.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)};y.createBuffer=function(t,e){return e=e||"raw",t!==void 0&&e==="utf8"&&(t=y.encodeUtf8(t)),new y.ByteBuffer(t)};y.fillString=function(t,e){for(var r="";e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return r};y.xorBytes=function(t,e,r){for(var n="",i="",a="",o=0,s=0;r>0;--r,++o)i=t.charCodeAt(o)^e.charCodeAt(o),s>=10&&(n+=a,a="",s=0),a+=String.fromCharCode(i),++s;return n+=a,n};y.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e};y.bytesToHex=function(t){return y.createBuffer(t).toHex()};y.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)};var le="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",pe=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],bo="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";y.encode64=function(t,e){for(var r="",n="",i,a,o,s=0;s<t.length;)i=t.charCodeAt(s++),a=t.charCodeAt(s++),o=t.charCodeAt(s++),r+=le.charAt(i>>2),r+=le.charAt((i&3)<<4|a>>4),isNaN(a)?r+="==":(r+=le.charAt((a&15)<<2|o>>6),r+=isNaN(o)?"=":le.charAt(o&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};y.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,n,i,a,o=0;o<t.length;)r=pe[t.charCodeAt(o++)-43],n=pe[t.charCodeAt(o++)-43],i=pe[t.charCodeAt(o++)-43],a=pe[t.charCodeAt(o++)-43],e+=String.fromCharCode(r<<2|n>>4),i!==64&&(e+=String.fromCharCode((n&15)<<4|i>>2),a!==64&&(e+=String.fromCharCode((i&3)<<6|a)));return e};y.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};y.decodeUtf8=function(t){return decodeURIComponent(escape(t))};y.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:vo.encode,decode:vo.decode}};y.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)};y.binary.raw.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,a=0;a<t.length;++a)n[i++]=t.charCodeAt(a);return e?i-r:n};y.binary.hex.encode=y.bytesToHex;y.binary.hex.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var i=0,a=r;for(t.length&1&&(i=1,n[a++]=parseInt(t[0],16));i<t.length;i+=2)n[a++]=parseInt(t.substr(i,2),16);return e?a-r:n};y.binary.base64.encode=function(t,e){for(var r="",n="",i,a,o,s=0;s<t.byteLength;)i=t[s++],a=t[s++],o=t[s++],r+=le.charAt(i>>2),r+=le.charAt((i&3)<<4|a>>4),isNaN(a)?r+="==":(r+=le.charAt((a&15)<<2|o>>6),r+=isNaN(o)?"=":le.charAt(o&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};y.binary.base64.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/4)*3)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,a,o,s,f=0,c=r;f<t.length;)i=pe[t.charCodeAt(f++)-43],a=pe[t.charCodeAt(f++)-43],o=pe[t.charCodeAt(f++)-43],s=pe[t.charCodeAt(f++)-43],n[c++]=i<<2|a>>4,o!==64&&(n[c++]=(a&15)<<4|o>>2,s!==64&&(n[c++]=(o&3)<<6|s));return e?c-r:n.subarray(0,c)};y.binary.base58.encode=function(t,e){return y.binary.baseN.encode(t,bo,e)};y.binary.base58.decode=function(t,e){return y.binary.baseN.decode(t,bo,e)};y.text={utf8:{},utf16:{}};y.text.utf8.encode=function(t,e,r){t=y.encodeUtf8(t);var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,a=0;a<t.length;++a)n[i++]=t.charCodeAt(a);return e?i-r:n};y.text.utf8.decode=function(t){return y.decodeUtf8(String.fromCharCode.apply(null,t))};y.text.utf16.encode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var a=r,o=r,s=0;s<t.length;++s)i[o++]=t.charCodeAt(s),a+=2;return e?a-r:n};y.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};y.deflate=function(t,e,r){if(e=y.decode64(t.deflate(y.encode64(e)).rval),r){var n=2,i=e.charCodeAt(1);i&32&&(n=6),e=e.substring(n,e.length-4)}return e};y.inflate=function(t,e,r){var n=t.inflate(y.encode64(e)).rval;return n===null?null:y.decode64(n)};var si=function(t,e,r){if(!t)throw new Error("WebStorage not available.");var n;if(r===null?n=t.removeItem(e):(r=y.encode64(JSON.stringify(r)),n=t.setItem(e,r)),typeof n<"u"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},fi=function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(y.decode64(r))),r},Sc=function(t,e,r,n){var i=fi(t,e);i===null&&(i={}),i[r]=n,si(t,e,i)},Ec=function(t,e,r){var n=fi(t,e);return n!==null&&(n=r in n?n[r]:null),n},Bc=function(t,e,r){var n=fi(t,e);if(n!==null&&r in n){delete n[r];var i=!0;for(var a in n){i=!1;break}i&&(n=null),si(t,e,n)}},Ac=function(t,e){si(t,e,null)},ln=function(t,e,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var i,a=!1,o=null;for(var s in r){i=r[s];try{if(i==="flash"||i==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");n=t.apply(this,e),a=i==="flash"}(i==="web"||i==="both")&&(e[0]=localStorage,n=t.apply(this,e),a=!0)}catch(f){o=f}if(a)break}if(!a)throw o;return n};y.setItem=function(t,e,r,n,i){ln(Sc,arguments,i)};y.getItem=function(t,e,r,n){return ln(Ec,arguments,n)};y.removeItem=function(t,e,r,n){ln(Bc,arguments,n)};y.clearItems=function(t,e,r){ln(Ac,arguments,r)};y.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};y.format=function(t){for(var e=/%./g,r,n,i=0,a=[],o=0;r=e.exec(t);){n=t.substring(o,e.lastIndex-2),n.length>0&&a.push(n),o=e.lastIndex;var s=r[0][1];switch(s){case"s":case"o":i<arguments.length?a.push(arguments[i+++1]):a.push("<?>");break;case"%":a.push("%");break;default:a.push("<%"+s+"?>")}}return a.push(t.substring(o)),a.join("")};y.formatNumber=function(t,e,r,n){var i=t,a=isNaN(e=Math.abs(e))?2:e,o=r===void 0?",":r,s=n===void 0?".":n,f=i<0?"-":"",c=parseInt(i=Math.abs(+i||0).toFixed(a),10)+"",u=c.length>3?c.length%3:0;return f+(u?c.substr(0,u)+s:"")+c.substr(u).replace(/(\d{3})(?=\d)/g,"$1"+s)+(a?o+Math.abs(i-c).toFixed(a).slice(2):"")};y.formatSize=function(t){return t>=1073741824?t=y.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?t=y.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?t=y.formatNumber(t/1024,0)+" KiB":t=y.formatNumber(t,0)+" bytes",t};y.bytesFromIP=function(t){return t.indexOf(".")!==-1?y.bytesFromIPv4(t):t.indexOf(":")!==-1?y.bytesFromIPv6(t):null};y.bytesFromIPv4=function(t){if(t=t.split("."),t.length!==4)return null;for(var e=y.createBuffer(),r=0;r<t.length;++r){var n=parseInt(t[r],10);if(isNaN(n))return null;e.putByte(n)}return e.getBytes()};y.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(o){return o.length===0&&++e,!0});for(var r=(8-t.length+e)*2,n=y.createBuffer(),i=0;i<8;++i){if(!t[i]||t[i].length===0){n.fillWithByte(0,r),r=0;continue}var a=y.hexToBytes(t[i]);a.length<2&&n.putByte(0),n.putBytes(a)}return n.getBytes()};y.bytesToIP=function(t){return t.length===4?y.bytesToIPv4(t):t.length===16?y.bytesToIPv6(t):null};y.bytesToIPv4=function(t){if(t.length!==4)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")};y.bytesToIPv6=function(t){if(t.length!==16)return null;for(var e=[],r=[],n=0,i=0;i<t.length;i+=2){for(var a=y.bytesToHex(t[i]+t[i+1]);a[0]==="0"&&a!=="0";)a=a.substr(1);if(a==="0"){var o=r[r.length-1],s=e.length;!o||s!==o.end+1?r.push({start:s,end:s}):(o.end=s,o.end-o.start>r[n].end-r[n].start&&(n=r.length-1))}e.push(a)}if(r.length>0){var f=r[n];f.end-f.start>0&&(e.splice(f.start,f.end-f.start+1,""),f.start===0&&e.unshift(""),f.end===7&&e.push(""))}return e.join(":")};y.estimateCores=function(t,e){if(typeof t=="function"&&(e=t,t={}),t=t||{},"cores"in y&&!t.update)return e(null,y.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return y.cores=navigator.hardwareConcurrency,e(null,y.cores);if(typeof Worker>"u")return y.cores=1,e(null,y.cores);if(typeof Blob>"u")return y.cores=2,e(null,y.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(o){for(var s=Date.now(),f=s+4;Date.now()<f;);self.postMessage({st:s,et:f})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(o,s,f){if(s===0){var c=Math.floor(o.reduce(function(u,h){return u+h},0)/o.length);return y.cores=Math.max(1,c),URL.revokeObjectURL(r),e(null,y.cores)}i(f,function(u,h){o.push(a(f,h)),n(o,s-1,f)})}function i(o,s){for(var f=[],c=[],u=0;u<o;++u){var h=new Worker(r);h.addEventListener("message",function(l){if(c.push(l.data),c.length===o){for(var d=0;d<o;++d)f[d].terminate();s(null,c)}}),f.push(h)}for(var u=0;u<o;++u)f[u].postMessage(u)}function a(o,s){for(var f=[],c=0;c<o;++c)for(var u=s[c],h=f[c]=[],l=0;l<o;++l)if(c!==l){var d=s[l];(u.st>d.st&&u.st<d.et||d.st>u.st&&d.st<u.et)&&h.push(l)}return f.reduce(function(p,g){return Math.max(p,g.length)},0)}}});var pn=O((Iy,So)=>{var Rr=$();Rr.pki=Rr.pki||{};var ci=So.exports=Rr.pki.oids=Rr.oids=Rr.oids||{};function A(t,e){ci[t]=e,ci[e]=t}function W(t,e){ci[t]=e}A("1.2.840.113549.1.1.1","rsaEncryption");A("1.2.840.113549.1.1.4","md5WithRSAEncryption");A("1.2.840.113549.1.1.5","sha1WithRSAEncryption");A("1.2.840.113549.1.1.7","RSAES-OAEP");A("1.2.840.113549.1.1.8","mgf1");A("1.2.840.113549.1.1.9","pSpecified");A("1.2.840.113549.1.1.10","RSASSA-PSS");A("1.2.840.113549.1.1.11","sha256WithRSAEncryption");A("1.2.840.113549.1.1.12","sha384WithRSAEncryption");A("1.2.840.113549.1.1.13","sha512WithRSAEncryption");A("1.3.101.112","EdDSA25519");A("1.2.840.10040.4.3","dsa-with-sha1");A("1.3.14.3.2.7","desCBC");A("1.3.14.3.2.26","sha1");A("1.3.14.3.2.29","sha1WithRSASignature");A("2.16.840.1.101.3.4.2.1","sha256");A("2.16.840.1.101.3.4.2.2","sha384");A("2.16.840.1.101.3.4.2.3","sha512");A("2.16.840.1.101.3.4.2.4","sha224");A("2.16.840.1.101.3.4.2.5","sha512-224");A("2.16.840.1.101.3.4.2.6","sha512-256");A("1.2.840.113549.2.2","md2");A("1.2.840.113549.2.5","md5");A("1.2.840.113549.1.7.1","data");A("1.2.840.113549.1.7.2","signedData");A("1.2.840.113549.1.7.3","envelopedData");A("1.2.840.113549.1.7.4","signedAndEnvelopedData");A("1.2.840.113549.1.7.5","digestedData");A("1.2.840.113549.1.7.6","encryptedData");A("1.2.840.113549.1.9.1","emailAddress");A("1.2.840.113549.1.9.2","unstructuredName");A("1.2.840.113549.1.9.3","contentType");A("1.2.840.113549.1.9.4","messageDigest");A("1.2.840.113549.1.9.5","signingTime");A("1.2.840.113549.1.9.6","counterSignature");A("1.2.840.113549.1.9.7","challengePassword");A("1.2.840.113549.1.9.8","unstructuredAddress");A("1.2.840.113549.1.9.14","extensionRequest");A("1.2.840.113549.1.9.20","friendlyName");A("1.2.840.113549.1.9.21","localKeyId");A("1.2.840.113549.1.9.22.1","x509Certificate");A("1.2.840.113549.1.12.10.1.1","keyBag");A("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");A("1.2.840.113549.1.12.10.1.3","certBag");A("1.2.840.113549.1.12.10.1.4","crlBag");A("1.2.840.113549.1.12.10.1.5","secretBag");A("1.2.840.113549.1.12.10.1.6","safeContentsBag");A("1.2.840.113549.1.5.13","pkcs5PBES2");A("1.2.840.113549.1.5.12","pkcs5PBKDF2");A("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");A("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");A("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");A("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");A("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");A("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");A("1.2.840.113549.2.7","hmacWithSHA1");A("1.2.840.113549.2.8","hmacWithSHA224");A("1.2.840.113549.2.9","hmacWithSHA256");A("1.2.840.113549.2.10","hmacWithSHA384");A("1.2.840.113549.2.11","hmacWithSHA512");A("1.2.840.113549.3.7","des-EDE3-CBC");A("2.16.840.1.101.3.4.1.2","aes128-CBC");A("2.16.840.1.101.3.4.1.22","aes192-CBC");A("2.16.840.1.101.3.4.1.42","aes256-CBC");A("2.5.4.3","commonName");A("2.5.4.4","surname");A("2.5.4.5","serialNumber");A("2.5.4.6","countryName");A("2.5.4.7","localityName");A("2.5.4.8","stateOrProvinceName");A("2.5.4.9","streetAddress");A("2.5.4.10","organizationName");A("2.5.4.11","organizationalUnitName");A("2.5.4.12","title");A("2.5.4.13","description");A("2.5.4.15","businessCategory");A("2.5.4.17","postalCode");A("2.5.4.42","givenName");A("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");A("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");A("2.16.840.1.113730.1.1","nsCertType");A("2.16.840.1.113730.1.13","nsComment");W("2.5.29.1","authorityKeyIdentifier");W("2.5.29.2","keyAttributes");W("2.5.29.3","certificatePolicies");W("2.5.29.4","keyUsageRestriction");W("2.5.29.5","policyMapping");W("2.5.29.6","subtreesConstraint");W("2.5.29.7","subjectAltName");W("2.5.29.8","issuerAltName");W("2.5.29.9","subjectDirectoryAttributes");W("2.5.29.10","basicConstraints");W("2.5.29.11","nameConstraints");W("2.5.29.12","policyConstraints");W("2.5.29.13","basicConstraints");A("2.5.29.14","subjectKeyIdentifier");A("2.5.29.15","keyUsage");W("2.5.29.16","privateKeyUsagePeriod");A("2.5.29.17","subjectAltName");A("2.5.29.18","issuerAltName");A("2.5.29.19","basicConstraints");W("2.5.29.20","cRLNumber");W("2.5.29.21","cRLReason");W("2.5.29.22","expirationDate");W("2.5.29.23","instructionCode");W("2.5.29.24","invalidityDate");W("2.5.29.25","cRLDistributionPoints");W("2.5.29.26","issuingDistributionPoint");W("2.5.29.27","deltaCRLIndicator");W("2.5.29.28","issuingDistributionPoint");W("2.5.29.29","certificateIssuer");W("2.5.29.30","nameConstraints");A("2.5.29.31","cRLDistributionPoints");A("2.5.29.32","certificatePolicies");W("2.5.29.33","policyMappings");W("2.5.29.34","policyConstraints");A("2.5.29.35","authorityKeyIdentifier");W("2.5.29.36","policyConstraints");A("2.5.29.37","extKeyUsage");W("2.5.29.46","freshestCRL");W("2.5.29.54","inhibitAnyPolicy");A("1.3.6.1.4.1.11129.2.4.2","timestampList");A("1.3.6.1.5.5.7.1.1","authorityInfoAccess");A("1.3.6.1.5.5.7.3.1","serverAuth");A("1.3.6.1.5.5.7.3.2","clientAuth");A("1.3.6.1.5.5.7.3.3","codeSigning");A("1.3.6.1.5.5.7.3.4","emailProtection");A("1.3.6.1.5.5.7.3.8","timeStamping")});var Pr=O((Ty,Bo)=>{var X=$();lt();pn();var T=Bo.exports=X.asn1=X.asn1||{};T.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};T.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};T.create=function(t,e,r,n,i){if(X.util.isArray(n)){for(var a=[],o=0;o<n.length;++o)n[o]!==void 0&&a.push(n[o]);n=a}var s={tagClass:t,type:e,constructed:r,composed:r||X.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(s.bitStringContents=i.bitStringContents,s.original=T.copy(s)),s};T.copy=function(t,e){var r;if(X.util.isArray(t)){r=[];for(var n=0;n<t.length;++n)r.push(T.copy(t[n],e));return r}return typeof t=="string"?t:(r={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:T.copy(t.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=t.bitStringContents),r)};T.equals=function(t,e,r){if(X.util.isArray(t)){if(!X.util.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!T.equals(t[n],e[n]))return!1;return!0}if(typeof t!=typeof e)return!1;if(typeof t=="string")return t===e;var i=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&T.equals(t.value,e.value);return r&&r.includeBitStringContents&&(i=i&&t.bitStringContents===e.bitStringContents),i};T.getBerValueLength=function(t){var e=t.getByte();if(e!==128){var r,n=e&128;return n?r=t.getInt((e&127)<<3):r=e,r}};function Dr(t,e,r){if(r>e){var n=new Error("Too few bytes to parse DER.");throw n.available=t.length(),n.remaining=e,n.requested=r,n}}var Cc=function(t,e){var r=t.getByte();if(e--,r!==128){var n,i=r&128;if(!i)n=r;else{var a=r&127;Dr(t,e,a),n=t.getInt(a<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};T.fromDer=function(t,e){e===void 0&&(e={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"parseAllBytes"in e||(e.parseAllBytes=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof t=="string"&&(t=X.util.createBuffer(t));var r=t.length(),n=dn(t,t.length(),0,e);if(e.parseAllBytes&&t.length()!==0){var i=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw i.byteCount=r,i.remaining=t.length(),i}return n};function dn(t,e,r,n){var i;Dr(t,e,2);var a=t.getByte();e--;var o=a&192,s=a&31;i=t.length();var f=Cc(t,e);if(e-=i-t.length(),f!==void 0&&f>e){if(n.strict){var c=new Error("Too few bytes to read ASN.1 value.");throw c.available=t.length(),c.remaining=e,c.requested=f,c}f=e}var u,h,l=(a&32)===32;if(l)if(u=[],f===void 0)for(;;){if(Dr(t,e,2),t.bytes(2)===String.fromCharCode(0,0)){t.getBytes(2),e-=2;break}i=t.length(),u.push(dn(t,e,r+1,n)),e-=i-t.length()}else for(;f>0;)i=t.length(),u.push(dn(t,f,r+1,n)),e-=i-t.length(),f-=i-t.length();if(u===void 0&&o===T.Class.UNIVERSAL&&s===T.Type.BITSTRING&&(h=t.bytes(f)),u===void 0&&n.decodeBitStrings&&o===T.Class.UNIVERSAL&&s===T.Type.BITSTRING&&f>1){var d=t.read,p=e,g=0;if(s===T.Type.BITSTRING&&(Dr(t,e,1),g=t.getByte(),e--),g===0)try{i=t.length();var m={strict:!0,decodeBitStrings:!0},v=dn(t,e,r+1,m),w=i-t.length();e-=w,s==T.Type.BITSTRING&&w++;var B=v.tagClass;w===f&&(B===T.Class.UNIVERSAL||B===T.Class.CONTEXT_SPECIFIC)&&(u=[v])}catch{}u===void 0&&(t.read=d,e=p)}if(u===void 0){if(f===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");f=e}if(s===T.Type.BMPSTRING)for(u="";f>0;f-=2)Dr(t,e,2),u+=String.fromCharCode(t.getInt16()),e-=2;else u=t.getBytes(f),e-=f}var D=h===void 0?null:{bitStringContents:h};return T.create(o,s,l,u,D)}T.toDer=function(t){var e=X.util.createBuffer(),r=t.tagClass|t.type,n=X.util.createBuffer(),i=!1;if("bitStringContents"in t&&(i=!0,t.original&&(i=T.equals(t,t.original))),i)n.putBytes(t.bitStringContents);else if(t.composed){t.constructed?r|=32:n.putByte(0);for(var a=0;a<t.value.length;++a)t.value[a]!==void 0&&n.putBuffer(T.toDer(t.value[a]))}else if(t.type===T.Type.BMPSTRING)for(var a=0;a<t.value.length;++a)n.putInt16(t.value.charCodeAt(a));else t.type===T.Type.INTEGER&&t.value.length>1&&(t.value.charCodeAt(0)===0&&!(t.value.charCodeAt(1)&128)||t.value.charCodeAt(0)===255&&(t.value.charCodeAt(1)&128)===128)?n.putBytes(t.value.substr(1)):n.putBytes(t.value);if(e.putByte(r),n.length()<=127)e.putByte(n.length()&127);else{var o=n.length(),s="";do s+=String.fromCharCode(o&255),o=o>>>8;while(o>0);e.putByte(s.length|128);for(var a=s.length-1;a>=0;--a)e.putByte(s.charCodeAt(a))}return e.putBuffer(n),e};T.oidToDer=function(t){var e=t.split("."),r=X.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var n,i,a,o,s=2;s<e.length;++s){n=!0,i=[],a=parseInt(e[s],10);do o=a&127,a=a>>>7,n||(o|=128),i.push(o),n=!1;while(a>0);for(var f=i.length-1;f>=0;--f)r.putByte(i[f])}return r};T.derToOid=function(t){var e;typeof t=="string"&&(t=X.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var n=0;t.length()>0;)r=t.getByte(),n=n<<7,r&128?n+=r&127:(e+="."+(n+r),n=0);return e};T.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(t.substr(2,2),10)-1,i=parseInt(t.substr(4,2),10),a=parseInt(t.substr(6,2),10),o=parseInt(t.substr(8,2),10),s=0;if(t.length>11){var f=t.charAt(10),c=10;f!=="+"&&f!=="-"&&(s=parseInt(t.substr(10,2),10),c+=2)}if(e.setUTCFullYear(r,n,i),e.setUTCHours(a,o,s,0),c&&(f=t.charAt(c),f==="+"||f==="-")){var u=parseInt(t.substr(c+1,2),10),h=parseInt(t.substr(c+4,2),10),l=u*60+h;l*=6e4,f==="+"?e.setTime(+e-l):e.setTime(+e+l)}return e};T.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),n=parseInt(t.substr(4,2),10)-1,i=parseInt(t.substr(6,2),10),a=parseInt(t.substr(8,2),10),o=parseInt(t.substr(10,2),10),s=parseInt(t.substr(12,2),10),f=0,c=0,u=!1;t.charAt(t.length-1)==="Z"&&(u=!0);var h=t.length-5,l=t.charAt(h);if(l==="+"||l==="-"){var d=parseInt(t.substr(h+1,2),10),p=parseInt(t.substr(h+4,2),10);c=d*60+p,c*=6e4,l==="+"&&(c*=-1),u=!0}return t.charAt(14)==="."&&(f=parseFloat(t.substr(14),10)*1e3),u?(e.setUTCFullYear(r,n,i),e.setUTCHours(a,o,s,f),e.setTime(+e+c)):(e.setFullYear(r,n,i),e.setHours(a,o,s,f)),e};T.dateToUtcTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};T.dateToGeneralizedTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};T.integerToDer=function(t){var e=X.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r};T.derToInteger=function(t){typeof t=="string"&&(t=X.util.createBuffer(t));var e=t.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)};T.validate=function(t,e,r,n){var i=!1;if((t.tagClass===e.tagClass||typeof e.tagClass>"u")&&(t.type===e.type||typeof e.type>"u"))if(t.constructed===e.constructed||typeof e.constructed>"u"){if(i=!0,e.value&&X.util.isArray(e.value))for(var a=0,o=0;i&&o<e.value.length;++o)i=e.value[o].optional||!1,t.value[a]&&(i=T.validate(t.value[a],e.value[o],r,n),i?++a:e.value[o].optional&&(i=!0)),!i&&n&&n.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(i&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(r[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue&&"bitStringContents"in t)){var s;if(t.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var f=t.bitStringContents.charCodeAt(0);if(f!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=t.bitStringContents.slice(1)}}}else n&&n.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');else n&&(t.tagClass!==e.tagClass&&n.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&n.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));return i};var Eo=/[^\\u0000-\\u00ff]/;T.prettyPrint=function(t,e,r){var n="";e=e||0,r=r||2,e>0&&(n+=`
`);for(var i="",a=0;a<e*r;++a)i+=" ";switch(n+=i+"Tag: ",t.tagClass){case T.Class.UNIVERSAL:n+="Universal:";break;case T.Class.APPLICATION:n+="Application:";break;case T.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case T.Class.PRIVATE:n+="Private:";break}if(t.tagClass===T.Class.UNIVERSAL)switch(n+=t.type,t.type){case T.Type.NONE:n+=" (None)";break;case T.Type.BOOLEAN:n+=" (Boolean)";break;case T.Type.INTEGER:n+=" (Integer)";break;case T.Type.BITSTRING:n+=" (Bit string)";break;case T.Type.OCTETSTRING:n+=" (Octet string)";break;case T.Type.NULL:n+=" (Null)";break;case T.Type.OID:n+=" (Object Identifier)";break;case T.Type.ODESC:n+=" (Object Descriptor)";break;case T.Type.EXTERNAL:n+=" (External or Instance of)";break;case T.Type.REAL:n+=" (Real)";break;case T.Type.ENUMERATED:n+=" (Enumerated)";break;case T.Type.EMBEDDED:n+=" (Embedded PDV)";break;case T.Type.UTF8:n+=" (UTF8)";break;case T.Type.ROID:n+=" (Relative Object Identifier)";break;case T.Type.SEQUENCE:n+=" (Sequence)";break;case T.Type.SET:n+=" (Set)";break;case T.Type.PRINTABLESTRING:n+=" (Printable String)";break;case T.Type.IA5String:n+=" (IA5String (ASCII))";break;case T.Type.UTCTIME:n+=" (UTC time)";break;case T.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case T.Type.BMPSTRING:n+=" (BMP String)";break}else n+=t.type;if(n+=`
`,n+=i+"Constructed: "+t.constructed+`
`,t.composed){for(var o=0,s="",a=0;a<t.value.length;++a)t.value[a]!==void 0&&(o+=1,s+=T.prettyPrint(t.value[a],e+1,r),a+1<t.value.length&&(s+=","));n+=i+"Sub values: "+o+s}else{if(n+=i+"Value: ",t.type===T.Type.OID){var f=T.derToOid(t.value);n+=f,X.pki&&X.pki.oids&&f in X.pki.oids&&(n+=" ("+X.pki.oids[f]+") ")}if(t.type===T.Type.INTEGER)try{n+=T.derToInteger(t.value)}catch{n+="0x"+X.util.bytesToHex(t.value)}else if(t.type===T.Type.BITSTRING){if(t.value.length>1?n+="0x"+X.util.bytesToHex(t.value.slice(1)):n+="(none)",t.value.length>0){var c=t.value.charCodeAt(0);c==1?n+=" (1 unused bit shown)":c>1&&(n+=" ("+c+" unused bits shown)")}}else if(t.type===T.Type.OCTETSTRING)Eo.test(t.value)||(n+="("+t.value+") "),n+="0x"+X.util.bytesToHex(t.value);else if(t.type===T.Type.UTF8)try{n+=X.util.decodeUtf8(t.value)}catch(u){if(u.message==="URI malformed")n+="0x"+X.util.bytesToHex(t.value)+" (malformed UTF8)";else throw u}else t.type===T.Type.PRINTABLESTRING||t.type===T.Type.IA5String?n+=t.value:Eo.test(t.value)?n+="0x"+X.util.bytesToHex(t.value):t.value.length===0?n+="[null]":n+=t.value}return n}});var hi=O((_y,Ao)=>{var dt=$();lt();Ao.exports=dt.cipher=dt.cipher||{};dt.cipher.algorithms=dt.cipher.algorithms||{};dt.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=dt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new dt.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};dt.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=dt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new dt.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};dt.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),dt.cipher.algorithms[t]=e};dt.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in dt.cipher.algorithms?dt.cipher.algorithms[t]:null};var ui=dt.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};ui.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=dt.util.createBuffer(),this.output=t.output||dt.util.createBuffer(),this.mode.start(e)};ui.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};ui.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var pi=O((Ry,Co)=>{var yt=$();lt();yt.cipher=yt.cipher||{};var M=Co.exports=yt.cipher.modes=yt.cipher.modes||{};M.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};M.ecb.prototype.start=function(t){};M.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};M.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};M.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};M.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};M.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};M.cbc.prototype.start=function(t){if(t.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in t)this._iv=yn(t.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};M.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]);this._prev=this._outBlock};M.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};M.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};M.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};M.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=yt.util.createBuffer(),this._partialBytes=0};M.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=yn(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};M.cfb.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32()^this._outBlock[i],e.putInt32(this._inBlock[i]);return}var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(a>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};M.cfb.prototype.decrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32(),e.putInt32(this._inBlock[i]^this._outBlock[i]);return}var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(a>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};M.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=yt.util.createBuffer(),this._partialBytes=0};M.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=yn(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};M.ofb.prototype.encrypt=function(t,e,r){var n=t.length();if(t.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(a>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};M.ofb.prototype.decrypt=M.ofb.prototype.encrypt;M.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=yt.util.createBuffer(),this._partialBytes=0};M.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=yn(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};M.ctr.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]);else{var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(a>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}gn(this._inBlock)};M.ctr.prototype.decrypt=M.ctr.prototype.encrypt;M.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=yt.util.createBuffer(),this._partialBytes=0,this._R=3774873600};M.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e=yt.util.createBuffer(t.iv);this._cipherLength=0;var r;if("additionalData"in t?r=yt.util.createBuffer(t.additionalData):r=yt.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=yt.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=e.length();if(n===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(li(n*8)))}this._inBlock=this._j0.slice(0),gn(this._inBlock),this._partialBytes=0,r=yt.util.createBuffer(r),this._aDataLength=li(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};M.gcm.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^=t.getInt32());this._cipherLength+=this.blockSize}else{var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(a<=0||r){if(r){var o=n%this.blockSize;this._cipherLength+=o,this._partialOutput.truncate(this.blockSize-o)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),gn(this._inBlock)};M.gcm.prototype.decrypt=function(t,e,r){var n=t.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),gn(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};M.gcm.prototype.afterFinish=function(t,e){var r=!0;e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=yt.util.createBuffer();var n=this._aDataLength.concat(li(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var a=0;a<this._ints;++a)this.tag.putInt32(this._s[a]^i[a]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};M.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],n=e.slice(0),i=0;i<128;++i){var a=t[i/32|0]&1<<31-i%32;a&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};M.gcm.prototype.pow=function(t,e){for(var r=t[3]&1,n=3;n>0;--n)e[n]=t[n]>>>1|(t[n-1]&1)<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)};M.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=t[n]>>>(7-r%8)*4&15,a=this._m[r][i];e[0]^=a[0],e[1]^=a[1],e[2]^=a[2],e[3]^=a[3]}return e};M.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};M.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,n=4*r,i=16*r,a=new Array(i),o=0;o<i;++o){var s=[0,0,0,0],f=o/n|0,c=(n-1-o%n)*e;s[f]=1<<e-1<<c,a[o]=this.generateSubHashTable(this.multiply(s,t),e)}return a};M.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,n=r>>>1,i=new Array(r);i[n]=t.slice(0);for(var a=n>>>1;a>0;)this.pow(i[2*a],i[a]=[]),a>>=1;for(a=2;a<n;){for(var o=1;o<a;++o){var s=i[a],f=i[o];i[a+o]=[s[0]^f[0],s[1]^f[1],s[2]^f[2],s[3]^f[3]]}a*=2}for(i[0]=[0,0,0,0],a=n+1;a<r;++a){var c=i[a^n];i[a]=[t[0]^c[0],t[1]^c[1],t[2]^c[2],t[3]^c[3]]}return i};function yn(t,e){if(typeof t=="string"&&(t=yt.util.createBuffer(t)),yt.util.isArray(t)&&t.length>4){var r=t;t=yt.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!yt.util.isArray(t)){for(var i=[],a=e/4,n=0;n<a;++n)i.push(t.getInt32());t=i}return t}function gn(t){t[t.length-1]=t[t.length-1]+1&4294967295}function li(t){return[t/4294967296|0,t&4294967295]}});var xi=O((Dy,Ro)=>{var Q=$();hi();pi();lt();Ro.exports=Q.aes=Q.aes||{};Q.aes.startEncrypting=function(t,e,r,n){var i=xn({key:t,output:r,decrypt:!1,mode:n});return i.start(e),i};Q.aes.createEncryptionCipher=function(t,e){return xn({key:t,output:null,decrypt:!1,mode:e})};Q.aes.startDecrypting=function(t,e,r,n){var i=xn({key:t,output:r,decrypt:!0,mode:n});return i.start(e),i};Q.aes.createDecryptionCipher=function(t,e){return xn({key:t,output:null,decrypt:!0,mode:e})};Q.aes.Algorithm=function(t,e){gi||To();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:function(n,i){return yi(r._w,n,i,!1)},decrypt:function(n,i){return yi(r._w,n,i,!0)}}}),r._init=!1};Q.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=Q.util.createBuffer(e);else if(Q.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=Q.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(!Q.util.isArray(e)){r=e,e=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)e.push(r.getInt32())}}if(!Q.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var a=this.mode.name,o=["CFB","OFB","CTR","GCM"].indexOf(a)!==-1;this._w=_o(e,t.decrypt&&!o),this._init=!0}};Q.aes._expandKey=function(t,e){return gi||To(),_o(t,e)};Q.aes._updateBlock=yi;$e("AES-ECB",Q.cipher.modes.ecb);$e("AES-CBC",Q.cipher.modes.cbc);$e("AES-CFB",Q.cipher.modes.cfb);$e("AES-OFB",Q.cipher.modes.ofb);$e("AES-CTR",Q.cipher.modes.ctr);$e("AES-GCM",Q.cipher.modes.gcm);function $e(t,e){var r=function(){return new Q.aes.Algorithm(t,e)};Q.cipher.registerAlgorithm(t,r)}var gi=!1,Ze=4,St,di,Io,Re,Ot;function To(){gi=!0,Io=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;St=new Array(256),di=new Array(256),Re=new Array(4),Ot=new Array(4);for(var e=0;e<4;++e)Re[e]=new Array(256),Ot[e]=new Array(256);for(var r=0,n=0,i,a,o,s,f,c,u,e=0;e<256;++e){s=n^n<<1^n<<2^n<<3^n<<4,s=s>>8^s&255^99,St[r]=s,di[s]=r,f=t[s],i=t[r],a=t[i],o=t[a],c=f<<24^s<<16^s<<8^(s^f),u=(i^a^o)<<24^(r^o)<<16^(r^a^o)<<8^(r^i^o);for(var h=0;h<4;++h)Re[h][r]=c,Ot[h][s]=u,c=c<<24|c>>>8,u=u<<24|u>>>8;r===0?r=n=1:(r=i^t[t[t[i^o]]],n^=t[t[n]])}}function _o(t,e){for(var r=t.slice(0),n,i=1,a=r.length,o=a+6+1,s=Ze*o,f=a;f<s;++f)n=r[f-1],f%a===0?(n=St[n>>>16&255]<<24^St[n>>>8&255]<<16^St[n&255]<<8^St[n>>>24]^Io[i]<<24,i++):a>6&&f%a===4&&(n=St[n>>>24]<<24^St[n>>>16&255]<<16^St[n>>>8&255]<<8^St[n&255]),r[f]=r[f-a]^n;if(e){var c,u=Ot[0],h=Ot[1],l=Ot[2],d=Ot[3],p=r.slice(0);s=r.length;for(var f=0,g=s-Ze;f<s;f+=Ze,g-=Ze)if(f===0||f===s-Ze)p[f]=r[g],p[f+1]=r[g+3],p[f+2]=r[g+2],p[f+3]=r[g+1];else for(var m=0;m<Ze;++m)c=r[g+m],p[f+(3&-m)]=u[St[c>>>24]]^h[St[c>>>16&255]]^l[St[c>>>8&255]]^d[St[c&255]];r=p}return r}function yi(t,e,r,n){var i=t.length/4-1,a,o,s,f,c;n?(a=Ot[0],o=Ot[1],s=Ot[2],f=Ot[3],c=di):(a=Re[0],o=Re[1],s=Re[2],f=Re[3],c=St);var u,h,l,d,p,g,m;u=e[0]^t[0],h=e[n?3:1]^t[1],l=e[2]^t[2],d=e[n?1:3]^t[3];for(var v=3,w=1;w<i;++w)p=a[u>>>24]^o[h>>>16&255]^s[l>>>8&255]^f[d&255]^t[++v],g=a[h>>>24]^o[l>>>16&255]^s[d>>>8&255]^f[u&255]^t[++v],m=a[l>>>24]^o[d>>>16&255]^s[u>>>8&255]^f[h&255]^t[++v],d=a[d>>>24]^o[u>>>16&255]^s[h>>>8&255]^f[l&255]^t[++v],u=p,h=g,l=m;r[0]=c[u>>>24]<<24^c[h>>>16&255]<<16^c[l>>>8&255]<<8^c[d&255]^t[++v],r[n?3:1]=c[h>>>24]<<24^c[l>>>16&255]<<16^c[d>>>8&255]<<8^c[u&255]^t[++v],r[2]=c[l>>>24]<<24^c[d>>>16&255]<<16^c[u>>>8&255]<<8^c[h&255]^t[++v],r[n?1:3]=c[d>>>24]<<24^c[u>>>16&255]<<16^c[h>>>8&255]<<8^c[l&255]^t[++v]}function xn(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,n;t.decrypt?n=Q.cipher.createDecipher(r,t.key):n=Q.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(a,o){var s=null;o instanceof Q.util.ByteBuffer&&(s=o,o={}),o=o||{},o.output=s,o.iv=a,i.call(n,o)},n}});var ko=O((Py,Po)=>{var et=$();hi();pi();lt();Po.exports=et.des=et.des||{};et.des.startEncrypting=function(t,e,r,n){var i=mn({key:t,output:r,decrypt:!1,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};et.des.createEncryptionCipher=function(t,e){return mn({key:t,output:null,decrypt:!1,mode:e})};et.des.startDecrypting=function(t,e,r,n){var i=mn({key:t,output:r,decrypt:!0,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};et.des.createDecryptionCipher=function(t,e){return mn({key:t,output:null,decrypt:!0,mode:e})};et.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:function(n,i){return Do(r._keys,n,i,!1)},decrypt:function(n,i){return Do(r._keys,n,i,!0)}}}),r._init=!1};et.des.Algorithm.prototype.initialize=function(t){if(!this._init){var e=et.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=Lc(e),this._init=!0}};Wt("DES-ECB",et.cipher.modes.ecb);Wt("DES-CBC",et.cipher.modes.cbc);Wt("DES-CFB",et.cipher.modes.cfb);Wt("DES-OFB",et.cipher.modes.ofb);Wt("DES-CTR",et.cipher.modes.ctr);Wt("3DES-ECB",et.cipher.modes.ecb);Wt("3DES-CBC",et.cipher.modes.cbc);Wt("3DES-CFB",et.cipher.modes.cfb);Wt("3DES-OFB",et.cipher.modes.ofb);Wt("3DES-CTR",et.cipher.modes.ctr);function Wt(t,e){var r=function(){return new et.des.Algorithm(t,e)};et.cipher.registerAlgorithm(t,r)}var Ic=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],Tc=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],_c=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],Rc=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],Dc=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],Pc=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],kc=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],Nc=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function Lc(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],a=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],o=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],s=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],f=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],c=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],u=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],l=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],d=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],p=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],g=t.length()>8?3:1,m=[],v=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],w=0,B,D=0;D<g;D++){var C=t.getInt32(),I=t.getInt32();B=(C>>>4^I)&252645135,I^=B,C^=B<<4,B=(I>>>-16^C)&65535,C^=B,I^=B<<-16,B=(C>>>2^I)&858993459,I^=B,C^=B<<2,B=(I>>>-16^C)&65535,C^=B,I^=B<<-16,B=(C>>>1^I)&1431655765,I^=B,C^=B<<1,B=(I>>>8^C)&16711935,C^=B,I^=B<<8,B=(C>>>1^I)&1431655765,I^=B,C^=B<<1,B=C<<8|I>>>20&240,C=I<<24|I<<8&16711680|I>>>8&65280|I>>>24&240,I=B;for(var L=0;L<v.length;++L){v[L]?(C=C<<2|C>>>26,I=I<<2|I>>>26):(C=C<<1|C>>>27,I=I<<1|I>>>27),C&=-15,I&=-15;var K=e[C>>>28]|r[C>>>24&15]|n[C>>>20&15]|i[C>>>16&15]|a[C>>>12&15]|o[C>>>8&15]|s[C>>>4&15],it=f[I>>>28]|c[I>>>24&15]|u[I>>>20&15]|h[I>>>16&15]|l[I>>>12&15]|d[I>>>8&15]|p[I>>>4&15];B=(it>>>16^K)&65535,m[w++]=K^B,m[w++]=it^B<<16}}return m}function Do(t,e,r,n){var i=t.length===32?3:9,a;i===3?a=n?[30,-2,-2]:[0,32,2]:a=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var o,s=e[0],f=e[1];o=(s>>>4^f)&252645135,f^=o,s^=o<<4,o=(s>>>16^f)&65535,f^=o,s^=o<<16,o=(f>>>2^s)&858993459,s^=o,f^=o<<2,o=(f>>>8^s)&16711935,s^=o,f^=o<<8,o=(s>>>1^f)&1431655765,f^=o,s^=o<<1,s=s<<1|s>>>31,f=f<<1|f>>>31;for(var c=0;c<i;c+=3){for(var u=a[c+1],h=a[c+2],l=a[c];l!=u;l+=h){var d=f^t[l],p=(f>>>4|f<<28)^t[l+1];o=s,s=f,f=o^(Tc[d>>>24&63]|Rc[d>>>16&63]|Pc[d>>>8&63]|Nc[d&63]|Ic[p>>>24&63]|_c[p>>>16&63]|Dc[p>>>8&63]|kc[p&63])}o=s,s=f,f=o}s=s>>>1|s<<31,f=f>>>1|f<<31,o=(s>>>1^f)&1431655765,f^=o,s^=o<<1,o=(f>>>8^s)&16711935,s^=o,f^=o<<8,o=(f>>>2^s)&858993459,s^=o,f^=o<<2,o=(s>>>16^f)&65535,f^=o,s^=o<<16,o=(s>>>4^f)&252645135,f^=o,s^=o<<4,r[0]=s,r[1]=f}function mn(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,n;t.decrypt?n=et.cipher.createDecipher(r,t.key):n=et.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(a,o){var s=null;o instanceof et.util.ByteBuffer&&(s=o,o={}),o=o||{},o.output=s,o.iv=a,i.call(n,o)},n}});var De=O((ky,No)=>{var vn=$();No.exports=vn.md=vn.md||{};vn.md.algorithms=vn.md.algorithms||{}});var Uo=O((Ny,Lo)=>{var ae=$();De();lt();var Uc=Lo.exports=ae.hmac=ae.hmac||{};Uc.create=function(){var t=null,e=null,r=null,n=null,i={};return i.start=function(a,o){if(a!==null)if(typeof a=="string")if(a=a.toLowerCase(),a in ae.md.algorithms)e=ae.md.algorithms[a].create();else throw new Error('Unknown hash algorithm "'+a+'"');else e=a;if(o===null)o=t;else{if(typeof o=="string")o=ae.util.createBuffer(o);else if(ae.util.isArray(o)){var s=o;o=ae.util.createBuffer();for(var f=0;f<s.length;++f)o.putByte(s[f])}var c=o.length();c>e.blockLength&&(e.start(),e.update(o.bytes()),o=e.digest()),r=ae.util.createBuffer(),n=ae.util.createBuffer(),c=o.length();for(var f=0;f<c;++f){var s=o.at(f);r.putByte(54^s),n.putByte(92^s)}if(c<e.blockLength)for(var s=e.blockLength-c,f=0;f<s;++f)r.putByte(54),n.putByte(92);t=o,r=r.bytes(),n=n.bytes()}e.start(),e.update(r)},i.update=function(a){e.update(a)},i.getMac=function(){var a=e.digest().bytes();return e.start(),e.update(n),e.update(a),e.digest()},i.digest=i.getMac,i}});var Ye=O(()=>{});var Fo=O((Ky,Ko)=>{var Et=$();Uo();De();lt();var Kc=Et.pkcs5=Et.pkcs5||{},oe;Et.util.isNodejs&&!Et.options.usePureJavaScript&&(oe=Ye());Ko.exports=Et.pbkdf2=Kc.pbkdf2=function(t,e,r,n,i,a){if(typeof i=="function"&&(a=i,i=null),Et.util.isNodejs&&!Et.options.usePureJavaScript&&oe.pbkdf2&&(i===null||typeof i!="object")&&(oe.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),a?oe.pbkdf2Sync.length===4?oe.pbkdf2(t,e,r,n,function(B,D){if(B)return a(B);a(null,D.toString("binary"))}):oe.pbkdf2(t,e,r,n,i,function(B,D){if(B)return a(B);a(null,D.toString("binary"))}):oe.pbkdf2Sync.length===4?oe.pbkdf2Sync(t,e,r,n).toString("binary"):oe.pbkdf2Sync(t,e,r,n,i).toString("binary");if((typeof i>"u"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in Et.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=Et.md[i].create()}var o=i.digestLength;if(n>4294967295*o){var s=new Error("Derived key is too long.");if(a)return a(s);throw s}var f=Math.ceil(n/o),c=n-(f-1)*o,u=Et.hmac.create();u.start(i,t);var h="",l,d,p;if(!a){for(var g=1;g<=f;++g){u.start(null,null),u.update(e),u.update(Et.util.int32ToBytes(g)),l=p=u.digest().getBytes();for(var m=2;m<=r;++m)u.start(null,null),u.update(p),d=u.digest().getBytes(),l=Et.util.xorBytes(l,d,o),p=d;h+=g<f?l:l.substr(0,c)}return h}var g=1,m;function v(){if(g>f)return a(null,h);u.start(null,null),u.update(e),u.update(Et.util.int32ToBytes(g)),l=p=u.digest().getBytes(),m=2,w()}function w(){if(m<=r)return u.start(null,null),u.update(p),d=u.digest().getBytes(),l=Et.util.xorBytes(l,d,o),p=d,++m,Et.util.setImmediate(w);h+=g<f?l:l.substr(0,c),++g,v()}v()}});var Vo=O((Fy,Mo)=>{var wn=$();lt();var Oo=Mo.exports=wn.pem=wn.pem||{};Oo.encode=function(t,e){e=e||{};var r="-----BEGIN "+t.type+`-----\r
`,n;if(t.procType&&(n={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]},r+=bn(n)),t.contentDomain&&(n={name:"Content-Domain",values:[t.contentDomain]},r+=bn(n)),t.dekInfo&&(n={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&n.values.push(t.dekInfo.parameters),r+=bn(n)),t.headers)for(var i=0;i<t.headers.length;++i)r+=bn(t.headers[i]);return t.procType&&(r+=`\r
`),r+=wn.util.encode64(t.body,e.maxline||64)+`\r
`,r+="-----END "+t.type+`-----\r
`,r};Oo.decode=function(t){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,a;a=r.exec(t),!!a;){var o=a[1];o==="NEW CERTIFICATE REQUEST"&&(o="CERTIFICATE REQUEST");var s={type:o,procType:null,contentDomain:null,dekInfo:null,headers:[],body:wn.util.decode64(a[3])};if(e.push(s),!!a[2]){for(var f=a[2].split(i),c=0;a&&c<f.length;){for(var u=f[c].replace(/\s+$/,""),h=c+1;h<f.length;++h){var l=f[h];if(!/\s/.test(l[0]))break;u+=l,c=h}if(a=u.match(n),a){for(var d={name:a[1],values:[]},p=a[2].split(","),g=0;g<p.length;++g)d.values.push(Fc(p[g]));if(s.procType)if(!s.contentDomain&&d.name==="Content-Domain")s.contentDomain=p[0]||"";else if(!s.dekInfo&&d.name==="DEK-Info"){if(d.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');s.dekInfo={algorithm:p[0],parameters:p[1]||null}}else s.headers.push(d);else{if(d.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(d.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');s.procType={version:p[0],type:p[1]}}}++c}if(s.procType==="ENCRYPTED"&&!s.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function bn(t){for(var e=t.name+": ",r=[],n=function(f,c){return" "+c},i=0;i<t.values.length;++i)r.push(t.values[i].replace(/^(\S+\r\n)/,n));e+=r.join(",")+`\r
`;for(var a=0,o=-1,i=0;i<e.length;++i,++a)if(a>65&&o!==-1){var s=e[o];s===","?(++o,e=e.substr(0,o)+`\r
 `+e.substr(o)):e=e.substr(0,o)+`\r
`+s+e.substr(o+1),a=i-o-1,o=-1,++i}else(e[i]===" "||e[i]==="	"||e[i]===",")&&(o=i);return e}function Fc(t){return t.replace(/^\s+/,"")}});var Zo=O((Oy,Wo)=>{var Zt=$();De();lt();var zo=Wo.exports=Zt.sha256=Zt.sha256||{};Zt.md.sha256=Zt.md.algorithms.sha256=zo;zo.create=function(){Ho||Oc();var t=null,e=Zt.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,a=0;a<i;++a)n.fullMessageLength.push(0);return e=Zt.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,a){a==="utf8"&&(i=Zt.util.encodeUtf8(i));var o=i.length;n.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var s=n.fullMessageLength.length-1;s>=0;--s)n.fullMessageLength[s]+=o[1],o[1]=o[0]+(n.fullMessageLength[s]/4294967296>>>0),n.fullMessageLength[s]=n.fullMessageLength[s]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(i),qo(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=Zt.util.createBuffer();i.putBytes(e.bytes());var a=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,o=a&n.blockLength-1;i.putBytes(mi.substr(0,n.blockLength-o));for(var s,f,c=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)s=n.fullMessageLength[u+1]*8,f=s/4294967296>>>0,c+=f,i.putInt32(c>>>0),c=s>>>0;i.putInt32(c);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};qo(h,r,i);var l=Zt.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l.putInt32(h.h5),l.putInt32(h.h6),l.putInt32(h.h7),l},n};var mi=null,Ho=!1,Go=null;function Oc(){mi=String.fromCharCode(128),mi+=Zt.util.fillString(String.fromCharCode(0),64),Go=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],Ho=!0}function qo(t,e,r){for(var n,i,a,o,s,f,c,u,h,l,d,p,g,m,v,w=r.length();w>=64;){for(c=0;c<16;++c)e[c]=r.getInt32();for(;c<64;++c)n=e[c-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=e[c-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,e[c]=n+e[c-7]+i+e[c-16]|0;for(u=t.h0,h=t.h1,l=t.h2,d=t.h3,p=t.h4,g=t.h5,m=t.h6,v=t.h7,c=0;c<64;++c)o=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7),s=m^p&(g^m),a=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),f=u&h|l&(u^h),n=v+o+s+Go[c]+e[c],i=a+f,v=m,m=g,g=p,p=d+n>>>0,d=l,l=h,h=u,u=n+i>>>0;t.h0=t.h0+u|0,t.h1=t.h1+h|0,t.h2=t.h2+l|0,t.h3=t.h3+d|0,t.h4=t.h4+p|0,t.h5=t.h5+g|0,t.h6=t.h6+m|0,t.h7=t.h7+v|0,w-=64}}});var Yo=O((My,$o)=>{var $t=$();lt();var Sn=null;$t.util.isNodejs&&!$t.options.usePureJavaScript&&!process.versions["node-webkit"]&&(Sn=Ye());var Mc=$o.exports=$t.prng=$t.prng||{};Mc.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=t.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();e.pools=n,e.pool=0,e.generate=function(c,u){if(!u)return e.generateSync(c);var h=e.plugin.cipher,l=e.plugin.increment,d=e.plugin.formatKey,p=e.plugin.formatSeed,g=$t.util.createBuffer();e.key=null,m();function m(v){if(v)return u(v);if(g.length()>=c)return u(null,g.getBytes(c));if(e.generated>1048575&&(e.key=null),e.key===null)return $t.util.nextTick(function(){a(m)});var w=h(e.key,e.seed);e.generated+=w.length,g.putBytes(w),e.key=d(h(e.key,l(e.seed))),e.seed=p(h(e.key,e.seed)),$t.util.setImmediate(m)}},e.generateSync=function(c){var u=e.plugin.cipher,h=e.plugin.increment,l=e.plugin.formatKey,d=e.plugin.formatSeed;e.key=null;for(var p=$t.util.createBuffer();p.length()<c;){e.generated>1048575&&(e.key=null),e.key===null&&o();var g=u(e.key,e.seed);e.generated+=g.length,p.putBytes(g),e.key=l(u(e.key,h(e.seed))),e.seed=d(u(e.key,e.seed))}return p.getBytes(c)};function a(c){if(e.pools[0].messageLength>=32)return s(),c();var u=32-e.pools[0].messageLength<<5;e.seedFile(u,function(h,l){if(h)return c(h);e.collect(l),s(),c()})}function o(){if(e.pools[0].messageLength>=32)return s();var c=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(c)),s()}function s(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var c=e.plugin.md.create();c.update(e.keyBytes);for(var u=1,h=0;h<32;++h)e.reseeds%u===0&&(c.update(e.pools[h].digest().getBytes()),e.pools[h].start()),u=u<<1;e.keyBytes=c.digest().getBytes(),c.start(),c.update(e.keyBytes);var l=c.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(l),e.generated=0}function f(c){var u=null,h=$t.util.globalScope,l=h.crypto||h.msCrypto;l&&l.getRandomValues&&(u=function(C){return l.getRandomValues(C)});var d=$t.util.createBuffer();if(u)for(;d.length()<c;){var p=Math.max(1,Math.min(c-d.length(),65536)/4),g=new Uint32Array(Math.floor(p));try{u(g);for(var m=0;m<g.length;++m)d.putInt32(g[m])}catch(C){if(!(typeof QuotaExceededError<"u"&&C instanceof QuotaExceededError))throw C}}if(d.length()<c)for(var v,w,B,D=Math.floor(Math.random()*65536);d.length()<c;){w=16807*(D&65535),v=16807*(D>>16),w+=(v&32767)<<16,w+=v>>15,w=(w&2147483647)+(w>>31),D=w&4294967295;for(var m=0;m<3;++m)B=D>>>(m<<3),B^=Math.floor(Math.random()*256),d.putByte(B&255)}return d.getBytes(c)}return Sn?(e.seedFile=function(c,u){Sn.randomBytes(c,function(h,l){if(h)return u(h);u(null,l.toString())})},e.seedFileSync=function(c){return Sn.randomBytes(c).toString()}):(e.seedFile=function(c,u){try{u(null,f(c))}catch(h){u(h)}},e.seedFileSync=f),e.collect=function(c){for(var u=c.length,h=0;h<u;++h)e.pools[e.pool].update(c.substr(h,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(c,u){for(var h="",l=0;l<u;l+=8)h+=String.fromCharCode(c>>l&255);e.collect(h)},e.registerWorker=function(c){if(c===self)e.seedFile=function(h,l){function d(p){var g=p.data;g.forge&&g.forge.prng&&(self.removeEventListener("message",d),l(g.forge.prng.err,g.forge.prng.bytes))}self.addEventListener("message",d),self.postMessage({forge:{prng:{needed:h}}})};else{var u=function(h){var l=h.data;l.forge&&l.forge.prng&&e.seedFile(l.forge.prng.needed,function(d,p){c.postMessage({forge:{prng:{err:d,bytes:p}}})})};c.addEventListener("message",u)}},e}});var kr=O((Vy,vi)=>{var gt=$();xi();Zo();Yo();lt();(function(){if(gt.random&&gt.random.getBytes){vi.exports=gt.random;return}(function(t){var e={},r=new Array(4),n=gt.util.createBuffer();e.formatKey=function(h){var l=gt.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),gt.aes._expandKey(h,!1)},e.formatSeed=function(h){var l=gt.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),h},e.cipher=function(h,l){return gt.aes._updateBlock(h,l,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},e.increment=function(h){return++h[3],h},e.md=gt.md.sha256;function i(){var h=gt.prng.create(e);return h.getBytes=function(l,d){return h.generate(l,d)},h.getBytesSync=function(l){return h.generate(l)},h}var a=i(),o=null,s=gt.util.globalScope,f=s.crypto||s.msCrypto;if(f&&f.getRandomValues&&(o=function(h){return f.getRandomValues(h)}),gt.options.usePureJavaScript||!gt.util.isNodejs&&!o){if(typeof window>"u"||window.document,a.collectInt(+new Date,32),typeof navigator<"u"){var c="";for(var u in navigator)try{typeof navigator[u]=="string"&&(c+=navigator[u])}catch{}a.collect(c),c=null}t&&(t().mousemove(function(h){a.collectInt(h.clientX,16),a.collectInt(h.clientY,16)}),t().keypress(function(h){a.collectInt(h.charCode,8)}))}if(!gt.random)gt.random=a;else for(var u in a)gt.random[u]=a[u];gt.random.createInstance=i,vi.exports=gt.random})(typeof jQuery<"u"?jQuery:null)})()});var jo=O((qy,Jo)=>{var It=$();lt();var bi=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],Qo=[1,2,3,5],Vc=function(t,e){return t<<e&65535|(t&65535)>>16-e},qc=function(t,e){return(t&65535)>>e|t<<16-e&65535};Jo.exports=It.rc2=It.rc2||{};It.rc2.expandKey=function(t,e){typeof t=="string"&&(t=It.util.createBuffer(t)),e=e||128;var r=t,n=t.length(),i=e,a=Math.ceil(i/8),o=255>>(i&7),s;for(s=n;s<128;s++)r.putByte(bi[r.at(s-1)+r.at(s-n)&255]);for(r.setAt(128-a,bi[r.at(128-a)&o]),s=127-a;s>=0;s--)r.setAt(s,bi[r.at(s+1)^r.at(s+a)]);return r};var Xo=function(t,e,r){var n=!1,i=null,a=null,o=null,s,f,c,u,h=[];for(t=It.rc2.expandKey(t,e),c=0;c<64;c++)h.push(t.getInt16Le());r?(s=function(p){for(c=0;c<4;c++)p[c]+=h[u]+(p[(c+3)%4]&p[(c+2)%4])+(~p[(c+3)%4]&p[(c+1)%4]),p[c]=Vc(p[c],Qo[c]),u++},f=function(p){for(c=0;c<4;c++)p[c]+=h[p[(c+3)%4]&63]}):(s=function(p){for(c=3;c>=0;c--)p[c]=qc(p[c],Qo[c]),p[c]-=h[u]+(p[(c+3)%4]&p[(c+2)%4])+(~p[(c+3)%4]&p[(c+1)%4]),u--},f=function(p){for(c=3;c>=0;c--)p[c]-=h[p[(c+3)%4]&63]});var l=function(p){var g=[];for(c=0;c<4;c++){var m=i.getInt16Le();o!==null&&(r?m^=o.getInt16Le():o.putInt16Le(m)),g.push(m&65535)}u=r?0:63;for(var v=0;v<p.length;v++)for(var w=0;w<p[v][0];w++)p[v][1](g);for(c=0;c<4;c++)o!==null&&(r?o.putInt16Le(g[c]):g[c]^=o.getInt16Le()),a.putInt16Le(g[c])},d=null;return d={start:function(p,g){p&&typeof p=="string"&&(p=It.util.createBuffer(p)),n=!1,i=It.util.createBuffer(),a=g||new It.util.createBuffer,o=p,d.output=a},update:function(p){for(n||i.putBuffer(p);i.length()>=8;)l([[5,s],[1,f],[6,s],[1,f],[5,s]])},finish:function(p){var g=!0;if(r)if(p)g=p(8,i,!r);else{var m=i.length()===8?8:8-i.length();i.fillWithByte(m,m)}if(g&&(n=!0,d.update()),!r&&(g=i.length()===0,g))if(p)g=p(8,a,!r);else{var v=a.length(),w=a.at(v-1);w>v?g=!1:a.truncate(w)}return g}},d};It.rc2.startEncrypting=function(t,e,r){var n=It.rc2.createEncryptionCipher(t,128);return n.start(e,r),n};It.rc2.createEncryptionCipher=function(t,e){return Xo(t,e,!0)};It.rc2.startDecrypting=function(t,e,r){var n=It.rc2.createDecryptionCipher(t,128);return n.start(e,r),n};It.rc2.createDecryptionCipher=function(t,e){return Xo(t,e,!1)}});var An=O((zy,ss)=>{var wi=$();ss.exports=wi.jsbn=wi.jsbn||{};var se,zc=0xdeadbeefcafe,ts=(zc&16777215)==15715070;function S(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}wi.jsbn.BigInteger=S;function H(){return new S(null)}function Hc(t,e,r,n,i,a){for(;--a>=0;){var o=e*this.data[t++]+r.data[n]+i;i=Math.floor(o/67108864),r.data[n++]=o&67108863}return i}function Gc(t,e,r,n,i,a){for(var o=e&32767,s=e>>15;--a>=0;){var f=this.data[t]&32767,c=this.data[t++]>>15,u=s*f+c*o;f=o*f+((u&32767)<<15)+r.data[n]+(i&1073741823),i=(f>>>30)+(u>>>15)+s*c+(i>>>30),r.data[n++]=f&1073741823}return i}function es(t,e,r,n,i,a){for(var o=e&16383,s=e>>14;--a>=0;){var f=this.data[t]&16383,c=this.data[t++]>>14,u=s*f+c*o;f=o*f+((u&16383)<<14)+r.data[n]+i,i=(f>>28)+(u>>14)+s*c,r.data[n++]=f&268435455}return i}typeof navigator>"u"?(S.prototype.am=es,se=28):ts&&navigator.appName=="Microsoft Internet Explorer"?(S.prototype.am=Gc,se=30):ts&&navigator.appName!="Netscape"?(S.prototype.am=Hc,se=26):(S.prototype.am=es,se=28);S.prototype.DB=se;S.prototype.DM=(1<<se)-1;S.prototype.DV=1<<se;var Si=52;S.prototype.FV=Math.pow(2,Si);S.prototype.F1=Si-se;S.prototype.F2=2*se-Si;var Wc="0123456789abcdefghijklmnopqrstuvwxyz",En=new Array,Qe,Nt;Qe="0".charCodeAt(0);for(Nt=0;Nt<=9;++Nt)En[Qe++]=Nt;Qe="a".charCodeAt(0);for(Nt=10;Nt<36;++Nt)En[Qe++]=Nt;Qe="A".charCodeAt(0);for(Nt=10;Nt<36;++Nt)En[Qe++]=Nt;function rs(t){return Wc.charAt(t)}function ns(t,e){var r=En[t.charCodeAt(e)];return r??-1}function Zc(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function $c(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}function de(t){var e=H();return e.fromInt(t),e}function Yc(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var n=t.length,i=!1,a=0;--n>=0;){var o=r==8?t[n]&255:ns(t,n);if(o<0){t.charAt(n)=="-"&&(i=!0);continue}i=!1,a==0?this.data[this.t++]=o:a+r>this.DB?(this.data[this.t-1]|=(o&(1<<this.DB-a)-1)<<a,this.data[this.t++]=o>>this.DB-a):this.data[this.t-1]|=o<<a,a+=r,a>=this.DB&&(a-=this.DB)}r==8&&t[0]&128&&(this.s=-1,a>0&&(this.data[this.t-1]|=(1<<this.DB-a)-1<<a)),this.clamp(),i&&S.ZERO.subTo(this,this)}function Qc(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function Xc(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,n,i=!1,a="",o=this.t,s=this.DB-o*this.DB%e;if(o-- >0)for(s<this.DB&&(n=this.data[o]>>s)>0&&(i=!0,a=rs(n));o>=0;)s<e?(n=(this.data[o]&(1<<s)-1)<<e-s,n|=this.data[--o]>>(s+=this.DB-e)):(n=this.data[o]>>(s-=e)&r,s<=0&&(s+=this.DB,--o)),n>0&&(i=!0),i&&(a+=rs(n));return i?a:"0"}function Jc(){var t=H();return S.ZERO.subTo(this,t),t}function jc(){return this.s<0?this.negate():this}function tu(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}function Bn(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}function eu(){return this.t<=0?0:this.DB*(this.t-1)+Bn(this.data[this.t-1]^this.s&this.DM)}function ru(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function nu(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function iu(t,e){var r=t%this.DB,n=this.DB-r,i=(1<<n)-1,a=Math.floor(t/this.DB),o=this.s<<r&this.DM,s;for(s=this.t-1;s>=0;--s)e.data[s+a+1]=this.data[s]>>n|o,o=(this.data[s]&i)<<r;for(s=a-1;s>=0;--s)e.data[s]=0;e.data[a]=o,e.t=this.t+a+1,e.s=this.s,e.clamp()}function au(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var n=t%this.DB,i=this.DB-n,a=(1<<n)-1;e.data[0]=this.data[r]>>n;for(var o=r+1;o<this.t;++o)e.data[o-r-1]|=(this.data[o]&a)<<i,e.data[o-r]=this.data[o]>>n;n>0&&(e.data[this.t-r-1]|=(this.s&a)<<i),e.t=this.t-r,e.clamp()}function ou(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]-t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e.data[r++]=this.DV+n:n>0&&(e.data[r++]=n),e.t=r,e.clamp()}function su(t,e){var r=this.abs(),n=t.abs(),i=r.t;for(e.t=i+n.t;--i>=0;)e.data[i]=0;for(i=0;i<n.t;++i)e.data[i+r.t]=r.am(0,n.data[i],e,i,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&S.ZERO.subTo(e,e)}function fu(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function cu(t,e,r){var n=t.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){e?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=H());var a=H(),o=this.s,s=t.s,f=this.DB-Bn(n.data[n.t-1]);f>0?(n.lShiftTo(f,a),i.lShiftTo(f,r)):(n.copyTo(a),i.copyTo(r));var c=a.t,u=a.data[c-1];if(u!=0){var h=u*(1<<this.F1)+(c>1?a.data[c-2]>>this.F2:0),l=this.FV/h,d=(1<<this.F1)/h,p=1<<this.F2,g=r.t,m=g-c,v=e??H();for(a.dlShiftTo(m,v),r.compareTo(v)>=0&&(r.data[r.t++]=1,r.subTo(v,r)),S.ONE.dlShiftTo(c,v),v.subTo(a,a);a.t<c;)a.data[a.t++]=0;for(;--m>=0;){var w=r.data[--g]==u?this.DM:Math.floor(r.data[g]*l+(r.data[g-1]+p)*d);if((r.data[g]+=a.am(0,w,r,m,0,c))<w)for(a.dlShiftTo(m,v),r.subTo(v,r);r.data[g]<--w;)r.subTo(v,r)}e!=null&&(r.drShiftTo(c,e),o!=s&&S.ZERO.subTo(e,e)),r.t=c,r.clamp(),f>0&&r.rShiftTo(f,r),o<0&&S.ZERO.subTo(r,r)}}}function uu(t){var e=H();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(S.ZERO)>0&&t.subTo(e,e),e}function Pe(t){this.m=t}function hu(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function lu(t){return t}function pu(t){t.divRemTo(this.m,null,t)}function du(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function yu(t,e){t.squareTo(e),this.reduce(e)}Pe.prototype.convert=hu;Pe.prototype.revert=lu;Pe.prototype.reduce=pu;Pe.prototype.mulTo=du;Pe.prototype.sqrTo=yu;function gu(){if(this.t<1)return 0;var t=this.data[0];if(!(t&1))return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function ke(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function xu(t){var e=H();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(S.ZERO)>0&&this.m.subTo(e,e),e}function mu(t){var e=H();return t.copyTo(e),this.reduce(e),e}function vu(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,n=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,n,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function bu(t,e){t.squareTo(e),this.reduce(e)}function wu(t,e,r){t.multiplyTo(e,r),this.reduce(r)}ke.prototype.convert=xu;ke.prototype.revert=mu;ke.prototype.reduce=vu;ke.prototype.mulTo=wu;ke.prototype.sqrTo=bu;function Su(){return(this.t>0?this.data[0]&1:this.s)==0}function Eu(t,e){if(t>4294967295||t<1)return S.ONE;var r=H(),n=H(),i=e.convert(this),a=Bn(t)-1;for(i.copyTo(r);--a>=0;)if(e.sqrTo(r,n),(t&1<<a)>0)e.mulTo(n,i,r);else{var o=r;r=n,n=o}return e.revert(r)}function Bu(t,e){var r;return t<256||e.isEven()?r=new Pe(e):r=new ke(e),this.exp(t,r)}S.prototype.copyTo=Zc;S.prototype.fromInt=$c;S.prototype.fromString=Yc;S.prototype.clamp=Qc;S.prototype.dlShiftTo=ru;S.prototype.drShiftTo=nu;S.prototype.lShiftTo=iu;S.prototype.rShiftTo=au;S.prototype.subTo=ou;S.prototype.multiplyTo=su;S.prototype.squareTo=fu;S.prototype.divRemTo=cu;S.prototype.invDigit=gu;S.prototype.isEven=Su;S.prototype.exp=Eu;S.prototype.toString=Xc;S.prototype.negate=Jc;S.prototype.abs=jc;S.prototype.compareTo=tu;S.prototype.bitLength=eu;S.prototype.mod=uu;S.prototype.modPowInt=Bu;S.ZERO=de(0);S.ONE=de(1);function Au(){var t=H();return this.copyTo(t),t}function Cu(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function Iu(){return this.t==0?this.s:this.data[0]<<24>>24}function Tu(){return this.t==0?this.s:this.data[0]<<16>>16}function _u(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function Ru(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function Du(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=de(r),i=H(),a=H(),o="";for(this.divRemTo(n,i,a);i.signum()>0;)o=(r+a.intValue()).toString(t).substr(1)+o,i.divRemTo(n,i,a);return a.intValue().toString(t)+o}function Pu(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),n=Math.pow(e,r),i=!1,a=0,o=0,s=0;s<t.length;++s){var f=ns(t,s);if(f<0){t.charAt(s)=="-"&&this.signum()==0&&(i=!0);continue}o=e*o+f,++a>=r&&(this.dMultiply(n),this.dAddOffset(o,0),a=0,o=0)}a>0&&(this.dMultiply(Math.pow(e,a)),this.dAddOffset(o,0)),i&&S.ZERO.subTo(this,this)}function ku(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(S.ONE.shiftLeft(t-1),Ei,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(S.ONE.shiftLeft(t-1),this);else{var n=new Array,i=t&7;n.length=(t>>3)+1,e.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function Nu(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,n,i=0;if(t-- >0)for(r<this.DB&&(n=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[i++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this.data[t]&(1<<r)-1)<<8-r,n|=this.data[--t]>>(r+=this.DB-8)):(n=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),n&128&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(e[i++]=n);return e}function Lu(t){return this.compareTo(t)==0}function Uu(t){return this.compareTo(t)<0?this:t}function Ku(t){return this.compareTo(t)>0?this:t}function Fu(t,e,r){var n,i,a=Math.min(t.t,this.t);for(n=0;n<a;++n)r.data[n]=e(this.data[n],t.data[n]);if(t.t<this.t){for(i=t.s&this.DM,n=a;n<this.t;++n)r.data[n]=e(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=a;n<t.t;++n)r.data[n]=e(i,t.data[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function Ou(t,e){return t&e}function Mu(t){var e=H();return this.bitwiseTo(t,Ou,e),e}function Ei(t,e){return t|e}function Vu(t){var e=H();return this.bitwiseTo(t,Ei,e),e}function is(t,e){return t^e}function qu(t){var e=H();return this.bitwiseTo(t,is,e),e}function as(t,e){return t&~e}function zu(t){var e=H();return this.bitwiseTo(t,as,e),e}function Hu(){for(var t=H(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function Gu(t){var e=H();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function Wu(t){var e=H();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function Zu(t){if(t==0)return-1;var e=0;return t&65535||(t>>=16,e+=16),t&255||(t>>=8,e+=8),t&15||(t>>=4,e+=4),t&3||(t>>=2,e+=2),t&1||++e,e}function $u(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+Zu(this.data[t]);return this.s<0?this.t*this.DB:-1}function Yu(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function Qu(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=Yu(this.data[r]^e);return t}function Xu(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}function Ju(t,e){var r=S.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function ju(t){return this.changeBit(t,Ei)}function th(t){return this.changeBit(t,as)}function eh(t){return this.changeBit(t,is)}function rh(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]+t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e.data[r++]=n:n<-1&&(e.data[r++]=this.DV+n),e.t=r,e.clamp()}function nh(t){var e=H();return this.addTo(t,e),e}function ih(t){var e=H();return this.subTo(t,e),e}function ah(t){var e=H();return this.multiplyTo(t,e),e}function oh(t){var e=H();return this.divRemTo(t,e,null),e}function sh(t){var e=H();return this.divRemTo(t,null,e),e}function fh(t){var e=H(),r=H();return this.divRemTo(t,e,r),new Array(e,r)}function ch(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function uh(t,e){if(t!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function Nr(){}function os(t){return t}function hh(t,e,r){t.multiplyTo(e,r)}function lh(t,e){t.squareTo(e)}Nr.prototype.convert=os;Nr.prototype.revert=os;Nr.prototype.mulTo=hh;Nr.prototype.sqrTo=lh;function ph(t){return this.exp(t,new Nr)}function dh(t,e,r){var n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,t.data[n],r,n,0,this.t);for(i=Math.min(t.t,e);n<i;++n)this.am(0,t.data[n],r,n,0,e-n);r.clamp()}function yh(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r.data[this.t+n-e]=this.am(e-n,t.data[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}function Xe(t){this.r2=H(),this.q3=H(),S.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function gh(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=H();return t.copyTo(e),this.reduce(e),e}function xh(t){return t}function mh(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function vh(t,e){t.squareTo(e),this.reduce(e)}function bh(t,e,r){t.multiplyTo(e,r),this.reduce(r)}Xe.prototype.convert=gh;Xe.prototype.revert=xh;Xe.prototype.reduce=mh;Xe.prototype.mulTo=bh;Xe.prototype.sqrTo=vh;function wh(t,e){var r=t.bitLength(),n,i=de(1),a;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?a=new Pe(e):e.isEven()?a=new Xe(e):a=new ke(e);var o=new Array,s=3,f=n-1,c=(1<<n)-1;if(o[1]=a.convert(this),n>1){var u=H();for(a.sqrTo(o[1],u);s<=c;)o[s]=H(),a.mulTo(u,o[s-2],o[s]),s+=2}var h=t.t-1,l,d=!0,p=H(),g;for(r=Bn(t.data[h])-1;h>=0;){for(r>=f?l=t.data[h]>>r-f&c:(l=(t.data[h]&(1<<r+1)-1)<<f-r,h>0&&(l|=t.data[h-1]>>this.DB+r-f)),s=n;!(l&1);)l>>=1,--s;if((r-=s)<0&&(r+=this.DB,--h),d)o[l].copyTo(i),d=!1;else{for(;s>1;)a.sqrTo(i,p),a.sqrTo(p,i),s-=2;s>0?a.sqrTo(i,p):(g=i,i=p,p=g),a.mulTo(p,o[l],i)}for(;h>=0&&!(t.data[h]&1<<r);)a.sqrTo(i,p),g=i,i=p,p=g,--r<0&&(r=this.DB-1,--h)}return a.revert(i)}function Sh(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var i=e.getLowestSetBit(),a=r.getLowestSetBit();if(a<0)return e;for(i<a&&(a=i),a>0&&(e.rShiftTo(a,e),r.rShiftTo(a,r));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return a>0&&r.lShiftTo(a,r),r}function Eh(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this.data[n])%t;return r}function Bh(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return S.ZERO;for(var r=t.clone(),n=this.clone(),i=de(1),a=de(0),o=de(0),s=de(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!i.isEven()||!a.isEven())&&(i.addTo(this,i),a.subTo(t,a)),i.rShiftTo(1,i)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);for(;n.isEven();)n.rShiftTo(1,n),e?((!o.isEven()||!s.isEven())&&(o.addTo(this,o),s.subTo(t,s)),o.rShiftTo(1,o)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);r.compareTo(n)>=0?(r.subTo(n,r),e&&i.subTo(o,i),a.subTo(s,a)):(n.subTo(r,n),e&&o.subTo(i,o),s.subTo(a,s))}if(n.compareTo(S.ONE)!=0)return S.ZERO;if(s.compareTo(t)>=0)return s.subtract(t);if(s.signum()<0)s.addTo(t,s);else return s;return s.signum()<0?s.add(t):s}var Mt=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],Ah=(1<<26)/Mt[Mt.length-1];function Ch(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=Mt[Mt.length-1]){for(e=0;e<Mt.length;++e)if(r.data[0]==Mt[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<Mt.length;){for(var n=Mt[e],i=e+1;i<Mt.length&&n<Ah;)n*=Mt[i++];for(n=r.modInt(n);e<i;)if(n%Mt[e++]==0)return!1}return r.millerRabin(t)}function Ih(t){var e=this.subtract(S.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var n=e.shiftRight(r),i=Th(),a,o=0;o<t;++o){do a=new S(this.bitLength(),i);while(a.compareTo(S.ONE)<=0||a.compareTo(e)>=0);var s=a.modPow(n,this);if(s.compareTo(S.ONE)!=0&&s.compareTo(e)!=0){for(var f=1;f++<r&&s.compareTo(e)!=0;)if(s=s.modPowInt(2,this),s.compareTo(S.ONE)==0)return!1;if(s.compareTo(e)!=0)return!1}}return!0}function Th(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)}}}S.prototype.chunkSize=_u;S.prototype.toRadix=Du;S.prototype.fromRadix=Pu;S.prototype.fromNumber=ku;S.prototype.bitwiseTo=Fu;S.prototype.changeBit=Ju;S.prototype.addTo=rh;S.prototype.dMultiply=ch;S.prototype.dAddOffset=uh;S.prototype.multiplyLowerTo=dh;S.prototype.multiplyUpperTo=yh;S.prototype.modInt=Eh;S.prototype.millerRabin=Ih;S.prototype.clone=Au;S.prototype.intValue=Cu;S.prototype.byteValue=Iu;S.prototype.shortValue=Tu;S.prototype.signum=Ru;S.prototype.toByteArray=Nu;S.prototype.equals=Lu;S.prototype.min=Uu;S.prototype.max=Ku;S.prototype.and=Mu;S.prototype.or=Vu;S.prototype.xor=qu;S.prototype.andNot=zu;S.prototype.not=Hu;S.prototype.shiftLeft=Gu;S.prototype.shiftRight=Wu;S.prototype.getLowestSetBit=$u;S.prototype.bitCount=Qu;S.prototype.testBit=Xu;S.prototype.setBit=ju;S.prototype.clearBit=th;S.prototype.flipBit=eh;S.prototype.add=nh;S.prototype.subtract=ih;S.prototype.multiply=ah;S.prototype.divide=oh;S.prototype.remainder=sh;S.prototype.divideAndRemainder=fh;S.prototype.modPow=wh;S.prototype.modInverse=Bh;S.prototype.pow=ph;S.prototype.gcd=Sh;S.prototype.isProbablePrime=Ch});var ls=O((Hy,hs)=>{var Yt=$();De();lt();var cs=hs.exports=Yt.sha1=Yt.sha1||{};Yt.md.sha1=Yt.md.algorithms.sha1=cs;cs.create=function(){us||_h();var t=null,e=Yt.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,a=0;a<i;++a)n.fullMessageLength.push(0);return e=Yt.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,a){a==="utf8"&&(i=Yt.util.encodeUtf8(i));var o=i.length;n.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var s=n.fullMessageLength.length-1;s>=0;--s)n.fullMessageLength[s]+=o[1],o[1]=o[0]+(n.fullMessageLength[s]/4294967296>>>0),n.fullMessageLength[s]=n.fullMessageLength[s]>>>0,o[0]=o[1]/4294967296>>>0;return e.putBytes(i),fs(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=Yt.util.createBuffer();i.putBytes(e.bytes());var a=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,o=a&n.blockLength-1;i.putBytes(Bi.substr(0,n.blockLength-o));for(var s,f,c=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)s=n.fullMessageLength[u+1]*8,f=s/4294967296>>>0,c+=f,i.putInt32(c>>>0),c=s>>>0;i.putInt32(c);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};fs(h,r,i);var l=Yt.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l},n};var Bi=null,us=!1;function _h(){Bi=String.fromCharCode(128),Bi+=Yt.util.fillString(String.fromCharCode(0),64),us=!0}function fs(t,e,r){for(var n,i,a,o,s,f,c,u,h=r.length();h>=64;){for(i=t.h0,a=t.h1,o=t.h2,s=t.h3,f=t.h4,u=0;u<16;++u)n=r.getInt32(),e[u]=n,c=s^a&(o^s),n=(i<<5|i>>>27)+c+f+1518500249+n,f=s,s=o,o=(a<<30|a>>>2)>>>0,a=i,i=n;for(;u<20;++u)n=e[u-3]^e[u-8]^e[u-14]^e[u-16],n=n<<1|n>>>31,e[u]=n,c=s^a&(o^s),n=(i<<5|i>>>27)+c+f+1518500249+n,f=s,s=o,o=(a<<30|a>>>2)>>>0,a=i,i=n;for(;u<32;++u)n=e[u-3]^e[u-8]^e[u-14]^e[u-16],n=n<<1|n>>>31,e[u]=n,c=a^o^s,n=(i<<5|i>>>27)+c+f+1859775393+n,f=s,s=o,o=(a<<30|a>>>2)>>>0,a=i,i=n;for(;u<40;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,c=a^o^s,n=(i<<5|i>>>27)+c+f+1859775393+n,f=s,s=o,o=(a<<30|a>>>2)>>>0,a=i,i=n;for(;u<60;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,c=a&o|s&(a^o),n=(i<<5|i>>>27)+c+f+2400959708+n,f=s,s=o,o=(a<<30|a>>>2)>>>0,a=i,i=n;for(;u<80;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,c=a^o^s,n=(i<<5|i>>>27)+c+f+3395469782+n,f=s,s=o,o=(a<<30|a>>>2)>>>0,a=i,i=n;t.h0=t.h0+i|0,t.h1=t.h1+a|0,t.h2=t.h2+o|0,t.h3=t.h3+s|0,t.h4=t.h4+f|0,h-=64}}});var ys=O((Gy,ds)=>{var Qt=$();lt();kr();ls();var ps=ds.exports=Qt.pkcs1=Qt.pkcs1||{};ps.encode_rsa_oaep=function(t,e,r){var n,i,a,o;typeof r=="string"?(n=r,i=arguments[3]||void 0,a=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,a=r.md||void 0,r.mgf1&&r.mgf1.md&&(o=r.mgf1.md)),a?a.start():a=Qt.md.sha1.create(),o||(o=a);var s=Math.ceil(t.n.bitLength()/8),f=s-2*a.digestLength-2;if(e.length>f){var c=new Error("RSAES-OAEP input message length is too long.");throw c.length=e.length,c.maxLength=f,c}n||(n=""),a.update(n,"raw");for(var u=a.digest(),h="",l=f-e.length,d=0;d<l;d++)h+="\0";var p=u.getBytes()+h+""+e;if(!i)i=Qt.random.getBytes(a.digestLength);else if(i.length!==a.digestLength){var c=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw c.seedLength=i.length,c.digestLength=a.digestLength,c}var g=Cn(i,s-a.digestLength-1,o),m=Qt.util.xorBytes(p,g,p.length),v=Cn(m,a.digestLength,o),w=Qt.util.xorBytes(i,v,i.length);return"\0"+w+m};ps.decode_rsa_oaep=function(t,e,r){var n,i,a;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(a=r.mgf1.md));var o=Math.ceil(t.n.bitLength()/8);if(e.length!==o){var m=new Error("RSAES-OAEP encoded message length is invalid.");throw m.length=e.length,m.expectedLength=o,m}if(i===void 0?i=Qt.md.sha1.create():i.start(),a||(a=i),o<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var s=i.digest().getBytes(),f=e.charAt(0),c=e.substring(1,i.digestLength+1),u=e.substring(1+i.digestLength),h=Cn(u,i.digestLength,a),l=Qt.util.xorBytes(c,h,c.length),d=Cn(l,o-i.digestLength-1,a),p=Qt.util.xorBytes(u,d,u.length),g=p.substring(0,i.digestLength),m=f!=="\0",v=0;v<i.digestLength;++v)m|=s.charAt(v)!==g.charAt(v);for(var w=1,B=i.digestLength,D=i.digestLength;D<p.length;D++){var C=p.charCodeAt(D),I=C&1^1,L=w?65534:0;m|=C&L,w=w&I,B+=w}if(m||p.charCodeAt(B)!==1)throw new Error("Invalid RSAES-OAEP padding.");return p.substring(B+1)};function Cn(t,e,r){r||(r=Qt.md.sha1.create());for(var n="",i=Math.ceil(e/r.digestLength),a=0;a<i;++a){var o=String.fromCharCode(a>>24&255,a>>16&255,a>>8&255,a&255);r.start(),r.update(t+o),n+=r.digest().getBytes()}return n.substring(0,e)}});var gs=O((Wy,Ai)=>{var ye=$();lt();An();kr();(function(){if(ye.prime){Ai.exports=ye.prime;return}var t=Ai.exports=ye.prime=ye.prime||{},e=ye.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new e(null);n.fromInt(30);var i=function(h,l){return h|l};t.generateProbablePrime=function(h,l,d){typeof l=="function"&&(d=l,l={}),l=l||{};var p=l.algorithm||"PRIMEINC";typeof p=="string"&&(p={name:p}),p.options=p.options||{};var g=l.prng||ye.random,m={nextBytes:function(v){for(var w=g.getBytesSync(v.length),B=0;B<v.length;++B)v[B]=w.charCodeAt(B)}};if(p.name==="PRIMEINC")return a(h,m,p.options,d);throw new Error("Invalid prime generation algorithm: "+p.name)};function a(h,l,d,p){return"workers"in d?f(h,l,d,p):o(h,l,d,p)}function o(h,l,d,p){var g=c(h,l),m=0,v=u(g.bitLength());"millerRabinTests"in d&&(v=d.millerRabinTests);var w=10;"maxBlockTime"in d&&(w=d.maxBlockTime),s(g,h,l,m,v,w,p)}function s(h,l,d,p,g,m,v){var w=+new Date;do{if(h.bitLength()>l&&(h=c(l,d)),h.isProbablePrime(g))return v(null,h);h.dAddOffset(r[p++%8],0)}while(m<0||+new Date-w<m);ye.util.setImmediate(function(){s(h,l,d,p,g,m,v)})}function f(h,l,d,p){if(typeof Worker>"u")return o(h,l,d,p);var g=c(h,l),m=d.workers,v=d.workLoad||100,w=v*30/8,B=d.workerScript||"forge/prime.worker.js";if(m===-1)return ye.util.estimateCores(function(C,I){C&&(I=2),m=I-1,D()});D();function D(){m=Math.max(1,m);for(var C=[],I=0;I<m;++I)C[I]=new Worker(B);for(var L=m,I=0;I<m;++I)C[I].addEventListener("message",it);var K=!1;function it(Ft){if(!K){--L;var _t=Ft.data;if(_t.found){for(var wt=0;wt<C.length;++wt)C[wt].terminate();return K=!0,p(null,new e(_t.prime,16))}g.bitLength()>h&&(g=c(h,l));var We=g.toString(16);Ft.target.postMessage({hex:We,workLoad:v}),g.dAddOffset(w,0)}}}}function c(h,l){var d=new e(h,l),p=h-1;return d.testBit(p)||d.bitwiseTo(e.ONE.shiftLeft(p),i,d),d.dAddOffset(31-d.mod(n).byteValue(),0),d}function u(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}})()});var Tn=O((Zy,Es)=>{var k=$();Pr();An();pn();ys();gs();kr();lt();typeof V>"u"&&(V=k.jsbn.BigInteger);var V,Ci=k.util.isNodejs?Ye():null,x=k.asn1,Lt=k.util;k.pki=k.pki||{};Es.exports=k.pki.rsa=k.rsa=k.rsa||{};var U=k.pki,Rh=[6,4,2,4,2,4,6,2],Dh={name:"PrivateKeyInfo",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:x.Class.UNIVERSAL,type:x.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:x.Class.UNIVERSAL,type:x.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},Ph={name:"RSAPrivateKey",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},kh={name:"RSAPublicKey",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},Nh=k.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:x.Class.UNIVERSAL,type:x.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:x.Class.UNIVERSAL,type:x.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},Lh={name:"DigestInfo",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:x.Class.UNIVERSAL,type:x.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:x.Class.UNIVERSAL,type:x.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:x.Class.UNIVERSAL,type:x.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},Uh=function(t){var e;if(t.algorithm in U.oids)e=U.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var n=x.oidToDer(e).getBytes(),i=x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[]),a=x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[]);a.value.push(x.create(x.Class.UNIVERSAL,x.Type.OID,!1,n)),a.value.push(x.create(x.Class.UNIVERSAL,x.Type.NULL,!1,""));var o=x.create(x.Class.UNIVERSAL,x.Type.OCTETSTRING,!1,t.digest().getBytes());return i.value.push(a),i.value.push(o),x.toDer(i).getBytes()},ws=function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(V.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(V.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var n;do n=new V(k.util.bytesToHex(k.random.getBytes(e.n.bitLength()/8)),16);while(n.compareTo(e.n)>=0||!n.gcd(e.n).equals(V.ONE));t=t.multiply(n.modPow(e.e,e.n)).mod(e.n);for(var i=t.mod(e.p).modPow(e.dP,e.p),a=t.mod(e.q).modPow(e.dQ,e.q);i.compareTo(a)<0;)i=i.add(e.p);var o=i.subtract(a).multiply(e.qInv).mod(e.p).multiply(e.q).add(a);return o=o.multiply(n.modInverse(e.n)).mod(e.n),o};U.rsa.encrypt=function(t,e,r){var n=r,i,a=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=Ss(t,e,r)):(i=k.util.createBuffer(),i.putBytes(t));for(var o=new V(i.toHex(),16),s=ws(o,e,n),f=s.toString(16),c=k.util.createBuffer(),u=a-Math.ceil(f.length/2);u>0;)c.putByte(0),--u;return c.putBytes(k.util.hexToBytes(f)),c.getBytes()};U.rsa.decrypt=function(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8);if(t.length!==i){var a=new Error("Encrypted message length is invalid.");throw a.length=t.length,a.expected=i,a}var o=new V(k.util.createBuffer(t).toHex(),16);if(o.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var s=ws(o,e,r),f=s.toString(16),c=k.util.createBuffer(),u=i-Math.ceil(f.length/2);u>0;)c.putByte(0),--u;return c.putBytes(k.util.hexToBytes(f)),n!==!1?In(c.getBytes(),e,r):c.getBytes()};U.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var n=r.prng||k.random,i={nextBytes:function(s){for(var f=n.getBytesSync(s.length),c=0;c<s.length;++c)s[c]=f.charCodeAt(c)}},a=r.algorithm||"PRIMEINC",o;if(a==="PRIMEINC")o={algorithm:a,state:0,bits:t,rng:i,eInt:e||65537,e:new V(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},o.e.fromInt(o.eInt);else throw new Error("Invalid key generation algorithm: "+a);return o};U.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new V(null);r.fromInt(30);for(var n=0,i=function(h,l){return h|l},a=+new Date,o,s=0;t.keys===null&&(e<=0||s<e);){if(t.state===0){var f=t.p===null?t.pBits:t.qBits,c=f-1;t.pqState===0?(t.num=new V(f,t.rng),t.num.testBit(c)||t.num.bitwiseTo(V.ONE.shiftLeft(c),i,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),n=0,++t.pqState):t.pqState===1?t.num.bitLength()>f?t.pqState=0:t.num.isProbablePrime(Fh(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(Rh[n++%8],0):t.pqState===2?t.pqState=t.num.subtract(V.ONE).gcd(t.e).compareTo(V.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(V.ONE),t.q1=t.q.subtract(V.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(V.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var u=t.e.modInverse(t.phi);t.keys={privateKey:U.rsa.setPrivateKey(t.n,t.e,u,t.p,t.q,u.mod(t.p1),u.mod(t.q1),t.q.modInverse(t.p)),publicKey:U.rsa.setPublicKey(t.n,t.e)}}o=+new Date,s+=o-a,a=o}return t.keys!==null};U.rsa.generateKeyPair=function(t,e,r,n){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(n=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(n=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,n=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!k.options.usePureJavaScript&&!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(n){if(xs("generateKeyPair"))return Ci.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(s,f,c){if(s)return n(s);n(null,{privateKey:U.privateKeyFromPem(c),publicKey:U.publicKeyFromPem(f)})});if(ms("generateKey")&&ms("exportKey"))return Lt.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:bs(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(s){return Lt.globalScope.crypto.subtle.exportKey("pkcs8",s.privateKey)}).then(void 0,function(s){n(s)}).then(function(s){if(s){var f=U.privateKeyFromAsn1(x.fromDer(k.util.createBuffer(s)));n(null,{privateKey:f,publicKey:U.setRsaPublicKey(f.n,f.e)})}});if(vs("generateKey")&&vs("exportKey")){var i=Lt.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:bs(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(s){var f=s.target.result,c=Lt.globalScope.msCrypto.subtle.exportKey("pkcs8",f.privateKey);c.oncomplete=function(u){var h=u.target.result,l=U.privateKeyFromAsn1(x.fromDer(k.util.createBuffer(h)));n(null,{privateKey:l,publicKey:U.setRsaPublicKey(l.n,l.e)})},c.onerror=function(u){n(u)}},i.onerror=function(s){n(s)};return}}else if(xs("generateKeyPairSync")){var a=Ci.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:U.privateKeyFromPem(a.privateKey),publicKey:U.publicKeyFromPem(a.publicKey)}}}var o=U.rsa.createKeyPairGenerationState(t,e,r);if(!n)return U.rsa.stepKeyPairGenerationState(o,0),o.keys;Kh(o,r,n)};U.setRsaPublicKey=U.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(n,i,a){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(s,f,c){return Ss(s,f,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(s,f){return k.pkcs1.encode_rsa_oaep(f,s,a)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(s){return s}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var o=i.encode(n,r,!0);return U.rsa.encrypt(o,r,!0)},r.verify=function(n,i,a,o){typeof a=="string"?a=a.toUpperCase():a===void 0&&(a="RSASSA-PKCS1-V1_5"),o===void 0&&(o={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in o||(o._parseAllDigestBytes=!0),a==="RSASSA-PKCS1-V1_5"?a={verify:function(f,c){c=In(c,r,!0);var u=x.fromDer(c,{parseAllBytes:o._parseAllDigestBytes}),h={},l=[];if(!x.validate(u,Lh,h,l)){var d=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw d.errors=l,d}var p=x.derToOid(h.algorithmIdentifier);if(!(p===k.oids.md2||p===k.oids.md5||p===k.oids.sha1||p===k.oids.sha224||p===k.oids.sha256||p===k.oids.sha384||p===k.oids.sha512||p===k.oids["sha512-224"]||p===k.oids["sha512-256"])){var d=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw d.oid=p,d}if((p===k.oids.md2||p===k.oids.md5)&&!("parameters"in h))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return f===h.digest}}:(a==="NONE"||a==="NULL"||a===null)&&(a={verify:function(f,c){return c=In(c,r,!0),f===c}});var s=U.rsa.decrypt(i,r,!0,!1);return a.verify(n,s,r.n.bitLength())},r};U.setRsaPrivateKey=U.rsa.setPrivateKey=function(t,e,r,n,i,a,o,s){var f={n:t,e,d:r,p:n,q:i,dP:a,dQ:o,qInv:s};return f.decrypt=function(c,u,h){typeof u=="string"?u=u.toUpperCase():u===void 0&&(u="RSAES-PKCS1-V1_5");var l=U.rsa.decrypt(c,f,!1,!1);if(u==="RSAES-PKCS1-V1_5")u={decode:In};else if(u==="RSA-OAEP"||u==="RSAES-OAEP")u={decode:function(d,p){return k.pkcs1.decode_rsa_oaep(p,d,h)}};else if(["RAW","NONE","NULL",null].indexOf(u)!==-1)u={decode:function(d){return d}};else throw new Error('Unsupported encryption scheme: "'+u+'".');return u.decode(l,f,!1)},f.sign=function(c,u){var h=!1;typeof u=="string"&&(u=u.toUpperCase()),u===void 0||u==="RSASSA-PKCS1-V1_5"?(u={encode:Uh},h=1):(u==="NONE"||u==="NULL"||u===null)&&(u={encode:function(){return c}},h=1);var l=u.encode(c,f.n.bitLength());return U.rsa.encrypt(l,f,h)},f};U.wrapRsaPrivateKey=function(t){return x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,x.integerToDer(0).getBytes()),x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.OID,!1,x.oidToDer(U.oids.rsaEncryption).getBytes()),x.create(x.Class.UNIVERSAL,x.Type.NULL,!1,"")]),x.create(x.Class.UNIVERSAL,x.Type.OCTETSTRING,!1,x.toDer(t).getBytes())])};U.privateKeyFromAsn1=function(t){var e={},r=[];if(x.validate(t,Dh,e,r)&&(t=x.fromDer(k.util.createBuffer(e.privateKey))),e={},r=[],!x.validate(t,Ph,e,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,a,o,s,f,c,u,h;return i=k.util.createBuffer(e.privateKeyModulus).toHex(),a=k.util.createBuffer(e.privateKeyPublicExponent).toHex(),o=k.util.createBuffer(e.privateKeyPrivateExponent).toHex(),s=k.util.createBuffer(e.privateKeyPrime1).toHex(),f=k.util.createBuffer(e.privateKeyPrime2).toHex(),c=k.util.createBuffer(e.privateKeyExponent1).toHex(),u=k.util.createBuffer(e.privateKeyExponent2).toHex(),h=k.util.createBuffer(e.privateKeyCoefficient).toHex(),U.setRsaPrivateKey(new V(i,16),new V(a,16),new V(o,16),new V(s,16),new V(f,16),new V(c,16),new V(u,16),new V(h,16))};U.privateKeyToAsn1=U.privateKeyToRSAPrivateKey=function(t){return x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,x.integerToDer(0).getBytes()),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,Xt(t.n)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,Xt(t.e)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,Xt(t.d)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,Xt(t.p)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,Xt(t.q)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,Xt(t.dP)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,Xt(t.dQ)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,Xt(t.qInv))])};U.publicKeyFromAsn1=function(t){var e={},r=[];if(x.validate(t,Nh,e,r)){var n=x.derToOid(e.publicKeyOid);if(n!==U.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}t=e.rsaPublicKey}if(r=[],!x.validate(t,kh,e,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var a=k.util.createBuffer(e.publicKeyModulus).toHex(),o=k.util.createBuffer(e.publicKeyExponent).toHex();return U.setRsaPublicKey(new V(a,16),new V(o,16))};U.publicKeyToAsn1=U.publicKeyToSubjectPublicKeyInfo=function(t){return x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.OID,!1,x.oidToDer(U.oids.rsaEncryption).getBytes()),x.create(x.Class.UNIVERSAL,x.Type.NULL,!1,"")]),x.create(x.Class.UNIVERSAL,x.Type.BITSTRING,!1,[U.publicKeyToRSAPublicKey(t)])])};U.publicKeyToRSAPublicKey=function(t){return x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,Xt(t.n)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,Xt(t.e))])};function Ss(t,e,r){var n=k.util.createBuffer(),i=Math.ceil(e.n.bitLength()/8);if(t.length>i-11){var a=new Error("Message is too long for PKCS#1 v1.5 padding.");throw a.length=t.length,a.max=i-11,a}n.putByte(0),n.putByte(r);var o=i-3-t.length,s;if(r===0||r===1){s=r===0?0:255;for(var f=0;f<o;++f)n.putByte(s)}else for(;o>0;){for(var c=0,u=k.random.getBytes(o),f=0;f<o;++f)s=u.charCodeAt(f),s===0?++c:n.putByte(s);o=c}return n.putByte(0),n.putBytes(t),n}function In(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8),a=k.util.createBuffer(t),o=a.getByte(),s=a.getByte();if(o!==0||r&&s!==0&&s!==1||!r&&s!=2||r&&s===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var f=0;if(s===0){f=i-3-n;for(var c=0;c<f;++c)if(a.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(s===1)for(f=0;a.length()>1;){if(a.getByte()!==255){--a.read;break}++f}else if(s===2)for(f=0;a.length()>1;){if(a.getByte()===0){--a.read;break}++f}var u=a.getByte();if(u!==0||f!==i-3-a.length())throw new Error("Encryption block is invalid.");return a.getBytes()}function Kh(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var n={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(n.prng=e.prng),i();function i(){a(t.pBits,function(s,f){if(s)return r(s);if(t.p=f,t.q!==null)return o(s,t.q);a(t.qBits,o)})}function a(s,f){k.prime.generateProbablePrime(s,n,f)}function o(s,f){if(s)return r(s);if(t.q=f,t.p.compareTo(t.q)<0){var c=t.p;t.p=t.q,t.q=c}if(t.p.subtract(V.ONE).gcd(t.e).compareTo(V.ONE)!==0){t.p=null,i();return}if(t.q.subtract(V.ONE).gcd(t.e).compareTo(V.ONE)!==0){t.q=null,a(t.qBits,o);return}if(t.p1=t.p.subtract(V.ONE),t.q1=t.q.subtract(V.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(V.ONE)!==0){t.p=t.q=null,i();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,a(t.qBits,o);return}var u=t.e.modInverse(t.phi);t.keys={privateKey:U.rsa.setPrivateKey(t.n,t.e,u,t.p,t.q,u.mod(t.p1),u.mod(t.q1),t.q.modInverse(t.p)),publicKey:U.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}}function Xt(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=k.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&!(r.charCodeAt(1)&128)||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}function Fh(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}function xs(t){return k.util.isNodejs&&typeof Ci[t]=="function"}function ms(t){return typeof Lt.globalScope<"u"&&typeof Lt.globalScope.crypto=="object"&&typeof Lt.globalScope.crypto.subtle=="object"&&typeof Lt.globalScope.crypto.subtle[t]=="function"}function vs(t){return typeof Lt.globalScope<"u"&&typeof Lt.globalScope.msCrypto=="object"&&typeof Lt.globalScope.msCrypto.subtle=="object"&&typeof Lt.globalScope.msCrypto.subtle[t]=="function"}function bs(t){for(var e=k.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),n=0;n<e.length;++n)r[n]=e.charCodeAt(n);return r}});var _s=O(($y,Ts)=>{var _=$();xi();Pr();ko();De();pn();Fo();Vo();kr();jo();Tn();lt();typeof Bs>"u"&&(Bs=_.jsbn.BigInteger);var Bs,b=_.asn1,F=_.pki=_.pki||{};Ts.exports=F.pbe=_.pbe=_.pbe||{};var Ne=F.oids,Oh={name:"EncryptedPrivateKeyInfo",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},Mh={name:"PBES2Algorithms",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},Vh={name:"pkcs-12PbeParams",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"iterations"}]};F.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=_.random.getBytesSync(r.saltSize),i=r.count,a=b.integerToDer(i),o,s,f;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var c,u,h;switch(r.algorithm){case"aes128":o=16,c=16,u=Ne["aes128-CBC"],h=_.aes.createEncryptionCipher;break;case"aes192":o=24,c=16,u=Ne["aes192-CBC"],h=_.aes.createEncryptionCipher;break;case"aes256":o=32,c=16,u=Ne["aes256-CBC"],h=_.aes.createEncryptionCipher;break;case"des":o=8,c=8,u=Ne.desCBC,h=_.des.createEncryptionCipher;break;default:var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var d="hmacWith"+r.prfAlgorithm.toUpperCase(),p=Is(d),g=_.pkcs5.pbkdf2(e,n,i,o,p),m=_.random.getBytesSync(c),v=h(g);v.start(m),v.update(b.toDer(t)),v.finish(),f=v.output.getBytes();var w=qh(n,a,o,d);s=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(Ne.pkcs5PBES2).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(Ne.pkcs5PBKDF2).getBytes()),w]),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(u).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,m)])])])}else if(r.algorithm==="3des"){o=24;var B=new _.util.ByteBuffer(n),g=F.pbe.generatePkcs12Key(e,B,1,i,o),m=F.pbe.generatePkcs12Key(e,B,2,i,o),v=_.des.createEncryptionCipher(g);v.start(m),v.update(b.toDer(t)),v.finish(),f=v.output.getBytes(),s=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(Ne["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,n),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,a.getBytes())])])}else{var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var D=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[s,b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,f)]);return D};F.decryptPrivateKeyInfo=function(t,e){var r=null,n={},i=[];if(!b.validate(t,Oh,n,i)){var a=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=i,a}var o=b.derToOid(n.encryptionOid),s=F.pbe.getCipher(o,n.encryptionParams,e),f=_.util.createBuffer(n.encryptedData);return s.update(f),s.finish()&&(r=b.fromDer(s.output)),r};F.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:b.toDer(t).getBytes()};return _.pem.encode(r,{maxline:e})};F.encryptedPrivateKeyFromPem=function(t){var e=_.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return b.fromDer(e.body)};F.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var n=F.wrapRsaPrivateKey(F.privateKeyToAsn1(t));return n=F.encryptPrivateKeyInfo(n,e,r),F.encryptedPrivateKeyToPem(n)}var i,a,o,s;switch(r.algorithm){case"aes128":i="AES-128-CBC",o=16,a=_.random.getBytesSync(16),s=_.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",o=24,a=_.random.getBytesSync(16),s=_.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",o=32,a=_.random.getBytesSync(16),s=_.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",o=24,a=_.random.getBytesSync(8),s=_.des.createEncryptionCipher;break;case"des":i="DES-CBC",o=8,a=_.random.getBytesSync(8),s=_.des.createEncryptionCipher;break;default:var f=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw f.algorithm=r.algorithm,f}var c=_.pbe.opensslDeriveBytes(e,a.substr(0,8),o),u=s(c);u.start(a),u.update(b.toDer(F.privateKeyToAsn1(t))),u.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:_.util.bytesToHex(a).toUpperCase()},body:u.output.getBytes()};return _.pem.encode(h)};F.decryptRsaPrivateKey=function(t,e){var r=null,n=_.pem.decode(t)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var a,o;switch(n.dekInfo.algorithm){case"DES-CBC":a=8,o=_.des.createDecryptionCipher;break;case"DES-EDE3-CBC":a=24,o=_.des.createDecryptionCipher;break;case"AES-128-CBC":a=16,o=_.aes.createDecryptionCipher;break;case"AES-192-CBC":a=24,o=_.aes.createDecryptionCipher;break;case"AES-256-CBC":a=32,o=_.aes.createDecryptionCipher;break;case"RC2-40-CBC":a=5,o=function(h){return _.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":a=8,o=function(h){return _.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":a=16,o=function(h){return _.rc2.createDecryptionCipher(h,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var s=_.util.hexToBytes(n.dekInfo.parameters),f=_.pbe.opensslDeriveBytes(e,s.substr(0,8),a),c=o(f);if(c.start(s),c.update(_.util.createBuffer(n.body)),c.finish())r=c.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=F.decryptPrivateKeyInfo(b.fromDer(r),e):r=b.fromDer(r),r!==null&&(r=F.privateKeyFromAsn1(r)),r};F.pbe.generatePkcs12Key=function(t,e,r,n,i,a){var o,s;if(typeof a>"u"||a===null){if(!("sha1"in _.md))throw new Error('"sha1" hash algorithm unavailable.');a=_.md.sha1.create()}var f=a.digestLength,c=a.blockLength,u=new _.util.ByteBuffer,h=new _.util.ByteBuffer;if(t!=null){for(s=0;s<t.length;s++)h.putInt16(t.charCodeAt(s));h.putInt16(0)}var l=h.length(),d=e.length(),p=new _.util.ByteBuffer;p.fillWithByte(r,c);var g=c*Math.ceil(d/c),m=new _.util.ByteBuffer;for(s=0;s<g;s++)m.putByte(e.at(s%d));var v=c*Math.ceil(l/c),w=new _.util.ByteBuffer;for(s=0;s<v;s++)w.putByte(h.at(s%l));var B=m;B.putBuffer(w);for(var D=Math.ceil(i/f),C=1;C<=D;C++){var I=new _.util.ByteBuffer;I.putBytes(p.bytes()),I.putBytes(B.bytes());for(var L=0;L<n;L++)a.start(),a.update(I.getBytes()),I=a.digest();var K=new _.util.ByteBuffer;for(s=0;s<c;s++)K.putByte(I.at(s%f));var it=Math.ceil(d/c)+Math.ceil(l/c),Ft=new _.util.ByteBuffer;for(o=0;o<it;o++){var _t=new _.util.ByteBuffer(B.getBytes(c)),wt=511;for(s=K.length()-1;s>=0;s--)wt=wt>>8,wt+=K.at(s)+_t.at(s),_t.setAt(s,wt&255);Ft.putBuffer(_t)}B=Ft,u.putBuffer(I)}return u.truncate(u.length()-i),u};F.pbe.getCipher=function(t,e,r){switch(t){case F.oids.pkcs5PBES2:return F.pbe.getCipherForPBES2(t,e,r);case F.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case F.oids["pbewithSHAAnd40BitRC2-CBC"]:return F.pbe.getCipherForPKCS12PBE(t,e,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=t,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};F.pbe.getCipherForPBES2=function(t,e,r){var n={},i=[];if(!b.validate(e,Mh,n,i)){var a=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=i,a}if(t=b.derToOid(n.kdfOid),t!==F.oids.pkcs5PBKDF2){var a=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw a.oid=t,a.supportedOids=["pkcs5PBKDF2"],a}if(t=b.derToOid(n.encOid),t!==F.oids["aes128-CBC"]&&t!==F.oids["aes192-CBC"]&&t!==F.oids["aes256-CBC"]&&t!==F.oids["des-EDE3-CBC"]&&t!==F.oids.desCBC){var a=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw a.oid=t,a.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],a}var o=n.kdfSalt,s=_.util.createBuffer(n.kdfIterationCount);s=s.getInt(s.length()<<3);var f,c;switch(F.oids[t]){case"aes128-CBC":f=16,c=_.aes.createDecryptionCipher;break;case"aes192-CBC":f=24,c=_.aes.createDecryptionCipher;break;case"aes256-CBC":f=32,c=_.aes.createDecryptionCipher;break;case"des-EDE3-CBC":f=24,c=_.des.createDecryptionCipher;break;case"desCBC":f=8,c=_.des.createDecryptionCipher;break}var u=Cs(n.prfOid),h=_.pkcs5.pbkdf2(r,o,s,f,u),l=n.encIv,d=c(h);return d.start(l),d};F.pbe.getCipherForPKCS12PBE=function(t,e,r){var n={},i=[];if(!b.validate(e,Vh,n,i)){var a=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=i,a}var o=_.util.createBuffer(n.salt),s=_.util.createBuffer(n.iterations);s=s.getInt(s.length()<<3);var f,c,u;switch(t){case F.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:f=24,c=8,u=_.des.startDecrypting;break;case F.oids["pbewithSHAAnd40BitRC2-CBC"]:f=5,c=8,u=function(g,m){var v=_.rc2.createDecryptionCipher(g,40);return v.start(m,null),v};break;default:var a=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw a.oid=t,a}var h=Cs(n.prfOid),l=F.pbe.generatePkcs12Key(r,o,1,s,f,h);h.start();var d=F.pbe.generatePkcs12Key(r,o,2,s,c,h);return u(l,d)};F.pbe.opensslDeriveBytes=function(t,e,r,n){if(typeof n>"u"||n===null){if(!("md5"in _.md))throw new Error('"md5" hash algorithm unavailable.');n=_.md.md5.create()}e===null&&(e="");for(var i=[As(n,t+e)],a=16,o=1;a<r;++o,a+=16)i.push(As(n,i[o-1]+t+e));return i.join("").substr(0,r)};function As(t,e){return t.start().update(e).digest().getBytes()}function Cs(t){var e;if(!t)e="hmacWithSHA1";else if(e=F.oids[b.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return Is(e)}function Is(t){var e=_.md;switch(t){case"hmacWithSHA224":e=_.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}function qh(t,e,r,n){var i=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,t),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,e.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,_.util.hexToBytes(r.toString(16))),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(F.oids[n]).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.NULL,!1,"")])),i}});var I0=O((c2,C0)=>{"use strict";C0.exports=Gp;function Gp(t,e){for(var r=new Array(arguments.length-1),n=0,i=2,a=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise(function(s,f){r[n]=function(u){if(a)if(a=!1,u)f(u);else{for(var h=new Array(arguments.length-1),l=0;l<h.length;)h[l++]=arguments[l];s.apply(null,h)}};try{t.apply(e||null,r)}catch(c){a&&(a=!1,f(c))}})}});var D0=O(R0=>{"use strict";var Mn=R0;Mn.length=function(e){var r=e.length;if(!r)return 0;for(var n=0;--r%4>1&&e.charAt(r)==="=";)++n;return Math.ceil(e.length*3)/4-n};var hr=new Array(64),_0=new Array(123);for(Vt=0;Vt<64;)_0[hr[Vt]=Vt<26?Vt+65:Vt<52?Vt+71:Vt<62?Vt-4:Vt-59|43]=Vt++;var Vt;Mn.encode=function(e,r,n){for(var i=null,a=[],o=0,s=0,f;r<n;){var c=e[r++];switch(s){case 0:a[o++]=hr[c>>2],f=(c&3)<<4,s=1;break;case 1:a[o++]=hr[f|c>>4],f=(c&15)<<2,s=2;break;case 2:a[o++]=hr[f|c>>6],a[o++]=hr[c&63],s=0;break}o>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,a)),o=0)}return s&&(a[o++]=hr[f],a[o++]=61,s===1&&(a[o++]=61)),i?(o&&i.push(String.fromCharCode.apply(String,a.slice(0,o))),i.join("")):String.fromCharCode.apply(String,a.slice(0,o))};var T0="invalid encoding";Mn.decode=function(e,r,n){for(var i=n,a=0,o,s=0;s<e.length;){var f=e.charCodeAt(s++);if(f===61&&a>1)break;if((f=_0[f])===void 0)throw Error(T0);switch(a){case 0:o=f,a=1;break;case 1:r[n++]=o<<2|(f&48)>>4,o=f,a=2;break;case 2:r[n++]=(o&15)<<4|(f&60)>>2,o=f,a=3;break;case 3:r[n++]=(o&3)<<6|f,a=0;break}}if(a===1)throw Error(T0);return n-i};Mn.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var k0=O((h2,P0)=>{"use strict";P0.exports=Vn;function Vn(){this._listeners={}}Vn.prototype.on=function(e,r,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:r,ctx:n||this}),this};Vn.prototype.off=function(e,r){if(e===void 0)this._listeners={};else if(r===void 0)this._listeners[e]=[];else for(var n=this._listeners[e],i=0;i<n.length;)n[i].fn===r?n.splice(i,1):++i;return this};Vn.prototype.emit=function(e){var r=this._listeners[e];if(r){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<r.length;)r[i].fn.apply(r[i++].ctx,n)}return this}});var M0=O((l2,O0)=>{"use strict";O0.exports=N0(N0);function N0(t){return typeof Float32Array<"u"?function(){var e=new Float32Array([-0]),r=new Uint8Array(e.buffer),n=r[3]===128;function i(f,c,u){e[0]=f,c[u]=r[0],c[u+1]=r[1],c[u+2]=r[2],c[u+3]=r[3]}function a(f,c,u){e[0]=f,c[u]=r[3],c[u+1]=r[2],c[u+2]=r[1],c[u+3]=r[0]}t.writeFloatLE=n?i:a,t.writeFloatBE=n?a:i;function o(f,c){return r[0]=f[c],r[1]=f[c+1],r[2]=f[c+2],r[3]=f[c+3],e[0]}function s(f,c){return r[3]=f[c],r[2]=f[c+1],r[1]=f[c+2],r[0]=f[c+3],e[0]}t.readFloatLE=n?o:s,t.readFloatBE=n?s:o}():function(){function e(n,i,a,o){var s=i<0?1:0;if(s&&(i=-i),i===0)n(1/i>0?0:2147483648,a,o);else if(isNaN(i))n(2143289344,a,o);else if(i>34028234663852886e22)n((s<<31|2139095040)>>>0,a,o);else if(i<11754943508222875e-54)n((s<<31|Math.round(i/1401298464324817e-60))>>>0,a,o);else{var f=Math.floor(Math.log(i)/Math.LN2),c=Math.round(i*Math.pow(2,-f)*8388608)&8388607;n((s<<31|f+127<<23|c)>>>0,a,o)}}t.writeFloatLE=e.bind(null,L0),t.writeFloatBE=e.bind(null,U0);function r(n,i,a){var o=n(i,a),s=(o>>31)*2+1,f=o>>>23&255,c=o&8388607;return f===255?c?NaN:s*(1/0):f===0?s*1401298464324817e-60*c:s*Math.pow(2,f-150)*(c+8388608)}t.readFloatLE=r.bind(null,K0),t.readFloatBE=r.bind(null,F0)}(),typeof Float64Array<"u"?function(){var e=new Float64Array([-0]),r=new Uint8Array(e.buffer),n=r[7]===128;function i(f,c,u){e[0]=f,c[u]=r[0],c[u+1]=r[1],c[u+2]=r[2],c[u+3]=r[3],c[u+4]=r[4],c[u+5]=r[5],c[u+6]=r[6],c[u+7]=r[7]}function a(f,c,u){e[0]=f,c[u]=r[7],c[u+1]=r[6],c[u+2]=r[5],c[u+3]=r[4],c[u+4]=r[3],c[u+5]=r[2],c[u+6]=r[1],c[u+7]=r[0]}t.writeDoubleLE=n?i:a,t.writeDoubleBE=n?a:i;function o(f,c){return r[0]=f[c],r[1]=f[c+1],r[2]=f[c+2],r[3]=f[c+3],r[4]=f[c+4],r[5]=f[c+5],r[6]=f[c+6],r[7]=f[c+7],e[0]}function s(f,c){return r[7]=f[c],r[6]=f[c+1],r[5]=f[c+2],r[4]=f[c+3],r[3]=f[c+4],r[2]=f[c+5],r[1]=f[c+6],r[0]=f[c+7],e[0]}t.readDoubleLE=n?o:s,t.readDoubleBE=n?s:o}():function(){function e(n,i,a,o,s,f){var c=o<0?1:0;if(c&&(o=-o),o===0)n(0,s,f+i),n(1/o>0?0:2147483648,s,f+a);else if(isNaN(o))n(0,s,f+i),n(2146959360,s,f+a);else if(o>17976931348623157e292)n(0,s,f+i),n((c<<31|2146435072)>>>0,s,f+a);else{var u;if(o<22250738585072014e-324)u=o/5e-324,n(u>>>0,s,f+i),n((c<<31|u/4294967296)>>>0,s,f+a);else{var h=Math.floor(Math.log(o)/Math.LN2);h===1024&&(h=1023),u=o*Math.pow(2,-h),n(u*4503599627370496>>>0,s,f+i),n((c<<31|h+1023<<20|u*1048576&1048575)>>>0,s,f+a)}}}t.writeDoubleLE=e.bind(null,L0,0,4),t.writeDoubleBE=e.bind(null,U0,4,0);function r(n,i,a,o,s){var f=n(o,s+i),c=n(o,s+a),u=(c>>31)*2+1,h=c>>>20&2047,l=4294967296*(c&1048575)+f;return h===2047?l?NaN:u*(1/0):h===0?u*5e-324*l:u*Math.pow(2,h-1075)*(l+4503599627370496)}t.readDoubleLE=r.bind(null,K0,0,4),t.readDoubleBE=r.bind(null,F0,4,0)}(),t}function L0(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function U0(t,e,r){e[r]=t>>>24,e[r+1]=t>>>16&255,e[r+2]=t>>>8&255,e[r+3]=t&255}function K0(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function F0(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}});var V0=O((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}});var z0=O(q0=>{"use strict";var ga=q0;ga.length=function(e){for(var r=0,n=0,i=0;i<e.length;++i)n=e.charCodeAt(i),n<128?r+=1:n<2048?r+=2:(n&64512)===55296&&(e.charCodeAt(i+1)&64512)===56320?(++i,r+=4):r+=3;return r};ga.read=function(e,r,n){var i=n-r;if(i<1)return"";for(var a=null,o=[],s=0,f;r<n;)f=e[r++],f<128?o[s++]=f:f>191&&f<224?o[s++]=(f&31)<<6|e[r++]&63:f>239&&f<365?(f=((f&7)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,o[s++]=55296+(f>>10),o[s++]=56320+(f&1023)):o[s++]=(f&15)<<12|(e[r++]&63)<<6|e[r++]&63,s>8191&&((a||(a=[])).push(String.fromCharCode.apply(String,o)),s=0);return a?(s&&a.push(String.fromCharCode.apply(String,o.slice(0,s))),a.join("")):String.fromCharCode.apply(String,o.slice(0,s))};ga.write=function(e,r,n){for(var i=n,a,o,s=0;s<e.length;++s)a=e.charCodeAt(s),a<128?r[n++]=a:a<2048?(r[n++]=a>>6|192,r[n++]=a&63|128):(a&64512)===55296&&((o=e.charCodeAt(s+1))&64512)===56320?(a=65536+((a&1023)<<10)+(o&1023),++s,r[n++]=a>>18|240,r[n++]=a>>12&63|128,r[n++]=a>>6&63|128,r[n++]=a&63|128):(r[n++]=a>>12|224,r[n++]=a>>6&63|128,r[n++]=a&63|128);return n-i}});var G0=O((d2,H0)=>{"use strict";H0.exports=Wp;function Wp(t,e,r){var n=r||8192,i=n>>>1,a=null,o=n;return function(f){if(f<1||f>i)return t(f);o+f>n&&(a=t(n),o=0);var c=e.call(a,o,o+=f);return o&7&&(o=(o|7)+1),c}}});var Z0=O((y2,W0)=>{"use strict";W0.exports=mt;var Zr=Oe();function mt(t,e){this.lo=t>>>0,this.hi=e>>>0}var Fe=mt.zero=new mt(0,0);Fe.toNumber=function(){return 0};Fe.zzEncode=Fe.zzDecode=function(){return this};Fe.length=function(){return 1};var Zp=mt.zeroHash="\0\0\0\0\0\0\0\0";mt.fromNumber=function(e){if(e===0)return Fe;var r=e<0;r&&(e=-e);var n=e>>>0,i=(e-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new mt(n,i)};mt.from=function(e){if(typeof e=="number")return mt.fromNumber(e);if(Zr.isString(e))if(Zr.Long)e=Zr.Long.fromString(e);else return mt.fromNumber(parseInt(e,10));return e.low||e.high?new mt(e.low>>>0,e.high>>>0):Fe};mt.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var r=~this.lo+1>>>0,n=~this.hi>>>0;return r||(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296};mt.prototype.toLong=function(e){return Zr.Long?new Zr.Long(this.lo|0,this.hi|0,!!e):{low:this.lo|0,high:this.hi|0,unsigned:!!e}};var Be=String.prototype.charCodeAt;mt.fromHash=function(e){return e===Zp?Fe:new mt((Be.call(e,0)|Be.call(e,1)<<8|Be.call(e,2)<<16|Be.call(e,3)<<24)>>>0,(Be.call(e,4)|Be.call(e,5)<<8|Be.call(e,6)<<16|Be.call(e,7)<<24)>>>0)};mt.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};mt.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};mt.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};mt.prototype.length=function(){var e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}});var Oe=O(xa=>{"use strict";var P=xa;P.asPromise=I0();P.base64=D0();P.EventEmitter=k0();P.float=M0();P.inquire=V0();P.utf8=z0();P.pool=G0();P.LongBits=Z0();P.isNode=!!(typeof globalThis<"u"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);P.global=P.isNode&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||xa;P.emptyArray=Object.freeze?Object.freeze([]):[];P.emptyObject=Object.freeze?Object.freeze({}):{};P.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};P.isString=function(e){return typeof e=="string"||e instanceof String};P.isObject=function(e){return e&&typeof e=="object"};P.isset=P.isSet=function(e,r){var n=e[r];return n!=null&&e.hasOwnProperty(r)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};P.Buffer=function(){try{var t=P.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch{return null}}();P._Buffer_from=null;P._Buffer_allocUnsafe=null;P.newBuffer=function(e){return typeof e=="number"?P.Buffer?P._Buffer_allocUnsafe(e):new P.Array(e):P.Buffer?P._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};P.Array=typeof Uint8Array<"u"?Uint8Array:Array;P.Long=P.global.dcodeIO&&P.global.dcodeIO.Long||P.global.Long||P.inquire("long");P.key2Re=/^true|false|0|1$/;P.key32Re=/^-?(?:0|[1-9][0-9]*)$/;P.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;P.longToHash=function(e){return e?P.LongBits.from(e).toHash():P.LongBits.zeroHash};P.longFromHash=function(e,r){var n=P.LongBits.fromHash(e);return P.Long?P.Long.fromBits(n.lo,n.hi,r):n.toNumber(!!r)};function $0(t,e,r){for(var n=Object.keys(e),i=0;i<n.length;++i)(t[n[i]]===void 0||!r)&&(t[n[i]]=e[n[i]]);return t}P.merge=$0;P.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function Y0(t){function e(r,n){if(!(this instanceof e))return new e(r,n);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&$0(this,n)}return e.prototype=Object.create(Error.prototype,{constructor:{value:e,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return t},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),e}P.newError=Y0;P.ProtocolError=Y0("ProtocolError");P.oneOfGetter=function(e){for(var r={},n=0;n<e.length;++n)r[e[n]]=1;return function(){for(var i=Object.keys(this),a=i.length-1;a>-1;--a)if(r[i[a]]===1&&this[i[a]]!==void 0&&this[i[a]]!==null)return i[a]}};P.oneOfSetter=function(e){return function(r){for(var n=0;n<e.length;++n)e[n]!==r&&delete this[e[n]]}};P.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};P._configure=function(){var t=P.Buffer;if(!t){P._Buffer_from=P._Buffer_allocUnsafe=null;return}P._Buffer_from=t.from!==Uint8Array.from&&t.from||function(r,n){return new t(r,n)},P._Buffer_allocUnsafe=t.allocUnsafe||function(r){return new t(r)}}});var ba=O((x2,tf)=>{"use strict";tf.exports=ct;var ee=Oe(),va,J0=ee.LongBits,$p=ee.utf8;function qt(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function ct(t){this.buf=t,this.pos=0,this.len=t.length}var Q0=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new ct(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new ct(e);throw Error("illegal buffer")},j0=function(){return ee.Buffer?function(r){return(ct.create=function(i){return ee.Buffer.isBuffer(i)?new va(i):Q0(i)})(r)}:Q0};ct.create=j0();ct.prototype._slice=ee.Array.prototype.subarray||ee.Array.prototype.slice;ct.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,qt(this,10);return e}}();ct.prototype.int32=function(){return this.uint32()|0};ct.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function ma(){var t=new J0(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw qt(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw qt(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}ct.prototype.bool=function(){return this.uint32()!==0};function qn(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}ct.prototype.fixed32=function(){if(this.pos+4>this.len)throw qt(this,4);return qn(this.buf,this.pos+=4)};ct.prototype.sfixed32=function(){if(this.pos+4>this.len)throw qt(this,4);return qn(this.buf,this.pos+=4)|0};function X0(){if(this.pos+8>this.len)throw qt(this,8);return new J0(qn(this.buf,this.pos+=4),qn(this.buf,this.pos+=4))}ct.prototype.float=function(){if(this.pos+4>this.len)throw qt(this,4);var e=ee.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};ct.prototype.double=function(){if(this.pos+8>this.len)throw qt(this,4);var e=ee.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};ct.prototype.bytes=function(){var e=this.uint32(),r=this.pos,n=this.pos+e;if(n>this.len)throw qt(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(r,n):r===n?new this.buf.constructor(0):this._slice.call(this.buf,r,n)};ct.prototype.string=function(){var e=this.bytes();return $p.read(e,0,e.length)};ct.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw qt(this,e);this.pos+=e}else do if(this.pos>=this.len)throw qt(this);while(this.buf[this.pos++]&128);return this};ct.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!==4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this};ct._configure=function(t){va=t,ct.create=j0(),va._configure();var e=ee.Long?"toLong":"toNumber";ee.merge(ct.prototype,{int64:function(){return ma.call(this)[e](!1)},uint64:function(){return ma.call(this)[e](!0)},sint64:function(){return ma.call(this).zzDecode()[e](!1)},fixed64:function(){return X0.call(this)[e](!0)},sfixed64:function(){return X0.call(this)[e](!1)}})}});var af=O((m2,nf)=>{"use strict";nf.exports=Me;var rf=ba();(Me.prototype=Object.create(rf.prototype)).constructor=Me;var ef=Oe();function Me(t){rf.call(this,t)}Me._configure=function(){ef.Buffer&&(Me.prototype._slice=ef.Buffer.prototype.slice)};Me.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};Me._configure()});var Ia=O((v2,cf)=>{"use strict";cf.exports=G;var Ut=Oe(),wa,zn=Ut.LongBits,of=Ut.base64,sf=Ut.utf8;function $r(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}function Ea(){}function Yp(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function G(){this.len=0,this.head=new $r(Ea,0,0),this.tail=this.head,this.states=null}var ff=function(){return Ut.Buffer?function(){return(G.create=function(){return new wa})()}:function(){return new G}};G.create=ff();G.alloc=function(e){return new Ut.Array(e)};Ut.Array!==Array&&(G.alloc=Ut.pool(G.alloc,Ut.Array.prototype.subarray));G.prototype._push=function(e,r,n){return this.tail=this.tail.next=new $r(e,r,n),this.len+=r,this};function Ba(t,e,r){e[r]=t&255}function Qp(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}function Aa(t,e){this.len=t,this.next=void 0,this.val=e}Aa.prototype=Object.create($r.prototype);Aa.prototype.fn=Qp;G.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new Aa((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};G.prototype.int32=function(e){return e<0?this._push(Ca,10,zn.fromNumber(e)):this.uint32(e)};G.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function Ca(t,e,r){for(;t.hi;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}G.prototype.uint64=function(e){var r=zn.from(e);return this._push(Ca,r.length(),r)};G.prototype.int64=G.prototype.uint64;G.prototype.sint64=function(e){var r=zn.from(e).zzEncode();return this._push(Ca,r.length(),r)};G.prototype.bool=function(e){return this._push(Ba,1,e?1:0)};function Sa(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}G.prototype.fixed32=function(e){return this._push(Sa,4,e>>>0)};G.prototype.sfixed32=G.prototype.fixed32;G.prototype.fixed64=function(e){var r=zn.from(e);return this._push(Sa,4,r.lo)._push(Sa,4,r.hi)};G.prototype.sfixed64=G.prototype.fixed64;G.prototype.float=function(e){return this._push(Ut.float.writeFloatLE,4,e)};G.prototype.double=function(e){return this._push(Ut.float.writeDoubleLE,8,e)};var Xp=Ut.Array.prototype.set?function(e,r,n){r.set(e,n)}:function(e,r,n){for(var i=0;i<e.length;++i)r[n+i]=e[i]};G.prototype.bytes=function(e){var r=e.length>>>0;if(!r)return this._push(Ba,1,0);if(Ut.isString(e)){var n=G.alloc(r=of.length(e));of.decode(e,n,0),e=n}return this.uint32(r)._push(Xp,r,e)};G.prototype.string=function(e){var r=sf.length(e);return r?this.uint32(r)._push(sf.write,r,e):this._push(Ba,1,0)};G.prototype.fork=function(){return this.states=new Yp(this),this.head=this.tail=new $r(Ea,0,0),this.len=0,this};G.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new $r(Ea,0,0),this.len=0),this};G.prototype.ldelim=function(){var e=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=r,this.len+=n),this};G.prototype.finish=function(){for(var e=this.head.next,r=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,r,n),n+=e.len,e=e.next;return r};G._configure=function(t){wa=t,G.create=ff(),wa._configure()}});var lf=O((b2,hf)=>{"use strict";hf.exports=re;var uf=Ia();(re.prototype=Object.create(uf.prototype)).constructor=re;var Ae=Oe();function re(){uf.call(this)}re._configure=function(){re.alloc=Ae._Buffer_allocUnsafe,re.writeBytesBuffer=Ae.Buffer&&Ae.Buffer.prototype instanceof Uint8Array&&Ae.Buffer.prototype.set.name==="set"?function(e,r,n){r.set(e,n)}:function(e,r,n){if(e.copy)e.copy(r,n,0,e.length);else for(var i=0;i<e.length;)r[n++]=e[i++]}};re.prototype.bytes=function(e){Ae.isString(e)&&(e=Ae._Buffer_from(e,"base64"));var r=e.length>>>0;return this.uint32(r),r&&this._push(re.writeBytesBuffer,r,e),this};function Jp(t,e,r){t.length<40?Ae.utf8.write(t,e,r):e.utf8Write?e.utf8Write(t,r):e.write(t,r)}re.prototype.string=function(e){var r=Ae.Buffer.byteLength(e);return this.uint32(r),r&&this._push(Jp,r,e),this};re._configure()});var Bf=O((bg,Ef)=>{var j=$();De();lt();var Qr=Ef.exports=j.sha512=j.sha512||{};j.md.sha512=j.md.algorithms.sha512=Qr;var wf=j.sha384=j.sha512.sha384=j.sha512.sha384||{};wf.create=function(){return Qr.create("SHA-384")};j.md.sha384=j.md.algorithms.sha384=wf;j.sha512.sha256=j.sha512.sha256||{create:function(){return Qr.create("SHA-512/256")}};j.md["sha512/256"]=j.md.algorithms["sha512/256"]=j.sha512.sha256;j.sha512.sha224=j.sha512.sha224||{create:function(){return Qr.create("SHA-512/224")}};j.md["sha512/224"]=j.md.algorithms["sha512/224"]=j.sha512.sha224;Qr.create=function(t){if(Sf||fd(),typeof t>"u"&&(t="SHA-512"),!(t in qe))throw new Error("Invalid SHA-512 algorithm: "+t);for(var e=qe[t],r=null,n=j.util.createBuffer(),i=new Array(80),a=0;a<80;++a)i[a]=new Array(2);var o=64;switch(t){case"SHA-384":o=48;break;case"SHA-512/256":o=32;break;case"SHA-512/224":o=28;break}var s={algorithm:t.replace("-","").toLowerCase(),blockLength:128,digestLength:o,messageLength:0,fullMessageLength:null,messageLengthSize:16};return s.start=function(){s.messageLength=0,s.fullMessageLength=s.messageLength128=[];for(var f=s.messageLengthSize/4,c=0;c<f;++c)s.fullMessageLength.push(0);n=j.util.createBuffer(),r=new Array(e.length);for(var c=0;c<e.length;++c)r[c]=e[c].slice(0);return s},s.start(),s.update=function(f,c){c==="utf8"&&(f=j.util.encodeUtf8(f));var u=f.length;s.messageLength+=u,u=[u/4294967296>>>0,u>>>0];for(var h=s.fullMessageLength.length-1;h>=0;--h)s.fullMessageLength[h]+=u[1],u[1]=u[0]+(s.fullMessageLength[h]/4294967296>>>0),s.fullMessageLength[h]=s.fullMessageLength[h]>>>0,u[0]=u[1]/4294967296>>>0;return n.putBytes(f),bf(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),s},s.digest=function(){var f=j.util.createBuffer();f.putBytes(n.bytes());var c=s.fullMessageLength[s.fullMessageLength.length-1]+s.messageLengthSize,u=c&s.blockLength-1;f.putBytes(La.substr(0,s.blockLength-u));for(var h,l,d=s.fullMessageLength[0]*8,p=0;p<s.fullMessageLength.length-1;++p)h=s.fullMessageLength[p+1]*8,l=h/4294967296>>>0,d+=l,f.putInt32(d>>>0),d=h>>>0;f.putInt32(d);for(var g=new Array(r.length),p=0;p<r.length;++p)g[p]=r[p].slice(0);bf(g,i,f);var m=j.util.createBuffer(),v;t==="SHA-512"?v=g.length:t==="SHA-384"?v=g.length-2:v=g.length-4;for(var p=0;p<v;++p)m.putInt32(g[p][0]),(p!==v-1||t!=="SHA-512/224")&&m.putInt32(g[p][1]);return m},s};var La=null,Sf=!1,Ua=null,qe=null;function fd(){La=String.fromCharCode(128),La+=j.util.fillString(String.fromCharCode(0),128),Ua=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],qe={},qe["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],qe["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],qe["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],qe["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],Sf=!0}function bf(t,e,r){for(var n,i,a,o,s,f,c,u,h,l,d,p,g,m,v,w,B,D,C,I,L,K,it,Ft,_t,wt,We,un,ut,Ct,N,ei,ri,ni,ii,ho=r.length();ho>=128;){for(ut=0;ut<16;++ut)e[ut][0]=r.getInt32()>>>0,e[ut][1]=r.getInt32()>>>0;for(;ut<80;++ut)ei=e[ut-2],Ct=ei[0],N=ei[1],n=((Ct>>>19|N<<13)^(N>>>29|Ct<<3)^Ct>>>6)>>>0,i=((Ct<<13|N>>>19)^(N<<3|Ct>>>29)^(Ct<<26|N>>>6))>>>0,ni=e[ut-15],Ct=ni[0],N=ni[1],a=((Ct>>>1|N<<31)^(Ct>>>8|N<<24)^Ct>>>7)>>>0,o=((Ct<<31|N>>>1)^(Ct<<24|N>>>8)^(Ct<<25|N>>>7))>>>0,ri=e[ut-7],ii=e[ut-16],N=i+ri[1]+o+ii[1],e[ut][0]=n+ri[0]+a+ii[0]+(N/4294967296>>>0)>>>0,e[ut][1]=N>>>0;for(g=t[0][0],m=t[0][1],v=t[1][0],w=t[1][1],B=t[2][0],D=t[2][1],C=t[3][0],I=t[3][1],L=t[4][0],K=t[4][1],it=t[5][0],Ft=t[5][1],_t=t[6][0],wt=t[6][1],We=t[7][0],un=t[7][1],ut=0;ut<80;++ut)c=((L>>>14|K<<18)^(L>>>18|K<<14)^(K>>>9|L<<23))>>>0,u=((L<<18|K>>>14)^(L<<14|K>>>18)^(K<<23|L>>>9))>>>0,h=(_t^L&(it^_t))>>>0,l=(wt^K&(Ft^wt))>>>0,s=((g>>>28|m<<4)^(m>>>2|g<<30)^(m>>>7|g<<25))>>>0,f=((g<<4|m>>>28)^(m<<30|g>>>2)^(m<<25|g>>>7))>>>0,d=(g&v|B&(g^v))>>>0,p=(m&w|D&(m^w))>>>0,N=un+u+l+Ua[ut][1]+e[ut][1],n=We+c+h+Ua[ut][0]+e[ut][0]+(N/4294967296>>>0)>>>0,i=N>>>0,N=f+p,a=s+d+(N/4294967296>>>0)>>>0,o=N>>>0,We=_t,un=wt,_t=it,wt=Ft,it=L,Ft=K,N=I+i,L=C+n+(N/4294967296>>>0)>>>0,K=N>>>0,C=B,I=D,B=v,D=w,v=g,w=m,N=i+o,g=n+a+(N/4294967296>>>0)>>>0,m=N>>>0;N=t[0][1]+m,t[0][0]=t[0][0]+g+(N/4294967296>>>0)>>>0,t[0][1]=N>>>0,N=t[1][1]+w,t[1][0]=t[1][0]+v+(N/4294967296>>>0)>>>0,t[1][1]=N>>>0,N=t[2][1]+D,t[2][0]=t[2][0]+B+(N/4294967296>>>0)>>>0,t[2][1]=N>>>0,N=t[3][1]+I,t[3][0]=t[3][0]+C+(N/4294967296>>>0)>>>0,t[3][1]=N>>>0,N=t[4][1]+K,t[4][0]=t[4][0]+L+(N/4294967296>>>0)>>>0,t[4][1]=N>>>0,N=t[5][1]+Ft,t[5][0]=t[5][0]+it+(N/4294967296>>>0)>>>0,t[5][1]=N>>>0,N=t[6][1]+wt,t[6][0]=t[6][0]+_t+(N/4294967296>>>0)>>>0,t[6][1]=N>>>0,N=t[7][1]+un,t[7][0]=t[7][0]+We+(N/4294967296>>>0)>>>0,t[7][1]=N>>>0,ho-=128}}});var Sy={};Z(Sy,{createEd25519PeerId:()=>gy,createFromJSON:()=>wy,createFromPrivKey:()=>cn,createFromProtobuf:()=>by,createFromPubKey:()=>hc,createRSAPeerId:()=>my,createSecp256k1PeerId:()=>xy,exportToProtobuf:()=>vy});var ex=ht(Pr(),1),rx=ht(_s(),1);var Y=class extends Error{code;props;constructor(e,r,n){super(e),this.code=r,this.name=n?.name??"CodeError",this.props=n??{}}};var Fd=ht($(),1);function Je(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}var Di={};Z(Di,{identity:()=>$h});function zh(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var a=t.charAt(i),o=a.charCodeAt(0);if(r[o]!==255)throw new TypeError(a+" is ambiguous");r[o]=i}var s=t.length,f=t.charAt(0),c=Math.log(s)/Math.log(256),u=Math.log(256)/Math.log(s);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,m=0,v=0,w=p.length;v!==w&&p[v]===0;)v++,g++;for(var B=(w-v)*u+1>>>0,D=new Uint8Array(B);v!==w;){for(var C=p[v],I=0,L=B-1;(C!==0||I<m)&&L!==-1;L--,I++)C+=256*D[L]>>>0,D[L]=C%s>>>0,C=C/s>>>0;if(C!==0)throw new Error("Non-zero carry");m=I,v++}for(var K=B-m;K!==B&&D[K]===0;)K++;for(var it=f.repeat(g);K<B;++K)it+=t.charAt(D[K]);return it}function l(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var m=0,v=0;p[g]===f;)m++,g++;for(var w=(p.length-g)*c+1>>>0,B=new Uint8Array(w);p[g];){var D=r[p.charCodeAt(g)];if(D===255)return;for(var C=0,I=w-1;(D!==0||C<v)&&I!==-1;I--,C++)D+=s*B[I]>>>0,B[I]=D%256>>>0,D=D/256>>>0;if(D!==0)throw new Error("Non-zero carry");v=C,g++}if(p[g]!==" "){for(var L=w-v;L!==w&&B[L]===0;)L++;for(var K=new Uint8Array(m+(w-L)),it=m;L!==w;)K[it++]=B[L++];return K}}}function d(p){var g=l(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:l,decode:d}}var Hh=zh,Gh=Hh,Rs=Gh;var Jy=new Uint8Array(0);var Ds=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},fe=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var Ps=t=>new TextEncoder().encode(t),ks=t=>new TextDecoder().decode(t);var Ii=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Ti=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Ls(this,e)}},_i=class{constructor(e){this.decoders=e}or(e){return Ls(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},Ls=(t,e)=>new _i({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),Ri=class{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new Ii(e,r,n),this.decoder=new Ti(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},je=({name:t,prefix:e,encode:r,decode:n})=>new Ri(t,e,r,n),ge=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:i}=Rs(r,e);return je({prefix:t,name:e,encode:n,decode:a=>fe(i(a))})},Wh=(t,e,r,n)=>{let i={};for(let u=0;u<e.length;++u)i[e[u]]=u;let a=t.length;for(;t[a-1]==="=";)--a;let o=new Uint8Array(a*r/8|0),s=0,f=0,c=0;for(let u=0;u<a;++u){let h=i[t[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);f=f<<r|h,s+=r,s>=8&&(s-=8,o[c++]=255&f>>s)}if(s>=r||255&f<<8-s)throw new SyntaxError("Unexpected end of data");return o},Zh=(t,e,r)=>{let n=e[e.length-1]==="=",i=(1<<r)-1,a="",o=0,s=0;for(let f=0;f<t.length;++f)for(s=s<<8|t[f],o+=8;o>r;)o-=r,a+=e[i&s>>o];if(o&&(a+=e[i&s<<r-o]),n)for(;a.length*r&7;)a+="=";return a},at=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>je({prefix:e,name:t,encode(i){return Zh(i,n,r)},decode(i){return Wh(i,n,r,t)}});var $h=je({prefix:"\0",name:"identity",encode:t=>ks(t),decode:t=>Ps(t)});var Pi={};Z(Pi,{base2:()=>Yh});var Yh=at({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var ki={};Z(ki,{base8:()=>Qh});var Qh=at({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Ni={};Z(Ni,{base10:()=>Xh});var Xh=ge({prefix:"9",name:"base10",alphabet:"0123456789"});var Li={};Z(Li,{base16:()=>Jh,base16upper:()=>jh});var Jh=at({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),jh=at({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Ui={};Z(Ui,{base32:()=>tr,base32hex:()=>nl,base32hexpad:()=>al,base32hexpadupper:()=>ol,base32hexupper:()=>il,base32pad:()=>el,base32padupper:()=>rl,base32upper:()=>tl,base32z:()=>sl});var tr=at({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),tl=at({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),el=at({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),rl=at({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),nl=at({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),il=at({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),al=at({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),ol=at({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),sl=at({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Ki={};Z(Ki,{base36:()=>fl,base36upper:()=>cl});var fl=ge({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),cl=ge({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Fi={};Z(Fi,{base58btc:()=>Jt,base58flickr:()=>ul});var Jt=ge({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),ul=ge({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Oi={};Z(Oi,{base64:()=>hl,base64pad:()=>ll,base64url:()=>pl,base64urlpad:()=>dl});var hl=at({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),ll=at({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),pl=at({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),dl=at({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Mi={};Z(Mi,{base256emoji:()=>vl});var Us=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),yl=Us.reduce((t,e,r)=>(t[r]=e,t),[]),gl=Us.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function xl(t){return t.reduce((e,r)=>(e+=yl[r],e),"")}function ml(t){let e=[];for(let r of t){let n=gl[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var vl=je({prefix:"\u{1F680}",name:"base256emoji",encode:xl,decode:ml});var Hi={};Z(Hi,{sha256:()=>Fl,sha512:()=>Ol});var bl=Os,Ks=128,wl=127,Sl=~wl,El=Math.pow(2,31);function Os(t,e,r){e=e||[],r=r||0;for(var n=r;t>=El;)e[r++]=t&255|Ks,t/=128;for(;t&Sl;)e[r++]=t&255|Ks,t>>>=7;return e[r]=t|0,Os.bytes=r-n+1,e}var Bl=Vi,Al=128,Fs=127;function Vi(t,n){var r=0,n=n||0,i=0,a=n,o,s=t.length;do{if(a>=s)throw Vi.bytes=0,new RangeError("Could not decode varint");o=t[a++],r+=i<28?(o&Fs)<<i:(o&Fs)*Math.pow(2,i),i+=7}while(o>=Al);return Vi.bytes=a-n,r}var Cl=Math.pow(2,7),Il=Math.pow(2,14),Tl=Math.pow(2,21),_l=Math.pow(2,28),Rl=Math.pow(2,35),Dl=Math.pow(2,42),Pl=Math.pow(2,49),kl=Math.pow(2,56),Nl=Math.pow(2,63),Ll=function(t){return t<Cl?1:t<Il?2:t<Tl?3:t<_l?4:t<Rl?5:t<Dl?6:t<Pl?7:t<kl?8:t<Nl?9:10},Ul={encode:bl,decode:Bl,encodingLength:Ll},Kl=Ul,Lr=Kl;var Ur=(t,e=0)=>[Lr.decode(t,e),Lr.decode.bytes],er=(t,e,r=0)=>(Lr.encode(t,e,r),e),rr=t=>Lr.encodingLength(t);var Le=(t,e)=>{let r=e.byteLength,n=rr(t),i=n+rr(r),a=new Uint8Array(i+r);return er(t,a,0),er(r,a,n),a.set(e,i),new nr(t,r,e,a)},Ms=t=>{let e=fe(t),[r,n]=Ur(e),[i,a]=Ur(e.subarray(n)),o=e.subarray(n+a);if(o.byteLength!==i)throw new Error("Incorrect length");return new nr(r,i,o,e)},Vs=(t,e)=>{if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&Ds(t.bytes,r.bytes)}},nr=class{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}};var zi=({name:t,code:e,encode:r})=>new qi(t,e,r),qi=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?Le(this.code,r):r.then(n=>Le(this.code,n))}else throw Error("Unknown type, must be binary type")}};var zs=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Fl=zi({name:"sha2-256",code:18,encode:zs("SHA-256")}),Ol=zi({name:"sha2-512",code:19,encode:zs("SHA-512")});var Gi={};Z(Gi,{identity:()=>ql});var Hs=0,Ml="identity",Gs=fe,Vl=t=>Le(Hs,Gs(t)),ql={code:Hs,name:Ml,encode:Gs,digest:Vl};var v1=new TextEncoder,b1=new TextDecoder;var Ws=(t,e)=>{let{bytes:r,version:n}=t;switch(n){case 0:return Wl(r,Wi(t),e||Jt.encoder);default:return Zl(r,Wi(t),e||tr.encoder)}};var Zs=new WeakMap,Wi=t=>{let e=Zs.get(t);if(e==null){let r=new Map;return Zs.set(t,r),r}return e},Rn=class t{constructor(e,r,n,i){this.code=r,this.version=e,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==Fr)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==$l)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return t.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=Le(e,r);return t.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return t.equals(this,e)}static equals(e,r){let n=r;return n&&e.code===n.code&&e.version===n.version&&Vs(e.multihash,n.multihash)}toString(e){return Ws(this,e)}toJSON(){return{"/":Ws(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof t)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:i,multihash:a,bytes:o}=r;return new t(n,i,a,o||$s(n,i,a.bytes))}else if(r[Yl]===!0){let{version:n,multihash:i,code:a}=r,o=Ms(i);return t.create(n,a,o)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==Fr)throw new Error(`Version 0 CID must use dag-pb (code: ${Fr}) block encoding`);return new t(e,r,n,n.bytes)}case 1:{let i=$s(e,r,n.bytes);return new t(e,r,n,i)}default:throw new Error("Invalid version")}}static createV0(e){return t.create(0,Fr,e)}static createV1(e,r){return t.create(1,e,r)}static decode(e){let[r,n]=t.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=t.inspectBytes(e),n=r.size-r.multihashSize,i=fe(e.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let a=i.subarray(r.multihashSize-r.digestSize),o=new nr(r.multihashCode,r.digestSize,a,i);return[r.version===0?t.createV0(o):t.createV1(r.codec,o),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,l]=Ur(e.subarray(r));return r+=l,h},i=n(),a=Fr;if(i===18?(i=0,r=0):a=n(),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let o=r,s=n(),f=n(),c=r+f,u=c-o;return{version:i,codec:a,multihashCode:s,digestSize:f,multihashSize:u,size:c}}static parse(e,r){let[n,i]=Gl(e,r),a=t.decode(i);if(a.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return Wi(a).set(n,e),a}},Gl=(t,e)=>{switch(t[0]){case"Q":{let r=e||Jt;return[Jt.prefix,r.decode(`${Jt.prefix}${t}`)]}case Jt.prefix:{let r=e||Jt;return[Jt.prefix,r.decode(t)]}case tr.prefix:{let r=e||tr;return[tr.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},Wl=(t,e,r)=>{let{prefix:n}=r;if(n!==Jt.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=e.get(n);if(i==null){let a=r.encode(t).slice(1);return e.set(n,a),a}else return i},Zl=(t,e,r)=>{let{prefix:n}=r,i=e.get(n);if(i==null){let a=r.encode(t);return e.set(n,a),a}else return i},Fr=112,$l=18,$s=(t,e,r)=>{let n=rr(t),i=n+rr(e),a=new Uint8Array(i+r.byteLength);return er(t,a,0),er(e,a,n),a.set(r,i),a},Yl=Symbol.for("@ipld/js-cid/CID");var Zi={...Di,...Pi,...ki,...Ni,...Li,...Ui,...Ki,...Fi,...Oi,...Mi},R1={...Hi,...Gi};function Dn(t=0){return globalThis.Buffer?.allocUnsafe!=null?Je(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function Qs(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var Ys=Qs("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),$i=Qs("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=Dn(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Ql={utf8:Ys,"utf-8":Ys,hex:Zi.base16,latin1:$i,ascii:$i,binary:$i,...Zi},Pn=Ql;function bt(t,e="utf8"){let r=Pn[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Je(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}var Na={};Z(Na,{Ed25519PrivateKey:()=>Ve,Ed25519PublicKey:()=>Yr,generateKeyPair:()=>id,generateKeyPairFromSeed:()=>xf,unmarshalEd25519PrivateKey:()=>rd,unmarshalEd25519PublicKey:()=>nd});var ji={};Z(ji,{base58btc:()=>Bt,base58flickr:()=>rp});function Xl(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var a=t.charAt(i),o=a.charCodeAt(0);if(r[o]!==255)throw new TypeError(a+" is ambiguous");r[o]=i}var s=t.length,f=t.charAt(0),c=Math.log(s)/Math.log(256),u=Math.log(256)/Math.log(s);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,m=0,v=0,w=p.length;v!==w&&p[v]===0;)v++,g++;for(var B=(w-v)*u+1>>>0,D=new Uint8Array(B);v!==w;){for(var C=p[v],I=0,L=B-1;(C!==0||I<m)&&L!==-1;L--,I++)C+=256*D[L]>>>0,D[L]=C%s>>>0,C=C/s>>>0;if(C!==0)throw new Error("Non-zero carry");m=I,v++}for(var K=B-m;K!==B&&D[K]===0;)K++;for(var it=f.repeat(g);K<B;++K)it+=t.charAt(D[K]);return it}function l(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var m=0,v=0;p[g]===f;)m++,g++;for(var w=(p.length-g)*c+1>>>0,B=new Uint8Array(w);p[g];){var D=r[p.charCodeAt(g)];if(D===255)return;for(var C=0,I=w-1;(D!==0||C<v)&&I!==-1;I--,C++)D+=s*B[I]>>>0,B[I]=D%256>>>0,D=D/256>>>0;if(D!==0)throw new Error("Non-zero carry");v=C,g++}if(p[g]!==" "){for(var L=w-v;L!==w&&B[L]===0;)L++;for(var K=new Uint8Array(m+(w-L)),it=m;L!==w;)K[it++]=B[L++];return K}}}function d(p){var g=l(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:l,decode:d}}var Jl=Xl,jl=Jl,Xs=jl;var V1=new Uint8Array(0);var Js=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},ce=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var js=t=>new TextEncoder().encode(t),t0=t=>new TextDecoder().decode(t);var Yi=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Qi=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return r0(this,e)}},Xi=class{constructor(e){this.decoders=e}or(e){return r0(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},r0=(t,e)=>new Xi({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),Ji=class{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new Yi(e,r,n),this.decoder=new Qi(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},ir=({name:t,prefix:e,encode:r,decode:n})=>new Ji(t,e,r,n),xe=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:i}=Xs(r,e);return ir({prefix:t,name:e,encode:n,decode:a=>ce(i(a))})},tp=(t,e,r,n)=>{let i={};for(let u=0;u<e.length;++u)i[e[u]]=u;let a=t.length;for(;t[a-1]==="=";)--a;let o=new Uint8Array(a*r/8|0),s=0,f=0,c=0;for(let u=0;u<a;++u){let h=i[t[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);f=f<<r|h,s+=r,s>=8&&(s-=8,o[c++]=255&f>>s)}if(s>=r||255&f<<8-s)throw new SyntaxError("Unexpected end of data");return o},ep=(t,e,r)=>{let n=e[e.length-1]==="=",i=(1<<r)-1,a="",o=0,s=0;for(let f=0;f<t.length;++f)for(s=s<<8|t[f],o+=8;o>r;)o-=r,a+=e[i&s>>o];if(o&&(a+=e[i&s<<r-o]),n)for(;a.length*r&7;)a+="=";return a},ot=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>ir({prefix:e,name:t,encode(i){return ep(i,n,r)},decode(i){return tp(i,n,r,t)}});var Bt=xe({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),rp=xe({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var ea={};Z(ea,{identity:()=>me});var np=a0,n0=128,ip=127,ap=~ip,op=Math.pow(2,31);function a0(t,e,r){e=e||[],r=r||0;for(var n=r;t>=op;)e[r++]=t&255|n0,t/=128;for(;t&ap;)e[r++]=t&255|n0,t>>>=7;return e[r]=t|0,a0.bytes=r-n+1,e}var sp=ta,fp=128,i0=127;function ta(t,n){var r=0,n=n||0,i=0,a=n,o,s=t.length;do{if(a>=s)throw ta.bytes=0,new RangeError("Could not decode varint");o=t[a++],r+=i<28?(o&i0)<<i:(o&i0)*Math.pow(2,i),i+=7}while(o>=fp);return ta.bytes=a-n,r}var cp=Math.pow(2,7),up=Math.pow(2,14),hp=Math.pow(2,21),lp=Math.pow(2,28),pp=Math.pow(2,35),dp=Math.pow(2,42),yp=Math.pow(2,49),gp=Math.pow(2,56),xp=Math.pow(2,63),mp=function(t){return t<cp?1:t<up?2:t<hp?3:t<lp?4:t<pp?5:t<dp?6:t<yp?7:t<gp?8:t<xp?9:10},vp={encode:np,decode:sp,encodingLength:mp},bp=vp,Or=bp;var Mr=(t,e=0)=>[Or.decode(t,e),Or.decode.bytes],ar=(t,e,r=0)=>(Or.encode(t,e,r),e),or=t=>Or.encodingLength(t);var jt=(t,e)=>{let r=e.byteLength,n=or(t),i=n+or(r),a=new Uint8Array(i+r);return ar(t,a,0),ar(r,a,n),a.set(e,i),new sr(t,r,e,a)},Vr=t=>{let e=ce(t),[r,n]=Mr(e),[i,a]=Mr(e.subarray(n)),o=e.subarray(n+a);if(o.byteLength!==i)throw new Error("Incorrect length");return new sr(r,i,o,e)},o0=(t,e)=>{if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&Js(t.bytes,r.bytes)}},sr=class{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}};var s0=0,wp="identity",f0=ce,Sp=t=>jt(s0,f0(t)),me={code:s0,name:wp,encode:f0,digest:Sp};var ia={};Z(ia,{sha256:()=>vt,sha512:()=>Ep});var na=({name:t,code:e,encode:r})=>new ra(t,e,r),ra=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?jt(this.code,r):r.then(n=>jt(this.code,n))}else throw Error("Unknown type, must be binary type")}};var u0=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),vt=na({name:"sha2-256",code:18,encode:u0("SHA-256")}),Ep=na({name:"sha2-512",code:19,encode:u0("SHA-512")});function Rt(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var Bp=ht(Ye(),1);var xt=BigInt(0),q=BigInt(1),we=BigInt(2),Ap=BigInt(8),h0=BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),J=Object.freeze({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),l:h0,n:h0,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")});var g0=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000"),qr=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),J1=BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742"),Cp=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),Ip=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),Tp=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),_p=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),pt=class t{constructor(e,r,n,i){this.x=e,this.y=r,this.z=n,this.t=i}static fromAffine(e){if(!(e instanceof ft))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return e.equals(ft.ZERO)?t.ZERO:new t(e.x,e.y,q,E(e.x*e.y))}static toAffineBatch(e){let r=Pp(e.map(n=>n.z));return e.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(e){return this.toAffineBatch(e).map(this.fromAffine)}equals(e){p0(e);let{x:r,y:n,z:i}=this,{x:a,y:o,z:s}=e,f=E(r*s),c=E(a*i),u=E(n*s),h=E(o*i);return f===c&&u===h}negate(){return new t(E(-this.x),this.y,this.z,E(-this.t))}double(){let{x:e,y:r,z:n}=this,{a:i}=J,a=E(e*e),o=E(r*r),s=E(we*E(n*n)),f=E(i*a),c=e+r,u=E(E(c*c)-a-o),h=f+o,l=h-s,d=f-o,p=E(u*l),g=E(h*d),m=E(u*d),v=E(l*h);return new t(p,g,v,m)}add(e){p0(e);let{x:r,y:n,z:i,t:a}=this,{x:o,y:s,z:f,t:c}=e,u=E((n-r)*(s+o)),h=E((n+r)*(s-o)),l=E(h-u);if(l===xt)return this.double();let d=E(i*we*c),p=E(a*we*f),g=p+d,m=h+u,v=p-d,w=E(g*l),B=E(m*v),D=E(g*v),C=E(l*m);return new t(w,B,C,D)}subtract(e){return this.add(e.negate())}precomputeWindow(e){let r=1+256/e,n=[],i=this,a=i;for(let o=0;o<r;o++){a=i,n.push(a);for(let s=1;s<2**(e-1);s++)a=a.add(i),n.push(a);i=a.double()}return n}wNAF(e,r){!r&&this.equals(t.BASE)&&(r=ft.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&ca.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=t.normalizeZ(i),ca.set(r,i)));let a=t.ZERO,o=t.BASE,s=1+256/n,f=2**(n-1),c=BigInt(2**n-1),u=2**n,h=BigInt(n);for(let l=0;l<s;l++){let d=l*f,p=Number(e&c);e>>=h,p>f&&(p-=u,e+=q);let g=d,m=d+Math.abs(p)-1,v=l%2!==0,w=p<0;p===0?o=o.add(l0(v,i[g])):a=a.add(l0(w,i[m]))}return t.normalizeZ([a,o])[0]}multiply(e,r){return this.wNAF(Ln(e,J.l),r)}multiplyUnsafe(e){let r=Ln(e,J.l,!1),n=t.BASE,i=t.ZERO;if(r===xt)return i;if(this.equals(i)||r===q)return this;if(this.equals(n))return this.wNAF(r);let a=i,o=this;for(;r>xt;)r&q&&(a=a.add(o)),o=o.double(),r>>=q;return a}isSmallOrder(){return this.multiplyUnsafe(J.h).equals(t.ZERO)}isTorsionFree(){let e=this.multiplyUnsafe(J.l/we).double();return J.l%we&&(e=e.add(this)),e.equals(t.ZERO)}toAffine(e){let{x:r,y:n,z:i}=this,a=this.equals(t.ZERO);e==null&&(e=a?Ap:Un(i));let o=E(r*e),s=E(n*e),f=E(i*e);if(a)return ft.ZERO;if(f!==q)throw new Error("invZ was invalid");return new ft(o,s)}fromRistrettoBytes(){oa()}toRistrettoBytes(){oa()}fromRistrettoHash(){oa()}};pt.BASE=new pt(J.Gx,J.Gy,q,E(J.Gx*J.Gy));pt.ZERO=new pt(xt,q,q,xt);function l0(t,e){let r=e.negate();return t?r:e}function p0(t){if(!(t instanceof pt))throw new TypeError("ExtendedPoint expected")}function aa(t){if(!(t instanceof Ue))throw new TypeError("RistrettoPoint expected")}function oa(){throw new Error("Legacy method: switch to RistrettoPoint")}var Ue=class t{constructor(e){this.ep=e}static calcElligatorRistrettoMap(e){let{d:r}=J,n=E(qr*e*e),i=E((n+q)*Tp),a=BigInt(-1),o=E((a-r*n)*E(n+r)),{isValid:s,value:f}=ha(i,o),c=E(f*e);be(c)||(c=E(-c)),s||(f=c),s||(a=n);let u=E(a*(n-q)*_p-o),h=f*f,l=E((f+f)*o),d=E(u*Cp),p=E(q-h),g=E(q+h);return new pt(E(l*g),E(p*d),E(d*g),E(l*p))}static hashToCurve(e){e=Se(e,64);let r=sa(e.slice(0,32)),n=this.calcElligatorRistrettoMap(r),i=sa(e.slice(32,64)),a=this.calcElligatorRistrettoMap(i);return new t(n.add(a))}static fromHex(e){e=Se(e,32);let{a:r,d:n}=J,i="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",a=sa(e);if(!Np(Hr(a),e)||be(a))throw new Error(i);let o=E(a*a),s=E(q+r*o),f=E(q-r*o),c=E(s*s),u=E(f*f),h=E(r*n*c-u),{isValid:l,value:d}=y0(E(h*u)),p=E(d*f),g=E(d*p*h),m=E((a+a)*p);be(m)&&(m=E(-m));let v=E(s*g),w=E(m*v);if(!l||be(w)||v===xt)throw new Error(i);return new t(new pt(m,v,q,w))}toRawBytes(){let{x:e,y:r,z:n,t:i}=this.ep,a=E(E(n+r)*E(n-r)),o=E(e*r),s=E(o*o),{value:f}=y0(E(a*s)),c=E(f*a),u=E(f*o),h=E(c*u*i),l;if(be(i*h)){let p=E(r*qr),g=E(e*qr);e=p,r=g,l=E(c*Ip)}else l=u;be(e*h)&&(r=E(-r));let d=E((n-r)*l);return be(d)&&(d=E(-d)),Hr(d)}toHex(){return Gr(this.toRawBytes())}toString(){return this.toHex()}equals(e){aa(e);let r=this.ep,n=e.ep,i=E(r.x*n.y)===E(r.y*n.x),a=E(r.y*n.y)===E(r.x*n.x);return i||a}add(e){return aa(e),new t(this.ep.add(e.ep))}subtract(e){return aa(e),new t(this.ep.subtract(e.ep))}multiply(e){return new t(this.ep.multiply(e))}multiplyUnsafe(e){return new t(this.ep.multiplyUnsafe(e))}};Ue.BASE=new Ue(pt.BASE);Ue.ZERO=new Ue(pt.ZERO);var ca=new WeakMap,ft=class t{constructor(e,r){this.x=e,this.y=r}_setWindowSize(e){this._WINDOW_SIZE=e,ca.delete(this)}static fromHex(e,r=!0){let{d:n,P:i}=J;e=Se(e,32);let a=e.slice();a[31]=e[31]&-129;let o=Wr(a);if(r&&o>=i)throw new Error("Expected 0 < hex < P");if(!r&&o>=g0)throw new Error("Expected 0 < hex < 2**256");let s=E(o*o),f=E(s-q),c=E(n*s+q),{isValid:u,value:h}=ha(f,c);if(!u)throw new Error("Point.fromHex: invalid y coordinate");let l=(h&q)===q;return(e[31]&128)!==0!==l&&(h=E(-h)),new t(h,o)}static async fromPrivateKey(e){return(await Kn(e)).point}toRawBytes(){let e=Hr(this.y);return e[31]|=this.x&q?128:0,e}toHex(){return Gr(this.toRawBytes())}toX25519(){let{y:e}=this,r=E((q+e)*Un(q-e));return Hr(r)}isTorsionFree(){return pt.fromAffine(this).isTorsionFree()}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new t(E(-this.x),this.y)}add(e){return pt.fromAffine(this).add(pt.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return pt.fromAffine(this).multiply(e,this).toAffine()}};ft.BASE=new ft(J.Gx,J.Gy);ft.ZERO=new ft(xt,q);var zr=class t{constructor(e,r){this.r=e,this.s=r,this.assertValidity()}static fromHex(e){let r=Se(e,64),n=ft.fromHex(r.slice(0,32),!1),i=Wr(r.slice(32,64));return new t(n,i)}assertValidity(){let{r:e,s:r}=this;if(!(e instanceof ft))throw new Error("Expected Point instance");return Ln(r,J.l,!1),this}toRawBytes(){let e=new Uint8Array(64);return e.set(this.r.toRawBytes()),e.set(Hr(this.s),32),e}toHex(){return Gr(this.toRawBytes())}};function d0(...t){if(!t.every(n=>n instanceof Uint8Array))throw new Error("Expected Uint8Array list");if(t.length===1)return t[0];let e=t.reduce((n,i)=>n+i.length,0),r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let a=t[n];r.set(a,i),i+=a.length}return r}var Rp=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Gr(t){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=Rp[t[r]];return e}function ua(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex");let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let n=r*2,i=t.slice(n,n+2),a=Number.parseInt(i,16);if(Number.isNaN(a)||a<0)throw new Error("Invalid byte sequence");e[r]=a}return e}function x0(t){let r=t.toString(16).padStart(64,"0");return ua(r)}function Hr(t){return x0(t).reverse()}function be(t){return(E(t)&q)===q}function Wr(t){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+Gr(Uint8Array.from(t).reverse()))}var Dp=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function sa(t){return E(Wr(t)&Dp)}function E(t,e=J.P){let r=t%e;return r>=xt?r:e+r}function Un(t,e=J.P){if(t===xt||e<=xt)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=E(t,e),n=e,i=xt,a=q,o=q,s=xt;for(;r!==xt;){let c=n/r,u=n%r,h=i-o*c,l=a-s*c;n=r,r=u,i=o,a=s,o=h,s=l}if(n!==q)throw new Error("invert: does not exist");return E(i,e)}function Pp(t,e=J.P){let r=new Array(t.length),n=t.reduce((a,o,s)=>o===xt?a:(r[s]=a,E(a*o,e)),q),i=Un(n,e);return t.reduceRight((a,o,s)=>o===xt?a:(r[s]=E(a*r[s],e),E(a*o,e)),i),r}function te(t,e){let{P:r}=J,n=t;for(;e-- >xt;)n*=n,n%=r;return n}function kp(t){let{P:e}=J,r=BigInt(5),n=BigInt(10),i=BigInt(20),a=BigInt(40),o=BigInt(80),f=t*t%e*t%e,c=te(f,we)*f%e,u=te(c,q)*t%e,h=te(u,r)*u%e,l=te(h,n)*h%e,d=te(l,i)*l%e,p=te(d,a)*d%e,g=te(p,o)*p%e,m=te(g,o)*p%e,v=te(m,n)*h%e;return{pow_p_5_8:te(v,we)*t%e,b2:f}}function ha(t,e){let r=E(e*e*e),n=E(r*r*e),i=kp(t*n).pow_p_5_8,a=E(t*r*i),o=E(e*a*a),s=a,f=E(a*qr),c=o===t,u=o===E(-t),h=o===E(-t*qr);return c&&(a=s),(u||h)&&(a=f),be(a)&&(a=E(-a)),{isValid:c||u,value:a}}function y0(t){return ha(q,t)}function Nn(t){return E(Wr(t),J.l)}function Np(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function Se(t,e){let r=t instanceof Uint8Array?Uint8Array.from(t):ua(t);if(typeof e=="number"&&r.length!==e)throw new Error(`Expected ${e} bytes`);return r}function Ln(t,e,r=!0){if(!e)throw new TypeError("Specify max value");if(typeof t=="number"&&Number.isSafeInteger(t)&&(t=BigInt(t)),typeof t=="bigint"&&t<e){if(r){if(xt<t)return t}else if(xt<=t)return t}throw new TypeError("Expected valid scalar: 0 < scalar < max")}function Lp(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function Up(t){if(t=typeof t=="bigint"||typeof t=="number"?x0(Ln(t,g0)):Se(t),t.length!==32)throw new Error("Expected 32 bytes");return t}function Kp(t){let e=Lp(t.slice(0,32)),r=t.slice(32,64),n=Nn(e),i=ft.BASE.multiply(n),a=i.toRawBytes();return{head:e,prefix:r,scalar:n,point:i,pointBytes:a}}var fa;async function Kn(t){return Kp(await Ee.sha512(Up(t)))}async function la(t){return(await Kn(t)).pointBytes}async function m0(t,e){t=Se(t);let{prefix:r,scalar:n,pointBytes:i}=await Kn(e),a=Nn(await Ee.sha512(r,t)),o=ft.BASE.multiply(a),s=Nn(await Ee.sha512(o.toRawBytes(),i,t)),f=E(a+s*n,J.l);return new zr(o,f).toRawBytes()}function Fp(t,e,r){e=Se(e),r instanceof ft||(r=ft.fromHex(r,!1));let{r:n,s:i}=t instanceof zr?t.assertValidity():zr.fromHex(t),a=pt.BASE.multiplyUnsafe(i);return{r:n,s:i,SB:a,pub:r,msg:e}}function Op(t,e,r,n){let i=Nn(n),a=pt.fromAffine(t).multiplyUnsafe(i);return pt.fromAffine(e).add(a).subtract(r).multiplyUnsafe(J.h).equals(pt.ZERO)}async function v0(t,e,r){let{r:n,SB:i,msg:a,pub:o}=Fp(t,e,r),s=await Ee.sha512(n.toRawBytes(),o.toRawBytes(),a);return Op(o,n,i,s)}ft.BASE._setWindowSize(8);var ve={node:Bp,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0},Ee={bytesToHex:Gr,hexToBytes:ua,concatBytes:d0,getExtendedPublicKey:Kn,mod:E,invert:Un,TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],hashToPrivateScalar:t=>{if(t=Se(t),t.length<40||t.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");return E(Wr(t),J.l-q)+q},randomBytes:(t=32)=>{if(ve.web)return ve.web.getRandomValues(new Uint8Array(t));if(ve.node){let{randomBytes:e}=ve.node;return new Uint8Array(e(t).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>Ee.randomBytes(32),sha512:async(...t)=>{let e=d0(...t);if(ve.web){let r=await ve.web.subtle.digest("SHA-512",e.buffer);return new Uint8Array(r)}else{if(ve.node)return Uint8Array.from(ve.node.createHash("sha512").update(e).digest());throw new Error("The environment doesn't have sha512 function")}},precompute(t=8,e=ft.BASE){let r=e.equals(ft.BASE)?e:new ft(e.x,e.y);return r._setWindowSize(t),r.multiply(we),r},sha512Sync:void 0};Object.defineProperties(Ee,{sha512Sync:{configurable:!1,get(){return fa},set(t){fa||(fa=t)}}});var cr=32,ue=64,Fn=32;async function b0(){let t=Ee.randomPrivateKey(),e=await la(t);return{privateKey:B0(t,e),publicKey:e}}async function w0(t){if(t.length!==Fn)throw new TypeError('"seed" must be 32 bytes in length.');if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let e=t,r=await la(e);return{privateKey:B0(e,r),publicKey:r}}async function S0(t,e){let r=t.subarray(0,Fn);return m0(e,r)}async function E0(t,e,r){return v0(e,r,t)}function B0(t,e){let r=new Uint8Array(ue);for(let n=0;n<Fn;n++)r[n]=t[n],r[Fn+n]=e[n];return r}var pa={};Z(pa,{base64:()=>On,base64pad:()=>qp,base64url:()=>zp,base64urlpad:()=>Hp});var On=ot({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),qp=ot({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),zp=ot({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Hp=ot({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function Ke(t,e){e==null&&(e=t.reduce((i,a)=>i+a.length,0));let r=Dn(e),n=0;for(let i of t)r.set(i,n),n+=i.length;return Je(r)}var Tt={get(t=globalThis){let e=t.crypto;if(e==null||e.subtle==null)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}};var da={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};function ya(t){let e=t?.algorithm??"AES-GCM",r=t?.keyLength??16,n=t?.nonceLength??12,i=t?.digest??"SHA-256",a=t?.saltLength??16,o=t?.iterations??32767,s=Tt.get();r*=8;async function f(h,l){let d=s.getRandomValues(new Uint8Array(a)),p=s.getRandomValues(new Uint8Array(n)),g={name:e,iv:p};typeof l=="string"&&(l=bt(l));let m;if(l.length===0){m=await s.subtle.importKey("jwk",da,{name:"AES-GCM"},!0,["encrypt"]);try{let w={name:"PBKDF2",salt:d,iterations:o,hash:{name:i}},B=await s.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);m=await s.subtle.deriveKey(w,B,{name:e,length:r},!0,["encrypt"])}catch{m=await s.subtle.importKey("jwk",da,{name:"AES-GCM"},!0,["encrypt"])}}else{let w={name:"PBKDF2",salt:d,iterations:o,hash:{name:i}},B=await s.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);m=await s.subtle.deriveKey(w,B,{name:e,length:r},!0,["encrypt"])}let v=await s.subtle.encrypt(g,m,h);return Ke([d,g.iv,new Uint8Array(v)])}async function c(h,l){let d=h.subarray(0,a),p=h.subarray(a,a+n),g=h.subarray(a+n),m={name:e,iv:p};typeof l=="string"&&(l=bt(l));let v;if(l.length===0)try{let B={name:"PBKDF2",salt:d,iterations:o,hash:{name:i}},D=await s.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);v=await s.subtle.deriveKey(B,D,{name:e,length:r},!0,["decrypt"])}catch{v=await s.subtle.importKey("jwk",da,{name:"AES-GCM"},!0,["decrypt"])}else{let B={name:"PBKDF2",salt:d,iterations:o,hash:{name:i}},D=await s.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);v=await s.subtle.deriveKey(B,D,{name:e,length:r},!0,["decrypt"])}let w=await s.subtle.decrypt(m,v,g);return new Uint8Array(w)}return{encrypt:f,decrypt:c}}async function ur(t,e){let n=await ya().encrypt(t,e);return On.encode(n)}var Ta=ht(ba(),1),pf=ht(af(),1),df=ht(Oe(),1),_a=ht(Ia(),1),yf=ht(lf(),1);function jp(){df.default._configure(),Ta.default._configure(pf.default),_a.default._configure(yf.default)}jp();var gf=["uint64","int64","sint64","fixed64","sfixed64"];function td(t){for(let e of gf){if(t[e]==null)continue;let r=t[e];t[e]=function(){return BigInt(r.call(this).toString())}}return t}function Ra(t){return td(new Ta.default(t))}function ed(t){for(let e of gf){if(t[e]==null)continue;let r=t[e];t[e]=function(n){return r.call(this,n.toString())}}return t}function Da(){return ed(_a.default.create())}function lr(t,e){let r=Ra(t instanceof Uint8Array?t:t.subarray());return e.decode(r)}function pr(t,e){let r=Da();return e.encode(t,r,{lengthDelimited:!1}),r.finish()}var dr;(function(t){t[t.VARINT=0]="VARINT",t[t.BIT64=1]="BIT64",t[t.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",t[t.START_GROUP=3]="START_GROUP",t[t.END_GROUP=4]="END_GROUP",t[t.BIT32=5]="BIT32"})(dr||(dr={}));function Hn(t,e,r,n){return{name:t,type:e,encode:r,decode:n}}function Pa(t){function e(i){if(t[i.toString()]==null)throw new Error("Invalid enum value");return t[i]}let r=function(a,o){let s=e(a);o.int32(s)},n=function(a){let o=a.int32();return e(o)};return Hn("enum",dr.VARINT,r,n)}function yr(t,e){return Hn("message",dr.LENGTH_DELIMITED,t,e)}var rt;(function(t){t.RSA="RSA",t.Ed25519="Ed25519",t.Secp256k1="Secp256k1"})(rt||(rt={}));var ka;(function(t){t[t.RSA=0]="RSA",t[t.Ed25519=1]="Ed25519",t[t.Secp256k1=2]="Secp256k1"})(ka||(ka={}));(function(t){t.codec=()=>Pa(ka)})(rt||(rt={}));var ne;(function(t){let e;t.codec=()=>(e==null&&(e=yr((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),rt.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},a=n==null?r.len:r.pos+n;for(;r.pos<a;){let o=r.uint32();switch(o>>>3){case 1:i.Type=rt.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(o&7);break}}return i})),e),t.encode=r=>pr(r,t.codec()),t.decode=r=>lr(r,t.codec())})(ne||(ne={}));var ie;(function(t){let e;t.codec=()=>(e==null&&(e=yr((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),rt.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},a=n==null?r.len:r.pos+n;for(;r.pos<a;){let o=r.uint32();switch(o>>>3){case 1:i.Type=rt.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(o&7);break}}return i})),e),t.encode=r=>pr(r,t.codec()),t.decode=r=>lr(r,t.codec())})(ie||(ie={}));var Yr=class{_key;constructor(e){this._key=gr(e,cr)}async verify(e,r){return E0(this._key,r,e)}marshal(){return this._key}get bytes(){return ne.encode({Type:rt.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Rt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await vt.digest(this.bytes);return e}},Ve=class{_key;_publicKey;constructor(e,r){this._key=gr(e,ue),this._publicKey=gr(r,cr)}async sign(e){return S0(this._key,e)}get public(){return new Yr(this._publicKey)}marshal(){return this._key}get bytes(){return ie.encode({Type:rt.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Rt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await vt.digest(this.bytes);return e}async id(){let e=me.digest(this.public.bytes);return Bt.encode(e.bytes).substring(1)}async export(e,r="libp2p-key"){if(r==="libp2p-key")return ur(this.bytes,e);throw new Y(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function rd(t){if(t.length>ue){t=gr(t,ue+cr);let n=t.subarray(0,ue),i=t.subarray(ue,t.length);return new Ve(n,i)}t=gr(t,ue);let e=t.subarray(0,ue),r=t.subarray(cr);return new Ve(e,r)}function nd(t){return t=gr(t,cr),new Yr(t)}async function id(){let{privateKey:t,publicKey:e}=await b0();return new Ve(t,e)}async function xf(t){let{privateKey:e,publicKey:r}=await w0(t);return new Ve(e,r)}function gr(t,e){if(t=Uint8Array.from(t??[]),t.length!==e)throw new Y(`Key must be a Uint8Array of length ${e}, got ${t.length}`,"ERR_INVALID_KEY_TYPE");return t}function Dt(t,e="utf8"){let r=Pn[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}var W2=ht(lt(),1),Z2=ht(An(),1),mf=ht($(),1);function zt(t,e){let r=Uint8Array.from(t.abs().toByteArray());if(r=r[0]===0?r.subarray(1):r,e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=Ke([new Uint8Array(e-r.length),r])}return Dt(r,"base64url")}function Pt(t){let e=vf(t);return new mf.default.jsbn.BigInteger(Dt(e,"base16"),16)}function vf(t,e){let r=bt(t,"base64urlpad");if(e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=Ke([new Uint8Array(e-r.length),r])}return r}var ad={"P-256":256,"P-384":384,"P-521":521},od=Object.keys(ad),ig=od.join(" / ");var Ga={};Z(Ga,{RsaPrivateKey:()=>Br,RsaPublicKey:()=>rn,fromJwk:()=>Pd,generateKeyPair:()=>kd,unmarshalRsaPrivateKey:()=>Rd,unmarshalRsaPublicKey:()=>Dd});var en=ht($(),1);var qg=ht(Bf(),1);var cd=ht(Ye(),1);var z=BigInt(0),tt=BigInt(1),Ie=BigInt(2),Jr=BigInt(3),Af=BigInt(8),st=Object.freeze({a:z,b:BigInt(7),P:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:tt,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")}),Cf=(t,e)=>(t+e/Ie)/e,Wn={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar(t){let{n:e}=st,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-tt*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),a=r,o=BigInt("0x100000000000000000000000000000000"),s=Cf(a*t,e),f=Cf(-n*t,e),c=R(t-s*r-f*i,e),u=R(-s*n-f*a,e),h=c>o,l=u>o;if(h&&(c=e-c),l&&(u=e-u),c>o||u>o)throw new Error("splitScalarEndo: Endomorphism failed, k="+t);return{k1neg:h,k1:c,k2neg:l,k2:u}}},Ht=32,br=32,ud=32,If=Ht+1,Tf=2*Ht+1;function _f(t){let{a:e,b:r}=st,n=R(t*t),i=R(n*t);return R(i+e*t+r)}var Zn=st.a===z,Qn=class extends Error{constructor(e){super(e)}};function Rf(t){if(!(t instanceof At))throw new TypeError("JacobianPoint expected")}var At=class t{constructor(e,r,n){this.x=e,this.y=r,this.z=n}static fromAffine(e){if(!(e instanceof nt))throw new TypeError("JacobianPoint#fromAffine: expected Point");return e.equals(nt.ZERO)?t.ZERO:new t(e.x,e.y,tt)}static toAffineBatch(e){let r=yd(e.map(n=>n.z));return e.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(e){return t.toAffineBatch(e).map(t.fromAffine)}equals(e){Rf(e);let{x:r,y:n,z:i}=this,{x:a,y:o,z:s}=e,f=R(i*i),c=R(s*s),u=R(r*c),h=R(a*f),l=R(R(n*s)*c),d=R(R(o*i)*f);return u===h&&l===d}negate(){return new t(this.x,R(-this.y),this.z)}double(){let{x:e,y:r,z:n}=this,i=R(e*e),a=R(r*r),o=R(a*a),s=e+a,f=R(Ie*(R(s*s)-i-o)),c=R(Jr*i),u=R(c*c),h=R(u-Ie*f),l=R(c*(f-h)-Af*o),d=R(Ie*r*n);return new t(h,l,d)}add(e){Rf(e);let{x:r,y:n,z:i}=this,{x:a,y:o,z:s}=e;if(a===z||o===z)return this;if(r===z||n===z)return e;let f=R(i*i),c=R(s*s),u=R(r*c),h=R(a*f),l=R(R(n*s)*c),d=R(R(o*i)*f),p=R(h-u),g=R(d-l);if(p===z)return g===z?this.double():t.ZERO;let m=R(p*p),v=R(p*m),w=R(u*m),B=R(g*g-v-Ie*w),D=R(g*(w-B)-l*v),C=R(i*s*p);return new t(B,D,C)}subtract(e){return this.add(e.negate())}multiplyUnsafe(e){let r=t.ZERO;if(typeof e=="bigint"&&e===z)return r;let n=kf(e);if(n===tt)return this;if(!Zn){let h=r,l=this;for(;n>z;)n&tt&&(h=h.add(l)),l=l.double(),n>>=tt;return h}let{k1neg:i,k1:a,k2neg:o,k2:s}=Wn.splitScalar(n),f=r,c=r,u=this;for(;a>z||s>z;)a&tt&&(f=f.add(u)),s&tt&&(c=c.add(u)),u=u.double(),a>>=tt,s>>=tt;return i&&(f=f.negate()),o&&(c=c.negate()),c=new t(R(c.x*Wn.beta),c.y,c.z),f.add(c)}precomputeWindow(e){let r=Zn?128/e+1:256/e+1,n=[],i=this,a=i;for(let o=0;o<r;o++){a=i,n.push(a);for(let s=1;s<2**(e-1);s++)a=a.add(i),n.push(a);i=a.double()}return n}wNAF(e,r){!r&&this.equals(t.BASE)&&(r=nt.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&Fa.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=t.normalizeZ(i),Fa.set(r,i)));let a=t.ZERO,o=t.BASE,s=1+(Zn?128/n:256/n),f=2**(n-1),c=BigInt(2**n-1),u=2**n,h=BigInt(n);for(let l=0;l<s;l++){let d=l*f,p=Number(e&c);e>>=h,p>f&&(p-=u,e+=tt);let g=d,m=d+Math.abs(p)-1,v=l%2!==0,w=p<0;p===0?o=o.add($n(v,i[g])):a=a.add($n(w,i[m]))}return{p:a,f:o}}multiply(e,r){let n=kf(e),i,a;if(Zn){let{k1neg:o,k1:s,k2neg:f,k2:c}=Wn.splitScalar(n),{p:u,f:h}=this.wNAF(s,r),{p:l,f:d}=this.wNAF(c,r);u=$n(o,u),l=$n(f,l),l=new t(R(l.x*Wn.beta),l.y,l.z),i=u.add(l),a=h.add(d)}else{let{p:o,f:s}=this.wNAF(n,r);i=o,a=s}return t.normalizeZ([i,a])[0]}toAffine(e){let{x:r,y:n,z:i}=this,a=this.equals(t.ZERO);e==null&&(e=a?Af:Er(i));let o=e,s=R(o*o),f=R(s*o),c=R(r*s),u=R(n*f),h=R(i*o);if(a)return nt.ZERO;if(h!==tt)throw new Error("invZ was invalid");return new nt(c,u)}};At.BASE=new At(st.Gx,st.Gy,tt);At.ZERO=new At(z,tt,z);function $n(t,e){let r=e.negate();return t?r:e}var Fa=new WeakMap,nt=class t{constructor(e,r){this.x=e,this.y=r}_setWindowSize(e){this._WINDOW_SIZE=e,Fa.delete(this)}hasEvenY(){return this.y%Ie===z}static fromCompressedHex(e){let r=e.length===32,n=Te(r?e:e.subarray(1));if(!Ka(n))throw new Error("Point is not on curve");let i=_f(n),a=dd(i),o=(a&tt)===tt;r?o&&(a=R(-a)):(e[0]&1)===1!==o&&(a=R(-a));let s=new t(n,a);return s.assertValidity(),s}static fromUncompressedHex(e){let r=Te(e.subarray(1,Ht+1)),n=Te(e.subarray(Ht+1,Ht*2+1)),i=new t(r,n);return i.assertValidity(),i}static fromHex(e){let r=Sr(e),n=r.length,i=r[0];if(n===Ht)return this.fromCompressedHex(r);if(n===If&&(i===2||i===3))return this.fromCompressedHex(r);if(n===Tf&&i===4)return this.fromUncompressedHex(r);throw new Error(`Point.fromHex: received invalid point. Expected 32-${If} compressed bytes or ${Tf} uncompressed bytes, not ${n}`)}static fromPrivateKey(e){return t.BASE.multiply(Jn(e))}static fromSignature(e,r,n){let{r:i,s:a}=Nf(r);if(![0,1,2,3].includes(n))throw new Error("Cannot recover: invalid recovery bit");let o=Va(Sr(e)),{n:s}=st,f=n===2||n===3?i+s:i,c=Er(f,s),u=R(-o*c,s),h=R(a*c,s),l=n&1?"03":"02",d=t.fromHex(l+mr(f)),p=t.BASE.multiplyAndAddUnsafe(d,u,h);if(!p)throw new Error("Cannot recover signature: point at infinify");return p.assertValidity(),p}toRawBytes(e=!1){return ze(this.toHex(e))}toHex(e=!1){let r=mr(this.x);return e?`${this.hasEvenY()?"02":"03"}${r}`:`04${r}${mr(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){let e="Point is not on elliptic curve",{x:r,y:n}=this;if(!Ka(r)||!Ka(n))throw new Error(e);let i=R(n*n),a=_f(r);if(R(i-a)!==z)throw new Error(e)}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new t(this.x,R(-this.y))}double(){return At.fromAffine(this).double().toAffine()}add(e){return At.fromAffine(this).add(At.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return At.fromAffine(this).multiply(e,this).toAffine()}multiplyAndAddUnsafe(e,r,n){let i=At.fromAffine(this),a=r===z||r===tt||this!==t.BASE?i.multiplyUnsafe(r):i.multiply(r),o=At.fromAffine(e).multiplyUnsafe(n),s=a.add(o);return s.equals(At.ZERO)?void 0:s.toAffine()}};nt.BASE=new nt(st.Gx,st.Gy);nt.ZERO=new nt(z,z);function Df(t){return Number.parseInt(t[0],16)>=8?"00"+t:t}function Pf(t){if(t.length<2||t[0]!==2)throw new Error(`Invalid signature integer tag: ${wr(t)}`);let e=t[1],r=t.subarray(2,e+2);if(!e||r.length!==e)throw new Error("Invalid signature integer: wrong length");if(r[0]===0&&r[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:Te(r),left:t.subarray(e+2)}}function hd(t){if(t.length<2||t[0]!=48)throw new Error(`Invalid signature tag: ${wr(t)}`);if(t[1]!==t.length-2)throw new Error("Invalid signature: incorrect length");let{data:e,left:r}=Pf(t.subarray(2)),{data:n,left:i}=Pf(r);if(i.length)throw new Error(`Invalid signature: left bytes after parsing: ${wr(i)}`);return{r:e,s:n}}var xr=class t{constructor(e,r){this.r=e,this.s=r,this.assertValidity()}static fromCompact(e){let r=e instanceof Uint8Array,n="Signature.fromCompact";if(typeof e!="string"&&!r)throw new TypeError(`${n}: Expected string or Uint8Array`);let i=r?wr(e):e;if(i.length!==128)throw new Error(`${n}: Expected 64-byte hex`);return new t(Xn(i.slice(0,64)),Xn(i.slice(64,128)))}static fromDER(e){let r=e instanceof Uint8Array;if(typeof e!="string"&&!r)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");let{r:n,s:i}=hd(r?e:ze(e));return new t(n,i)}static fromHex(e){return this.fromDER(e)}assertValidity(){let{r:e,s:r}=this;if(!tn(e))throw new Error("Invalid Signature: r must be 0 < r < n");if(!tn(r))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){let e=st.n>>tt;return this.s>e}normalizeS(){return this.hasHighS()?new t(this.r,R(-this.s,st.n)):this}toDERRawBytes(){return ze(this.toDERHex())}toDERHex(){let e=Df(Xr(this.s)),r=Df(Xr(this.r)),n=e.length/2,i=r.length/2,a=Xr(n),o=Xr(i);return`30${Xr(i+n+4)}02${o}${r}02${a}${e}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return ze(this.toCompactHex())}toCompactHex(){return mr(this.r)+mr(this.s)}};function Ce(...t){if(!t.every(n=>n instanceof Uint8Array))throw new Error("Uint8Array list expected");if(t.length===1)return t[0];let e=t.reduce((n,i)=>n+i.length,0),r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let a=t[n];r.set(a,i),i+=a.length}return r}var ld=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function wr(t){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");let e="";for(let r=0;r<t.length;r++)e+=ld[t[r]];return e}var pd=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000");function mr(t){if(typeof t!="bigint")throw new Error("Expected bigint");if(!(z<=t&&t<pd))throw new Error("Expected number 0 <= n < 2^256");return t.toString(16).padStart(64,"0")}function Oa(t){let e=ze(mr(t));if(e.length!==32)throw new Error("Error: expected 32 bytes");return e}function Xr(t){let e=t.toString(16);return e.length&1?`0${e}`:e}function Xn(t){if(typeof t!="string")throw new TypeError("hexToNumber: expected string, got "+typeof t);return BigInt(`0x${t}`)}function ze(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+t.length);let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let n=r*2,i=t.slice(n,n+2),a=Number.parseInt(i,16);if(Number.isNaN(a)||a<0)throw new Error("Invalid byte sequence");e[r]=a}return e}function Te(t){return Xn(wr(t))}function Sr(t){return t instanceof Uint8Array?Uint8Array.from(t):ze(t)}function kf(t){if(typeof t=="number"&&Number.isSafeInteger(t)&&t>0)return BigInt(t);if(typeof t=="bigint"&&tn(t))return t;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function R(t,e=st.P){let r=t%e;return r>=z?r:e+r}function Kt(t,e){let{P:r}=st,n=t;for(;e-- >z;)n*=n,n%=r;return n}function dd(t){let{P:e}=st,r=BigInt(6),n=BigInt(11),i=BigInt(22),a=BigInt(23),o=BigInt(44),s=BigInt(88),f=t*t*t%e,c=f*f*t%e,u=Kt(c,Jr)*c%e,h=Kt(u,Jr)*c%e,l=Kt(h,Ie)*f%e,d=Kt(l,n)*l%e,p=Kt(d,i)*d%e,g=Kt(p,o)*p%e,m=Kt(g,s)*g%e,v=Kt(m,o)*p%e,w=Kt(v,Jr)*c%e,B=Kt(w,a)*d%e,D=Kt(B,r)*f%e,C=Kt(D,Ie);if(C*C%e!==t)throw new Error("Cannot find square root");return C}function Er(t,e=st.P){if(t===z||e<=z)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=R(t,e),n=e,i=z,a=tt,o=tt,s=z;for(;r!==z;){let c=n/r,u=n%r,h=i-o*c,l=a-s*c;n=r,r=u,i=o,a=s,o=h,s=l}if(n!==tt)throw new Error("invert: does not exist");return R(i,e)}function yd(t,e=st.P){let r=new Array(t.length),n=t.reduce((a,o,s)=>o===z?a:(r[s]=a,R(a*o,e)),tt),i=Er(n,e);return t.reduceRight((a,o,s)=>o===z?a:(r[s]=R(a*r[s],e),R(a*o,e)),i),r}function gd(t){let e=t.length*8-br*8,r=Te(t);return e>0?r>>BigInt(e):r}function Va(t,e=!1){let r=gd(t);if(e)return r;let{n}=st;return r>=n?r-n:r}var vr,jr,Ma=class{constructor(e,r){if(this.hashLen=e,this.qByteLen=r,typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof r!="number"||r<2)throw new Error("qByteLen must be a number");this.v=new Uint8Array(e).fill(1),this.k=new Uint8Array(e).fill(0),this.counter=0}hmac(...e){return Gt.hmacSha256(this.k,...e)}hmacSync(...e){return jr(this.k,...e)}checkSync(){if(typeof jr!="function")throw new Qn("hmacSha256Sync needs to be set")}incr(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}async reseed(e=new Uint8Array){this.k=await this.hmac(this.v,Uint8Array.from([0]),e),this.v=await this.hmac(this.v),e.length!==0&&(this.k=await this.hmac(this.v,Uint8Array.from([1]),e),this.v=await this.hmac(this.v))}reseedSync(e=new Uint8Array){this.checkSync(),this.k=this.hmacSync(this.v,Uint8Array.from([0]),e),this.v=this.hmacSync(this.v),e.length!==0&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),e),this.v=this.hmacSync(this.v))}async generate(){this.incr();let e=0,r=[];for(;e<this.qByteLen;){this.v=await this.hmac(this.v);let n=this.v.slice();r.push(n),e+=this.v.length}return Ce(...r)}generateSync(){this.checkSync(),this.incr();let e=0,r=[];for(;e<this.qByteLen;){this.v=this.hmacSync(this.v);let n=this.v.slice();r.push(n),e+=this.v.length}return Ce(...r)}};function tn(t){return z<t&&t<st.n}function Ka(t){return z<t&&t<st.P}function xd(t,e,r,n=!0){let{n:i}=st,a=Va(t,!0);if(!tn(a))return;let o=Er(a,i),s=nt.BASE.multiply(a),f=R(s.x,i);if(f===z)return;let c=R(o*R(e+r*f,i),i);if(c===z)return;let u=new xr(f,c),h=(s.x===u.r?0:2)|Number(s.y&tt);return n&&u.hasHighS()&&(u=u.normalizeS(),h^=1),{sig:u,recovery:h}}function Jn(t){let e;if(typeof t=="bigint")e=t;else if(typeof t=="number"&&Number.isSafeInteger(t)&&t>0)e=BigInt(t);else if(typeof t=="string"){if(t.length!==2*br)throw new Error("Expected 32 bytes of private key");e=Xn(t)}else if(t instanceof Uint8Array){if(t.length!==br)throw new Error("Expected 32 bytes of private key");e=Te(t)}else throw new TypeError("Expected valid private key");if(!tn(e))throw new Error("Expected private key: 0 < key < n");return e}function md(t){return t instanceof nt?(t.assertValidity(),t):nt.fromHex(t)}function Nf(t){if(t instanceof xr)return t.assertValidity(),t;try{return xr.fromDER(t)}catch{return xr.fromCompact(t)}}function qa(t,e=!1){return nt.fromPrivateKey(t).toRawBytes(e)}function Lf(t){let e=t.length>Ht?t.slice(0,Ht):t;return Te(e)}function vd(t){let e=Lf(t),r=R(e,st.n);return Uf(r<z?e:r)}function Uf(t){return Oa(t)}function bd(t,e,r){if(t==null)throw new Error(`sign: expected valid message hash, not "${t}"`);let n=Sr(t),i=Jn(e),a=[Uf(i),vd(n)];if(r!=null){r===!0&&(r=Gt.randomBytes(Ht));let f=Sr(r);if(f.length!==Ht)throw new Error(`sign: Expected ${Ht} bytes of extra data`);a.push(f)}let o=Ce(...a),s=Lf(n);return{seed:o,m:s,d:i}}function wd(t,e){let{sig:r,recovery:n}=t,{der:i,recovered:a}=Object.assign({canonical:!0,der:!0},e),o=i?r.toDERRawBytes():r.toCompactRawBytes();return a?[o,n]:o}async function Kf(t,e,r={}){let{seed:n,m:i,d:a}=bd(t,e,r.extraEntropy),o=new Ma(ud,br);await o.reseed(n);let s;for(;!(s=xd(await o.generate(),i,a,r.canonical));)await o.reseed();return wd(s,r)}var Sd={strict:!0};function Ff(t,e,r,n=Sd){let i;try{i=Nf(t),e=Sr(e)}catch{return!1}let{r:a,s:o}=i;if(n.strict&&i.hasHighS())return!1;let s=Va(e),f;try{f=md(r)}catch{return!1}let{n:c}=st,u=Er(o,c),h=R(s*u,c),l=R(a*u,c),d=nt.BASE.multiplyAndAddUnsafe(f,h,l);return d?R(d.x,c)===a:!1}nt.BASE._setWindowSize(8);var kt={node:cd,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};var Yn={},Gt={bytesToHex:wr,hexToBytes:ze,concatBytes:Ce,mod:R,invert:Er,isValidPrivateKey(t){try{return Jn(t),!0}catch{return!1}},_bigintTo32Bytes:Oa,_normalizePrivateKey:Jn,hashToPrivateKey:t=>{t=Sr(t);let e=br+8;if(t.length<e||t.length>1024)throw new Error("Expected valid bytes of private key as per FIPS 186");let r=R(Te(t),st.n-tt)+tt;return Oa(r)},randomBytes:(t=32)=>{if(kt.web)return kt.web.getRandomValues(new Uint8Array(t));if(kt.node){let{randomBytes:e}=kt.node;return Uint8Array.from(e(t))}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>Gt.hashToPrivateKey(Gt.randomBytes(br+8)),precompute(t=8,e=nt.BASE){let r=e===nt.BASE?e:new nt(e.x,e.y);return r._setWindowSize(t),r.multiply(Jr),r},sha256:async(...t)=>{if(kt.web){let e=await kt.web.subtle.digest("SHA-256",Ce(...t));return new Uint8Array(e)}else if(kt.node){let{createHash:e}=kt.node,r=e("sha256");return t.forEach(n=>r.update(n)),Uint8Array.from(r.digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(t,...e)=>{if(kt.web){let r=await kt.web.subtle.importKey("raw",t,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),n=Ce(...e),i=await kt.web.subtle.sign("HMAC",r,n);return new Uint8Array(i)}else if(kt.node){let{createHmac:r}=kt.node,n=r("sha256",t);return e.forEach(i=>n.update(i)),Uint8Array.from(n.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:async(t,...e)=>{let r=Yn[t];if(r===void 0){let n=await Gt.sha256(Uint8Array.from(t,i=>i.charCodeAt(0)));r=Ce(n,n),Yn[t]=r}return Gt.sha256(r,...e)},taggedHashSync:(t,...e)=>{if(typeof vr!="function")throw new Qn("sha256Sync is undefined, you need to set it");let r=Yn[t];if(r===void 0){let n=vr(Uint8Array.from(t,i=>i.charCodeAt(0)));r=Ce(n,n),Yn[t]=r}return vr(r,...e)},_JacobianPoint:At};Object.defineProperties(Gt,{sha256Sync:{configurable:!1,get(){return vr},set(t){vr||(vr=t)}},hmacSha256Sync:{configurable:!1,get(){return jr},set(t){jr||(jr=t)}}});function jn(t){if(isNaN(t)||t<=0)throw new Y("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return Gt.randomBytes(t)}var Bg=ht(Tn(),1),za=ht($(),1);function Of(t,e){return e.map(r=>Pt(t[r]))}function Mf(t){return za.default.pki.setRsaPrivateKey(...Of(t,["n","e","d","p","q","dp","dq","qi"]))}function Vf(t){return za.default.pki.setRsaPublicKey(...Of(t,["n","e"]))}var He={};Z(He,{jwkToPkcs1:()=>Ad,jwkToPkix:()=>Id,pkcs1ToJwk:()=>Bd,pkixToJwk:()=>Cd});var Ig=ht(Pr(),1),Tg=ht(Tn(),1);var he=ht($(),1);function Bd(t){let e=he.default.asn1.fromDer(Dt(t,"ascii")),r=he.default.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:zt(r.n),e:zt(r.e),d:zt(r.d),p:zt(r.p),q:zt(r.q),dp:zt(r.dP),dq:zt(r.dQ),qi:zt(r.qInv),alg:"RS256"}}function Ad(t){if(t.n==null||t.e==null||t.d==null||t.p==null||t.q==null||t.dp==null||t.dq==null||t.qi==null)throw new Y("JWK was missing components","ERR_INVALID_PARAMETERS");let e=he.default.pki.privateKeyToAsn1({n:Pt(t.n),e:Pt(t.e),d:Pt(t.d),p:Pt(t.p),q:Pt(t.q),dP:Pt(t.dp),dQ:Pt(t.dq),qInv:Pt(t.qi)});return bt(he.default.asn1.toDer(e).getBytes(),"ascii")}function Cd(t){let e=he.default.asn1.fromDer(Dt(t,"ascii")),r=he.default.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:zt(r.n),e:zt(r.e)}}function Id(t){if(t.n==null||t.e==null)throw new Y("JWK was missing components","ERR_INVALID_PARAMETERS");let e=he.default.pki.publicKeyToAsn1({n:Pt(t.n),e:Pt(t.e)});return bt(he.default.asn1.toDer(e).getBytes(),"ascii")}async function qf(t){let e=await Tt.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await Gf(e);return{privateKey:r[0],publicKey:r[1]}}async function Ha(t){let r=[await Tt.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await Td(t)],n=await Gf({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}}async function zf(t,e){let r=await Tt.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await Tt.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(e));return new Uint8Array(n,0,n.byteLength)}async function Hf(t,e,r){let n=await Tt.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return Tt.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,e,r)}async function Gf(t){if(t.privateKey==null||t.publicKey==null)throw new Y("Private and public key are required","ERR_INVALID_PARAMETERS");return Promise.all([Tt.get().subtle.exportKey("jwk",t.privateKey),Tt.get().subtle.exportKey("jwk",t.publicKey)])}async function Td(t){return Tt.get().subtle.importKey("jwk",{kty:t.kty,n:t.n,e:t.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function Wf(t,e,r,n){let i=e?Vf(t):Mf(t),a=Dt(Uint8Array.from(r),"ascii"),o=n(a,i);return bt(o,"ascii")}function Zf(t,e){return Wf(t,!0,e,(r,n)=>n.encrypt(r))}function $f(t,e){return Wf(t,!1,e,(r,n)=>n.decrypt(r))}var rn=class{_key;constructor(e){this._key=e}async verify(e,r){return Hf(this._key,r,e)}marshal(){return He.jwkToPkix(this._key)}get bytes(){return ne.encode({Type:rt.RSA,Data:this.marshal()}).subarray()}encrypt(e){return Zf(this._key,e)}equals(e){return Rt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await vt.digest(this.bytes);return e}},Br=class{_key;_publicKey;constructor(e,r){this._key=e,this._publicKey=r}genSecret(){return jn(16)}async sign(e){return zf(this._key,e)}get public(){if(this._publicKey==null)throw new Y("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new rn(this._publicKey)}decrypt(e){return $f(this._key,e)}marshal(){return He.jwkToPkcs1(this._key)}get bytes(){return ie.encode({Type:rt.RSA,Data:this.marshal()}).subarray()}equals(e){return Rt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await vt.digest(this.bytes);return e}async id(){let e=await this.public.hash();return Dt(e,"base58btc")}async export(e,r="pkcs-8"){if(r==="pkcs-8"){let n=new en.default.util.ByteBuffer(this.marshal()),i=en.default.asn1.fromDer(n),a=en.default.pki.privateKeyFromAsn1(i),o={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return en.default.pki.encryptRsaPrivateKey(a,e,o)}else{if(r==="libp2p-key")return ur(this.bytes,e);throw new Y(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}};async function Rd(t){let e=He.pkcs1ToJwk(t),r=await Ha(e);return new Br(r.privateKey,r.publicKey)}function Dd(t){let e=He.pkixToJwk(t);return new rn(e)}async function Pd(t){let e=await Ha(t);return new Br(e.privateKey,e.publicKey)}async function kd(t){let e=await qf(t);return new Br(e.privateKey,e.publicKey)}var Za={};Z(Za,{Secp256k1PrivateKey:()=>an,Secp256k1PublicKey:()=>nn,generateKeyPair:()=>Kd,unmarshalSecp256k1PrivateKey:()=>Ld,unmarshalSecp256k1PublicKey:()=>Ud});function Yf(){return Gt.randomPrivateKey()}async function Qf(t,e){let{digest:r}=await vt.digest(e);try{return await Kf(r,t)}catch(n){throw new Y(String(n),"ERR_INVALID_INPUT")}}async function Xf(t,e,r){try{let{digest:n}=await vt.digest(r);return Ff(e,n,t)}catch(n){throw new Y(String(n),"ERR_INVALID_INPUT")}}function Jf(t){return nt.fromHex(t).toRawBytes(!0)}function jf(t){try{qa(t,!0)}catch(e){throw new Y(String(e),"ERR_INVALID_PRIVATE_KEY")}}function Wa(t){try{nt.fromHex(t)}catch(e){throw new Y(String(e),"ERR_INVALID_PUBLIC_KEY")}}function tc(t){try{return qa(t,!0)}catch(e){throw new Y(String(e),"ERR_INVALID_PRIVATE_KEY")}}var nn=class{_key;constructor(e){Wa(e),this._key=e}async verify(e,r){return Xf(this._key,r,e)}marshal(){return Jf(this._key)}get bytes(){return ne.encode({Type:rt.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Rt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await vt.digest(this.bytes);return e}},an=class{_key;_publicKey;constructor(e,r){this._key=e,this._publicKey=r??tc(e),jf(this._key),Wa(this._publicKey)}async sign(e){return Qf(this._key,e)}get public(){return new nn(this._publicKey)}marshal(){return this._key}get bytes(){return ie.encode({Type:rt.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Rt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await vt.digest(this.bytes);return e}async id(){let e=await this.public.hash();return Dt(e,"base58btc")}async export(e,r="libp2p-key"){if(r==="libp2p-key")return ur(this.bytes,e);throw new Y(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function Ld(t){return new an(t)}function Ud(t){return new nn(t)}async function Kd(){let t=Yf();return new an(t)}var _e={rsa:Ga,ed25519:Na,secp256k1:Za};function $a(t){let e=Object.keys(_e).join(" / ");return new Y(`invalid or unsupported key type ${t}. Must be ${e}`,"ERR_UNSUPPORTED_KEY_TYPE")}function Ya(t){if(t=t.toLowerCase(),t==="rsa"||t==="ed25519"||t==="secp256k1")return _e[t];throw $a(t)}async function ti(t,e){return Ya(t).generateKeyPair(e??2048)}function ec(t){let e=ne.decode(t),r=e.Data??new Uint8Array;switch(e.Type){case rt.RSA:return _e.rsa.unmarshalRsaPublicKey(r);case rt.Ed25519:return _e.ed25519.unmarshalEd25519PublicKey(r);case rt.Secp256k1:return _e.secp256k1.unmarshalSecp256k1PublicKey(r);default:throw $a(e.Type??"RSA")}}function Qa(t,e){return e=(e??"rsa").toLowerCase(),Ya(e),t.bytes}async function rc(t){let e=ie.decode(t),r=e.Data??new Uint8Array;switch(e.Type){case rt.RSA:return _e.rsa.unmarshalRsaPrivateKey(r);case rt.Ed25519:return _e.ed25519.unmarshalEd25519PrivateKey(r);case rt.Secp256k1:return _e.secp256k1.unmarshalSecp256k1PrivateKey(r);default:throw $a(e.Type??"RSA")}}function nc(t,e){return e=(e??"rsa").toLowerCase(),Ya(e),t.bytes}var ic=Symbol.for("@libp2p/peer-id");var Xa={};Z(Xa,{identity:()=>Od});var Od=ir({prefix:"\0",name:"identity",encode:t=>t0(t),decode:t=>js(t)});var Ja={};Z(Ja,{base2:()=>Md});var Md=ot({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var ja={};Z(ja,{base8:()=>Vd});var Vd=ot({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var to={};Z(to,{base10:()=>qd});var qd=xe({prefix:"9",name:"base10",alphabet:"0123456789"});var eo={};Z(eo,{base16:()=>zd,base16upper:()=>Hd});var zd=ot({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Hd=ot({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var ro={};Z(ro,{base32:()=>Ar,base32hex:()=>$d,base32hexpad:()=>Qd,base32hexpadupper:()=>Xd,base32hexupper:()=>Yd,base32pad:()=>Wd,base32padupper:()=>Zd,base32upper:()=>Gd,base32z:()=>Jd});var Ar=ot({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Gd=ot({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Wd=ot({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Zd=ot({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),$d=ot({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Yd=ot({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Qd=ot({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Xd=ot({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Jd=ot({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var no={};Z(no,{base36:()=>jd,base36upper:()=>ty});var jd=xe({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),ty=xe({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var io={};Z(io,{base256emoji:()=>ay});var ac=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),ey=ac.reduce((t,e,r)=>(t[r]=e,t),[]),ry=ac.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function ny(t){return t.reduce((e,r)=>(e+=ey[r],e),"")}function iy(t){let e=[];for(let r of t){let n=ry[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var ay=ir({prefix:"\u{1F680}",name:"base256emoji",encode:ny,decode:iy});var bx=new TextEncoder,wx=new TextDecoder;var oc=(t,e)=>{let{bytes:r,version:n}=t;switch(n){case 0:return cy(r,ao(t),e||Bt.encoder);default:return uy(r,ao(t),e||Ar.encoder)}};var sc=new WeakMap,ao=t=>{let e=sc.get(t);if(e==null){let r=new Map;return sc.set(t,r),r}return e},Ge=class t{constructor(e,r,n,i){this.code=r,this.version=e,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==on)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==hy)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return t.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=jt(e,r);return t.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return t.equals(this,e)}static equals(e,r){let n=r;return n&&e.code===n.code&&e.version===n.version&&o0(e.multihash,n.multihash)}toString(e){return oc(this,e)}toJSON(){return{"/":oc(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof t)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:i,multihash:a,bytes:o}=r;return new t(n,i,a,o||fc(n,i,a.bytes))}else if(r[ly]===!0){let{version:n,multihash:i,code:a}=r,o=Vr(i);return t.create(n,a,o)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==on)throw new Error(`Version 0 CID must use dag-pb (code: ${on}) block encoding`);return new t(e,r,n,n.bytes)}case 1:{let i=fc(e,r,n.bytes);return new t(e,r,n,i)}default:throw new Error("Invalid version")}}static createV0(e){return t.create(0,on,e)}static createV1(e,r){return t.create(1,e,r)}static decode(e){let[r,n]=t.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=t.inspectBytes(e),n=r.size-r.multihashSize,i=ce(e.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let a=i.subarray(r.multihashSize-r.digestSize),o=new sr(r.multihashCode,r.digestSize,a,i);return[r.version===0?t.createV0(o):t.createV1(r.codec,o),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,l]=Mr(e.subarray(r));return r+=l,h},i=n(),a=on;if(i===18?(i=0,r=0):a=n(),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let o=r,s=n(),f=n(),c=r+f,u=c-o;return{version:i,codec:a,multihashCode:s,digestSize:f,multihashSize:u,size:c}}static parse(e,r){let[n,i]=fy(e,r),a=t.decode(i);if(a.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return ao(a).set(n,e),a}},fy=(t,e)=>{switch(t[0]){case"Q":{let r=e||Bt;return[Bt.prefix,r.decode(`${Bt.prefix}${t}`)]}case Bt.prefix:{let r=e||Bt;return[Bt.prefix,r.decode(t)]}case Ar.prefix:{let r=e||Ar;return[Ar.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},cy=(t,e,r)=>{let{prefix:n}=r;if(n!==Bt.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=e.get(n);if(i==null){let a=r.encode(t).slice(1);return e.set(n,a),a}else return i},uy=(t,e,r)=>{let{prefix:n}=r,i=e.get(n);if(i==null){let a=r.encode(t);return e.set(n,a),a}else return i},on=112,hy=18,fc=(t,e,r)=>{let n=or(t),i=n+or(e),a=new Uint8Array(i+r.byteLength);return ar(t,a,0),ar(e,a,n),a.set(r,i),a},ly=Symbol.for("@ipld/js-cid/CID");var oo={...Xa,...Ja,...ja,...to,...eo,...ro,...no,...ji,...pa,...io},Dx={...ia,...ea};var py=Symbol.for("nodejs.util.inspect.custom"),cc=Object.values(oo).map(t=>t.decoder).reduce((t,e)=>t.or(e),oo.identity.decoder),uc=114,so=36,fo=37,sn=class{type;multihash;privateKey;publicKey;string;constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[ic]=!0;toString(){return this.string==null&&(this.string=Bt.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return Ge.createV1(uc,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return Rt(this.multihash.bytes,e);if(typeof e=="string")return dy(e).equals(this);if(e?.multihash?.bytes!=null)return Rt(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}[py](){return`PeerId(${this.toString()})`}},Cr=class extends sn{type="RSA";publicKey;constructor(e){super({...e,type:"RSA"}),this.publicKey=e.publicKey}},Ir=class extends sn{type="Ed25519";publicKey;constructor(e){super({...e,type:"Ed25519"}),this.publicKey=e.multihash.digest}},Tr=class extends sn{type="secp256k1";publicKey;constructor(e){super({...e,type:"secp256k1"}),this.publicKey=e.multihash.digest}};function dy(t,e){if(e=e??cc,t.charAt(0)==="1"||t.charAt(0)==="Q"){let r=Vr(Bt.decode(`z${t}`));return t.startsWith("12D")?new Ir({multihash:r}):t.startsWith("16U")?new Tr({multihash:r}):new Cr({multihash:r})}return co(cc.decode(t))}function co(t){try{let e=Vr(t);if(e.code===me.code){if(e.digest.length===so)return new Ir({multihash:e});if(e.digest.length===fo)return new Tr({multihash:e})}if(e.code===vt.code)return new Cr({multihash:e})}catch{return yy(Ge.decode(t))}throw new Error("Supplied PeerID CID is invalid")}function yy(t){if(t==null||t.multihash==null||t.version==null||t.version===1&&t.code!==uc)throw new Error("Supplied PeerID CID is invalid");let e=t.multihash;if(e.code===vt.code)return new Cr({multihash:t.multihash});if(e.code===me.code){if(e.digest.length===so)return new Ir({multihash:t.multihash});if(e.digest.length===fo)return new Tr({multihash:t.multihash})}throw new Error("Supplied PeerID CID is invalid")}async function uo(t,e){return t.length===so?new Ir({multihash:jt(me.code,t),privateKey:e}):t.length===fo?new Tr({multihash:jt(me.code,t),privateKey:e}):new Cr({multihash:await vt.digest(t),publicKey:t,privateKey:e})}var fn;(function(t){let e;t.codec=()=>(e==null&&(e=yr((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.id!=null&&(n.uint32(10),n.bytes(r.id)),r.pubKey!=null&&(n.uint32(18),n.bytes(r.pubKey)),r.privKey!=null&&(n.uint32(26),n.bytes(r.privKey)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},a=n==null?r.len:r.pos+n;for(;r.pos<a;){let o=r.uint32();switch(o>>>3){case 1:i.id=r.bytes();break;case 2:i.pubKey=r.bytes();break;case 3:i.privKey=r.bytes();break;default:r.skipType(o&7);break}}return i})),e),t.encode=r=>pr(r,t.codec()),t.decode=r=>lr(r,t.codec())})(fn||(fn={}));var gy=async()=>{let t=await ti("Ed25519"),e=await cn(t);if(e.type==="Ed25519")return e;throw new Error(`Generated unexpected PeerId type "${e.type}"`)},xy=async()=>{let t=await ti("secp256k1"),e=await cn(t);if(e.type==="secp256k1")return e;throw new Error(`Generated unexpected PeerId type "${e.type}"`)},my=async t=>{let e=await ti("RSA",t?.bits??2048),r=await cn(e);if(r.type==="RSA")return r;throw new Error(`Generated unexpected PeerId type "${r.type}"`)};async function hc(t){return uo(Qa(t))}async function cn(t){return uo(Qa(t.public),nc(t))}function vy(t,e){return fn.encode({id:t.multihash.bytes,pubKey:t.publicKey,privKey:e===!0||t.privateKey==null?void 0:t.privateKey})}async function by(t){let{id:e,privKey:r,pubKey:n}=fn.decode(t);return lc(e??new Uint8Array(0),r,n)}async function wy(t){return lc(bt(t.id,"base58btc"),t.privKey!=null?bt(t.privKey,"base64pad"):void 0,t.pubKey!=null?bt(t.pubKey,"base64pad"):void 0)}async function lc(t,e,r){if(e!=null){let n=await rc(e);return cn(n)}else if(r!=null){let n=ec(r);return hc(n)}return co(t)}return mc(Sy);})();
/*! Bundled license information:

@noble/ed25519/lib/esm/index.js:
  (*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) *)

@noble/secp256k1/lib/esm/index.js:
  (*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) *)
*/
return Libp2PPeerIdFactory}));
